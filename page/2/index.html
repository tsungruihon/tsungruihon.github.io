<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="I Never Save Anything For The Swim Back.">
<meta property="og:type" content="website">
<meta property="og:title" content="å½¼å¾—çš„åšå®¢">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="å½¼å¾—çš„åšå®¢">
<meta property="og:description" content="I Never Save Anything For The Swim Back.">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="å½¼å¾—çš„åšå®¢">
<meta name="twitter:description" content="I Never Save Anything For The Swim Back.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"always","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title>å½¼å¾—çš„åšå®¢</title>
  <!-- <link rel="stylesheet" type="text/css" href="/css/prettify.css">
  <link rel="stylesheet" type="text/css" href="/css/github-v2.css">
  <link rel="stylesheet" type="text/css" href="/css/github-v2.min.css"> -->
  <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
       <script type="text/x-mathjax-config">
         MathJax.Hub.Config({
           tex2jax: {
             inlineMath: [ ['$','$'], ["\\(","\\)"] ],
             processEscapes: true
           }
         });
       </script>
       <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">å½¼å¾—çš„åšå®¢</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/26/Support-Vector-Machine/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å½¼å¾—çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/12/26/Support-Vector-Machine/" itemprop="url">
                  Support Vector Machine
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-12-26T22:25:51+08:00">
                2017-12-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Machine-Learning/" itemprop="url" rel="index">
                    <span itemprop="name">Machine Learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>è¿™ä¸ªç®—æ³•ä¸€ç›´å›°æ‰°ç€æˆ‘ï¼Œè™½ç„¶æˆ‘æ²¡æœ‰åœ¨å®é™…ä¸­ä½¿ç”¨è¿‡å®ƒï¼Œä½†æ˜¯æˆ‘æ—©å·²å¬é—»å®ƒçš„å¼ºå¤§ä¹‹å¤„ã€‚ä½†å› ä¸ºé‡Œé¢å……æ»¡ç€å„ç§æ•°å­¦æ¨å¯¼ï¼Œä¸èŠ±ä¸€äº›æ—¶é—´å»ç ”ç©¶å®åœ¨æ˜¯æ— æ³•æ¶ˆåŒ–ã€‚ä½†æ˜¯ï¼Œè§£å†³ææƒ§çš„æœ€å¥½æ–¹æ³•å°±æ˜¯ç›´é¢å®ƒã€‚æˆ‘ä¸€ç›´éƒ½åœ¨çœ‹å„ç§ç›¸å…³ä¹¦ç±ï¼Œä»¥åŠYoutubeä¸Šå„ç§SVMçš„è§†é¢‘ï¼Œå¯è°“æ˜¯å—å°½å„ç§ç…ç†¬ï¼Œå½“ä¸­å¯èƒ½ä¼šå› ä¸ºçœ‹ä¸æ‡‚é‡Œé¢æŸä¸ªå…¬å¼è€Œåç«‹ä¸å®‰ï¼Œç„¶ååˆæ‰¾ä¸åˆ°äººå¯ä»¥æ²Ÿé€šè¯·æ•™ã€‚æ‰€ä»¥åŸºæœ¬ä¸Šè¿™ä¸ª<code>SVM</code>ç®—æ³•æ•´å¤©éƒ½åœ¨æˆ‘çš„è„‘è¢‹é‡Œé¢æŒ¥ä¹‹ä¸å»ï¼Œç„¶ååˆæ²¡åŠæ³•å®Œå…¨ç†æ¸…æ¥šæ¯ä¸€ä¸ªç»†èŠ‚ï¼Œè¿™æ ·å¯¼è‡´æˆ‘æ²¡åŠæ³•ç”¨ä»£ç å¤å†™ä¸€éã€‚æ•´ä¸ªäººéå¸¸ç—›è‹¦ã€‚ä½†ç°åœ¨ï¼Œæˆ‘ç»ˆäºå¯ä»¥æ¥å†™è¿™ä¸ª<code>SVM</code>åˆ†äº«æ–‡ç« äº†ã€‚</p>
<p><code>Support Vector Machine(SVM)</code>ï¼Œä¸­æ–‡æ˜¯æ”¯æŒå‘é‡æœºï¼Œæ˜¯ä¸€ç§äºŒåˆ†ç±»æ¨¡å‹ã€‚å®ƒçš„åŸºæœ¬æ¨¡å‹æ˜¯å®šä¹‰åœ¨ç‰¹å¾ç©ºé—´ä¸Šçš„é—´éš”æœ€å¤§çš„çº¿æ€§åˆ†ç±»å™¨ã€‚ä¸ºä»€ä¹ˆè¦å¼ºè°ƒ<code>é—´éš”æœ€å¤§</code>ï¼Ÿ æ˜¯å› ä¸ºèƒ½å¤Ÿå°†è®­ç»ƒæ ·æœ¬æ­£ç¡®åˆ†å¼€çš„åˆ’åˆ†è¶…å¹³é¢å¯èƒ½æœ‰å¾ˆå¤šï¼Œä½†æ˜¯å¦‚ä½•è¡¡é‡å“ªä¸€ä¸ªæ˜¯æœ€å¥½ï¼Ÿ<code>é—´éš”æœ€å¤§</code>è¿™ä¸€ç‰¹æ€§ä½¿<code>SVM</code>æœ‰åˆ«äº<code>æ„ŸçŸ¥æœº</code>ï¼Œå› ä¸º<code>é—´éš”æœ€å¤§</code>å¯ä»¥ä½¿å¯¹æœªè§ç¤ºä¾‹çš„æ³›åŒ–èƒ½åŠ›æœ€å¼ºï¼Œè€Œä¸”ä¿è¯å¯¹è®­ç»ƒæ ·æœ¬å±€éƒ¨æ‰°åŠ¨çš„â€œå®¹å¿â€æ€§æœ€å¥½ã€‚<img src="/images/Screen%20Shot%202017-12-27%20at%205.30.54%20PM.png" alt="Screen Shot 2017-12-27 at 5.30.54 PM"></p>
<p>æ”¯æŒå‘é‡æœºä¸»è¦åˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»<code>çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœºä¸ç¡¬é—´éš”æœ€å¤§åŒ–</code>ã€<code>çº¿æ€§æ”¯æŒå‘é‡æœºä¸è½¯é—´éš”æœ€å¤§åŒ–</code>ä»¥åŠ<code>éçº¿å½¢æ”¯æŒå‘é‡æœºä¸æ ¸å‡½æ•°</code>ã€‚æˆ‘ä¸€å¼€å§‹çœ‹è¿™ä¸‰ä¸ªç±»åˆ«çš„æ—¶å€™ï¼Œæˆ‘å¿ƒé‡Œç®€ç›´å°±æ˜¯æƒ³çˆ†ç²—ã€‚ä¸çŸ¥é“è¯»è€…ä½ ä»¬æœ‰æ²¡æœ‰ç±»ä¼¼çš„æ„Ÿå—ï¼Œå¦‚æœä½ ä»¬æ²¡æœ‰ï¼Œé‚£ä¹ˆä¸‹æ–‡ä½ ä»¬å°±ä¸éœ€è¦çœ‹äº†ã€‚å¯¹äºè·Ÿæˆ‘ä¸€æ ·æ„Ÿå—çš„è¯»è€…ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹åˆ°åº•è¿™ä¸‰ç±»æ”¯æŒå‘é‡æœºåˆ°åº•åœ¨æäº›ä»€ä¹ˆæ¯›çº¿ã€‚</p>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æˆ‘ä»¬ç›®å‰æœ‰ä»€ä¹ˆã€‚</p>
<p>åœ¨æ ·æœ¬ç©ºé—´ä¸­ï¼Œåˆ’åˆ†è¶…å¹³é¢å¯ä»¥é€šè¿‡ä»¥ä¸‹çº¿æ€§æ–¹ç¨‹æ¥æè¿°ï¼š <span class="math display">\[
\mathbf{w}^{T}\mathbf{x} + b = 0
\]</span> å…¶ä¸­ï¼Œ <code>w=(w1; w2; ...; wd)</code>ä¸ºæ³•å‘é‡ï¼Œå†³å®šäº†è¶…å¹³é¢çš„æ–¹å‘ï¼›<code>b</code>ä¸ºä½ç§»é¡¹ï¼Œå†³å®šäº†è¶…å¹³é¢ä¸åŸç‚¹ä¹‹é—´çš„è·ç¦»ã€‚ç„¶åæ ·æœ¬ç©ºé—´ä¸­ä»»æ„ç‚¹<code>x</code>åˆ°è¶…å¹³é¢<code>(w, b)</code>çš„è·ç¦»å¯å†™ä¸ºï¼š <span class="math display">\[
r = \frac {|\mathbf{w}^{T}\mathbf{x} + b|}{||\mathbf{w}||}
\]</span> å‡è®¾è¶…å¹³é¢èƒ½å¤Ÿæ­£ç¡®å°†è®­ç»ƒæ ·æœ¬åˆ†ç±»ï¼Œåˆ™æœ‰ï¼š <span class="math display">\[
\left\{ 
\begin{array}{c}
\mathbf{w}^{T}\mathbf{x} + b \ge +1, \ \ \ y_i=+1. \\ 
\mathbf{w}^{T}\mathbf{x} + b \le -1 \ \ \ y_i=-1.\\ 
\end{array}
\right.
\]</span> ç­‰ä»·äº <span class="math display">\[
y_i\cdot(\mathbf{w}^{T}\mathbf{x} + b) \ge +1
\]</span> è·ç¦»è¶…å¹³é¢æœ€è¿‘çš„å‡ ä¸ªè®­ç»ƒæ ·æœ¬èƒ½å¤Ÿä½¿ç­‰å·æˆç«‹ï¼Œå®ƒä»¬è¢«ç§°ä¸ºâ€œæ”¯æŒå‘é‡<code>(Support Vector)</code>â€ï¼Œä¸¤ä¸ªå¼‚ç±»æ”¯æŒå‘é‡è·ç¦»è¶…å¹³é¢çš„è·ç¦»ä¹‹å’Œä¸ºï¼š <span class="math display">\[
\gamma= \frac{2}{||\mathbf{w}||}
\]</span></p>
<h3 id="ä¸€çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœºä¸ç¡¬é—´éš”æœ€å¤§åŒ–">ä¸€ã€<u>çº¿æ€§å¯åˆ†</u>æ”¯æŒå‘é‡æœºä¸ç¡¬é—´éš”æœ€å¤§åŒ–</h3>
<p>å¯¹äºçº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœºï¼Œæœ‰ä¸€ä¸ªå¾ˆå¥½çš„é¢„æœŸå°±æ˜¯è®­ç»ƒæ•°æ®çš„åˆ†å¸ƒæ²¡æœ‰ä»»ä½•å†²çªæˆ–è€…æ··æ‚ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªè®­ç»ƒæ•°æ®é›†æ˜¯çº¿æ€§å¯åˆ†ã€‚æˆ‘ä»¬éœ€è¦æ‰¾å‡ºèƒ½å¤Ÿå°†ä¸¤ç±»æ•°æ®æ­£ç¡®åˆ’åˆ†å¹¶ä¸”é—´éš”æœ€å¤§çš„ç›´çº¿ã€‚<img src="/images/Screen%20Shot%202017-12-27%20at%2010.05.16%20PM.png" alt="Screen Shot 2017-12-27 at 10.05.16 PM"></p>
<p>æ„é€ å¹¶æ±‚è§£çº¦æŸæœ€ä¼˜åŒ–é—®é¢˜ï¼š <span class="math display">\[
\begin{aligned}
&amp; \mathop{min}_{w, b} \ \ \  \frac{1}{2}||w||^2 \\
\\
&amp; s.t. \ \ \  y_i\cdot(\mathbf{w}^{T}\mathbf{x} + b) - 1\ge 0
\end{aligned}
\]</span> ç„¶åæ„å»ºæ‹‰æ ¼æœ—æ—¥å‡½æ•°: <span class="math display">\[
L(w, b, \alpha) = \frac{1}{2}||w||^2 - \sum_{i=1} ^{N} \alpha_i\cdot((\mathbf{w}^{T}\mathbf{x} + b) - 1)
\]</span> å› æ­¤ï¼Œé—®é¢˜å˜æˆæå¤§æå°é—®é¢˜ï¼š <span class="math display">\[
\mathop{max}_\alpha\mathop{min}_{w, b} L(w, b, \alpha)
\]</span> ï¼ˆ1ï¼‰æ±‚<code>min_{w, b}L(w, b, a)</code> <span class="math display">\[
\begin{aligned}
\frac {\partial L}{\partial w} &amp; = w - \sum_{i}^{N}\alpha_iy_ix_i = 0 \\
\\ 
\frac {\partial L}{\partial b} &amp; = \sum_{i}^{N}\alpha_iy_i = 0
\end{aligned}
\]</span> å¾— <span class="math display">\[
\begin{aligned}
 &amp; w  =  \sum_{i}^{N}\alpha_iy_ix_i  \\
 \\
&amp; \sum_{i}^{N}\alpha_iy_i  = 0
\end{aligned}
\]</span> æ‰€ä»¥å°†è¿™ä¸¤ä¸ªå¼å­ä»£å…¥<code>L(w, b, a)</code>å¾—ï¼š <span class="math display">\[
\mathop{min}_{w, b} L(w, b, \alpha) = \sum_{i=1}^{N}\alpha_i - \frac {1}{2}\sum_{i=1}^{N}\sum_{j=1}^{N}\alpha_i\alpha_jy_iy_j(x_i \cdot x_j)
\]</span> ï¼ˆ2ï¼‰æ±‚<code>min_{w, b} L(w, b, a)å¯¹açš„æå¤§</code>ï¼š <span class="math display">\[
\mathop{max}_{\alpha}  L(w, b, \alpha) = \sum_{i=1}^{N}\alpha_i - \frac {1}{2}\sum_{i=1}^{N}\sum_{j=1}^{N}\alpha_i\alpha_jy_iy_j(x_i \cdot x_j)
\]</span> è¿™ä¸ªé—®é¢˜çš„å¯¹å¶é—®é¢˜æ˜¯ï¼š <span class="math display">\[
\begin{aligned}
&amp; \mathop{min}_{\alpha} \ \ \ L(w, b, \alpha) =\frac {1}{2}\sum_{i=1}^{N}\sum_{j=1}^{N}\alpha_i\alpha_jy_iy_j(x_i \cdot x_j) -  \sum_{i=1}^{N}\alpha_i \\
&amp; s.t \ \ \  \sum_{i=1}^{N}\alpha_iy_i = 0 \\
\\ 
&amp; \ \ \ \ \ \ \ \ \ \alpha_i \ge 0 \\
\\
&amp; \ \ \ \ \ \ \ \ \ y_i\cdot(\mathbf{w}^{T}\mathbf{x} + b) - 1\ge 0 \\
\\ 
&amp; \ \ \ \ \ \ \ \ \ \alpha_i(y_i\cdot(\mathbf{w}^{T}\mathbf{x} + b) - 1) = 0
\end{aligned}
\]</span> æ±‚å¾—æœ€ä¼˜è§£<code>a*=(a1*, a2*, ..., aN*)^T</code></p>
<p>ï¼ˆ3ï¼‰è®¡ç®— <span class="math display">\[
w^{*} = \sum_{i=1}^{N}\alpha_iy_ix_i
\]</span> å¹¶é€‰æ‹©<code>a*</code>çš„ä¸€ä¸ªæ­£åˆ†é‡<code>aj*&gt;0</code>ï¼Œè®¡ç®—å¾— <span class="math display">\[
b^{*} = y_j - \sum_{i=1}^{N}\alpha_{j}^{*}y_i(x_i \cdot x_j)
\]</span> ï¼ˆ4ï¼‰æ±‚å¾—åˆ†ç¦»è¶…å¹³é¢ <span class="math display">\[
w^{*} \cdot x + b^{*} = 0
\]</span> ï¼ˆ5ï¼‰åˆ†ç±»å†³ç­–å‡½æ•° <span class="math display">\[
f(x) = sign(w^{*} \cdot x + b^{*})
\]</span> è§£å†³äº†ã€‚</p>
<p>åœ¨çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœºä¸­ï¼Œ<code>w*</code>å’Œ<code>b*</code>åªä¾èµ–äºè®­ç»ƒæ•°æ®ä¸­å¯¹åº”<code>aj*&gt;0</code>çš„æ ·æœ¬ç‚¹<code>(xi, yi)</code>ï¼Œè€Œå…¶ä»–æ ·æœ¬ç‚¹å¯¹<code>w*</code>å’Œ<code>b*</code>æ²¡æœ‰å½±å“ã€‚å› æ­¤æˆ‘ä»¬æŠŠè®­ç»ƒæ•°æ®ä¸­å¯¹åº”<code>aj*&gt;0</code>çš„å®ä¾‹ç‚¹ç§°ä¸ºæ”¯æŒå‘é‡ã€‚</p>
<h3 id="äºŒçº¿æ€§æ”¯æŒå‘é‡æœºä¸è½¯é—´éš”æœ€å¤§åŒ–">äºŒã€<u>çº¿æ€§æ”¯æŒ</u>å‘é‡æœºä¸è½¯é—´éš”æœ€å¤§åŒ–</h3>
<p>ä½†æ˜¯è®­ç»ƒæ•°æ®ä¸ä¸€å®šæ€»æ˜¯çº¿æ€§å¯åˆ†ï¼Œæœ‰æ—¶å€™æŸäº›æ ·æœ¬ç‚¹ä¸ä¸€å®šæ»¡è¶³é—´éš”å¤§äºç­‰äº1å¾—çº¦æŸæ¡ä»¶ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹<code>ç¡¬é—´éš”æœ€å¤§åŒ–</code>ä¸º<code>è½¯é—´éš”æœ€å¤§åŒ–</code>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨æœ€å¤§åŒ–é—´éš”çš„åŒæ—¶ï¼Œä¸æ»¡è¶³çº¦æŸæ¡ä»¶çš„æ ·æœ¬åº”å°½å¯èƒ½å°‘ã€‚</p>
<p>äºæ˜¯ä¼˜åŒ–ç›®æ ‡å¯å†™ä¸º <span class="math display">\[
\mathop{min}_{w, b} \frac{1}{2}||w||^2 + C\sum_{i=1}^{m}\ell_{0/1}(y_i(\mathbf{w}^{T}\mathbf{x} + b )-1)
\]</span> å…¶ä¸­<code>C&gt;0</code>ä½¿ä¸€ä¸ªå¸¸æ•°ï¼Œ<code>ğ“0/1</code>æ˜¯â€œ0/1æŸå¤±å‡½æ•°â€ <span class="math display">\[
\ell_{0/1}{(z)}=
\begin{cases}
1,  &amp; \text{if $z$ &lt;0;} \\[2ex]
0, &amp; \text{otherwise.}
\end{cases}
\]</span> è‹¥<code>C</code>ä¸ºæ— ç©·å¤§æ—¶ï¼Œè¿™æ ·ä¼šè¿«ä½¿æ‰€æœ‰æ ·æœ¬éƒ½è¦æ»¡è¶³åŸå§‹çº¦æŸã€‚å½“<code>C</code>å–æœ‰é™å€¼æ—¶ï¼Œåˆ™å…è®¸ä¸€äº›æ ·æœ¬ä¸æ»¡è¶³çº¦æŸã€‚</p>
<p>ä½†<code>ğ“0/1</code>éå‡¸ã€éè¿ç»­ï¼Œæ•°å­¦æ€§è´¨ä¸å¤ªå¥½ï¼Œä½¿å¾—ä¸æ˜“ç›´æ¥æ±‚è§£ã€‚äºæ˜¯å¸¸ç”¨å…¶ä»–æ›¿ä»£æŸå¤±å‡½æ•°æ¥ä»£æ›¿<code>ğ“0/1</code>ã€‚å®ƒä»¬é€šå¸¸æ˜¯å‡¸çš„è¿ç»­å‡½æ•°ä¸”æ˜¯<code>ğ“0/1</code>çš„ä¸Šç•Œã€‚ <span class="math display">\[
\begin{aligned}
&amp; hinge \ \ loss: \ell_{hinge}(z) = max(0, 1-z) \\
\\
&amp; exponential \ \ loss: \ell_{exp}(z) = exp(-z) \\
\\
&amp; logistic \ \ loss: \ell_{log}(z) = log(1 + exp(-z))
\end{aligned}
\]</span> <img src="/images/Screen%20Shot%202017-12-28%20at%201.24.55%20AM.png" alt="Screen Shot 2017-12-28 at 1.24.55 AM"></p>
<p>å¼•å…¥æ¾å¼›å˜é‡<code>(slack variables)</code>ï¼Œ å¯¹æ¯ä¸ªæ ·æœ¬ç‚¹<code>(xi, yi)</code>å¼•è¿›ä¸€ä¸ªæ¾å¼›å˜é‡<code>ğœ‰i&gt;=0</code>ï¼Œä½¿å‡½æ•°é—´éš”åŠ ä¸Šæ¾å¼›å˜é‡å¤§äºç­‰äº1ã€‚è¿™æ—¶å€™ï¼Œçº¦æŸæ¡ä»¶å˜ä¸ºï¼š <span class="math display">\[
y_i(w \cdot x_i + b )  +  \xi_i \ge 1
\]</span></p>
<p>åŒæ—¶ï¼Œå¯¹æ¯ä¸ªæ¾å¼›å˜é‡<code>ğœ‰i</code>ï¼Œ æ”¯ä»˜ä¸€ä¸ªä»£ä»·<code>ğœ‰i</code>ã€‚è¿™æ—¶å€™ç›®æ ‡å‡½æ•°å˜æˆï¼š <span class="math display">\[
\frac {1}{2} ||w||^2 + C \sum_{i=1}^{N}\xi_{i}
\]</span> è¿™é‡Œï¼Œ<code>C&gt;0</code>ç§°ä¸ºæƒ©ç½šå‚æ•°ï¼Œä¸€èˆ¬ç”±åº”ç”¨é—®é¢˜å†³å®šã€‚<code>C</code>å€¼å¤§æ—¶å¯¹è¯¯åˆ†ç±»çš„æƒ©ç½šå¢å¤§ï¼ŒCå€¼å°æ—¶å¯¹è¯¯åˆ†ç±»çš„æƒ©ç½šå‡å°‘ã€‚ç›®æ ‡å‡½æ•°æœ‰ä¸¤å±‚å«ä¹‰ï¼Œç¬¬ä¸€å±‚æ˜¯å¸Œæœ›é—´éš”å°½å¯èƒ½å¤§ï¼ŒåŒæ—¶ä½¿è¯¯åˆ†ç±»ç‚¹çš„ä¸ªæ•°å°½é‡å°ï¼Œ<code>C</code>æ˜¯è°ƒå’ŒäºŒè€…çš„ç³»æ•°ã€‚</p>
<p>æ„é€ å¹¶æ±‚è§£çº¦æŸæœ€ä¼˜åŒ–é—®é¢˜ï¼š <span class="math display">\[
\begin{aligned}
&amp; \mathop{min}_{w, b, ğœ‰}\ \ \frac {1}{2} ||w||^2 + C \sum_{i=1}^{N}\xi_{i} \\
\\
&amp; s.t.  \ \ y_i(w \cdot x_i + b )  +  \xi_i \ge 1 \\
\\
&amp; \xi_i \ge 0, \ \ i=1, 2, ..., m. 
\end{aligned}
\]</span> ç„¶åæ„å»ºæ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š <span class="math display">\[
\begin{aligned}
L(\mathbf{w}, b, \mathbf{\alpha}, \xi, \mu) = \mathop{min}_{w, b, ğœ‰}\ \ &amp; \frac {1}{2} ||w||^2 + C \sum_{i=1}^{N}\xi_{i}   \\
&amp; +\sum_{i=1}^{m}\alpha_i(1- \xi_i - (\mathbf{w}^{T}\mathbf{x} + b )-1)) - \sum_{i=1}^{m}\mu_i\xi_i
\end{aligned}
\]</span> å…¶ä¸­<code>a&gt;=0</code>ï¼Œ<code>ui&gt;=0</code>æ˜¯æ‹‰æ ¼æœ—æ—¥ä¹˜å­ã€‚</p>
<p>ï¼ˆ1ï¼‰ä»¤<code>L(w, b, a, ğœ‰, u)</code>å¯¹<code>w</code>, <code>b</code>, <code>ğœ‰</code>çš„åå¯¼ä¸ºé›¶å¯å¾—ï¼š <span class="math display">\[
\begin{aligned}
\mathbf{w} &amp; = \sum_{i=1}^{N}\alpha_iy_ix_i,  \\
\\
0 &amp;= \sum_{i=0}^{m} \alpha_iy_i \\
C &amp; = \alpha_i + \mu_i
\end{aligned}
\]</span> ï¼ˆ2ï¼‰æ±‚<code>min{w, b,  ğœ‰} L(w, b, a, ğœ‰, u)å¯¹açš„æå¤§</code>ï¼š <span class="math display">\[
\begin{aligned}
&amp; \mathop{min}_{\alpha} \ \ \ \frac {1}{2}\sum_{i=1}^{m}\sum_{j=1}^{m}\alpha_i\alpha_jy_iy_j(x_i \cdot x_j) -  \sum_{i=1}^{N}\alpha_i \\
&amp; s.t \ \ \  \sum_{i=1}^{m}\alpha_iy_i = 0\\
\\ 
&amp; \ \ \ \ \ \ \ \ \  0 \le \alpha_i \le C , \ \ \ \mu_i \ge 0, \\
\\
&amp; \ \ \ \ \ \ \ \ \ y_i\cdot(\mathbf{w}^{T}\mathbf{x} + b) - 1 + \xi_i \ge 0 \\
\\ 
&amp; \ \ \ \ \ \ \ \ \ \alpha_i(y_i\cdot(\mathbf{w}^{T}\mathbf{x} + b) - 1+ \xi_i ) = 0 \\
\\
&amp; \ \ \ \ \ \ \ \ \ \xi_i  \ge 0, \ \ \ \mu_i\xi_i = 0
\end{aligned}
\]</span> ï¼ˆ3ï¼‰è®¡ç®— <span class="math display">\[
w^{*} = \sum_{i=1}^{N}\alpha_iy_ix_i
\]</span> å¹¶é€‰æ‹©<code>a*</code>çš„ä¸€ä¸ªæ­£åˆ†é‡<code>0&lt;=aj*&lt;=C</code>ï¼Œè®¡ç®—å¾— <span class="math display">\[
b^{*} = y_j - \sum_{i=1}^{N}\alpha_{j}^{*}y_i(x_i \cdot x_j)
\]</span> ï¼ˆ4ï¼‰æ±‚å¾—åˆ†ç¦»è¶…å¹³é¢ <span class="math display">\[
w^{*} \cdot x + b^{*} = 0
\]</span> ï¼ˆ5ï¼‰åˆ†ç±»å†³ç­–å‡½æ•° <span class="math display">\[
f(x) = sign(w^{*} \cdot x + b^{*})
\]</span> è§£å†³äº†ã€‚</p>
<h3 id="ä¸‰éçº¿å½¢æ”¯æŒå‘é‡æœºä¸æ ¸å‡½æ•°">ä¸‰ã€<u>éçº¿å½¢æ”¯</u>æŒå‘é‡æœºä¸æ ¸å‡½æ•°</h3>
<p>å¯¹äºçº¿æ€§åˆ†ç±»é—®é¢˜ï¼Œ<code>çº¿æ€§åˆ†ç±»æ”¯æŒå‘é‡æœº</code>æ˜¯ä¸€ç§éå¸¸æœ‰æ•ˆçš„æ–¹æ³•ï¼Œä½†æ˜¯ï¼Œæœ‰æ—¶å€™åˆ†ç±»é—®é¢˜æ˜¯éçº¿æ€§çš„ã€‚<img src="/images/Screen%20Shot%202017-12-28%20at%2011.32.43%20AM.png" alt="Screen Shot 2017-12-28 at 11.32.43 AM"></p>
<p>è¿™æ—¶å€™ï¼Œæƒ³ç”¨ä¸€æ¡ç›´çº¿å»æŠŠè¿™ä¸¤ç±»æ•°æ®è¿›è¡Œæ­£ç¡®åˆ†ç±»æ˜¯ä¸ç°å®çš„ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>éçº¿æ€§æ”¯æŒå‘é‡æœº</code>ã€‚</p>
<p>éçº¿æ€§æ”¯æŒå‘é‡æœºé¦–å…ˆä½¿ç”¨ä¸€ä¸ªå˜æ¢å°†åŸç©ºé—´çš„æ•°æ®æ˜ å°„åˆ°æ–°ç©ºé—´ï¼›ç„¶ååœ¨æ–°ç©ºé—´é‡Œç”¨çº¿æ€§åˆ†ç±»å­¦ä¹ æ–¹æ³•ä»è®­ç»ƒæ•°æ®ä¸­å­¦ä¹ åˆ†ç±»æ¨¡å‹ã€‚å®ç°è¿™ä¸ªè¿‡ç¨‹æœ€ä¸»è¦çš„æ–¹æ³•å°±æ˜¯<code>æ ¸å‡½æ•°(Kernel Function)</code>ã€‚</p>
<p>åœ¨åŸå±æ€§ç©ºé—´ä¸­è®¡ç®—çš„ç›¸ä¼¼åº¦å‡½æ•°<code>K</code>ç§°ä¸º<code>æ ¸å‡½æ•°(Kernel Function)</code>ï¼Œåœ¨æ»¡è¶³<code>MerceråŸç†</code>ï¼Œä¹Ÿå°±æ˜¯è¯´å¿…é¡»å­˜åœ¨ä¸€ä¸ªç›¸åº”çš„å˜æ¢ï¼Œä½¿å¾—è®¡ç®—ä¸€å¯¹å‘é‡çš„æ ¸å‡½æ•°ç­‰ä»·äºåœ¨å˜æ¢åçš„ç©ºé—´ä¸­è®¡ç®—è¿™å¯¹å‘é‡çš„ç‚¹ç§¯ï¼Œèƒ½å¤Ÿä½¿è®¡ç®—ç‚¹ç§¯çš„å¼€é”€æ›´å°ï¼Œè€Œä¸”èƒ½å¤Ÿé¿å…ç»´ç¾éš¾ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ‰ <span class="math display">\[
\mathbf{K}(\mathbf{u, \mathbf{v}}) = \mathbf{\Phi}{(\mathbf{u})} \cdot  \mathbf{\Phi}{(\mathbf{v})} = (\mathbf{u} \cdot \mathbf{v} + 1) ^ 2
\]</span> ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„æ ¸å‡½æ•°</p>
<ul>
<li><code>å¤šé¡¹å¼æ ¸å‡½æ•°ï¼ˆpolynomial kernel function)</code></li>
</ul>
<p><span class="math display">\[
K(x, z) = (x \cdot z + 1)^p
\]</span></p>
<p>å¯¹åº”çš„æ”¯æŒå‘é‡æœºæ˜¯ä¸€ä¸ª<code>pæ¬¡å¤šé¡¹å¼åˆ†ç±»å™¨</code>ã€‚</p>
<ul>
<li><code>é«˜æ–¯æ ¸å‡½æ•°(Gaussian kernel function)</code> <span class="math display">\[
K(x, z) = exp\left(-\frac{||x-z||^2}{2\sigma^2}\right)
\]</span> ç„¶åä¸‹é¢æˆ‘ä»¬å°±å¯ä»¥å°è¯•æ±‚è§£æœ€ä¼˜è§£äº†ã€‚</li>
</ul>
<p>ï¼ˆ1ï¼‰é€‰å–é€‚å½“çš„<code>æ ¸å‡½æ•°K(x, z)</code>å’Œé€‚å½“çš„å‚æ•°<code>C</code>ï¼Œæ„é€ å¹¶æ±‚è§£æœ€ä¼˜åŒ–é—®é¢˜ <span class="math display">\[
\begin{aligned}
&amp; \mathop{min}_{\alpha} \ \ \ \frac {1}{2}\sum_{i=1}^{m}\sum_{j=1}^{m}\alpha_i\alpha_jy_iy_j(K(x_i, x_j)) -  \sum_{i=1}^{N}\alpha_i \\
&amp; s.t \ \ \  \sum_{i=1}^{m}\alpha_iy_i = 0\\
\\ 
&amp; \ \ \ \ \ \ \ \ \  0 \le \alpha_i \le C ,  \ \ \ \ i =1, 2, ..., m \\
\end{aligned}
\]</span> æ±‚å¾—æœ€ä¼˜è§£<code>É‘*=(É‘1*, a2*, ..., a*N)^T</code></p>
<p>ï¼ˆ2ï¼‰é€‰æ‹©<code>É‘*</code>çš„ä¸€ä¸ªæ­£åˆ†é‡<code>0&lt;É‘j*&lt;C</code>ï¼Œè®¡ç®— <span class="math display">\[
b^* = y_j - \sum_{i=1}^{N}\alpha_{i}^{*}y_iK(x_i \cdot x_j)
\]</span> ï¼ˆ3ï¼‰æ±‚å¾—åˆ†ç¦»è¶…å¹³é¢ <span class="math display">\[
\sum_{i=1}^{N}\alpha_{i}^{*}y_iK(x \cdot x_i) + b^{*} = 0
\]</span> ï¼ˆ4ï¼‰åˆ†ç±»å†³ç­–å‡½æ•° <span class="math display">\[
f(x) = sign \left (\sum_{i=1}^{N}\alpha_{i}^{*}y_iK(x \cdot x_i) + b^{*}\right)
\]</span> è§£å†³äº†ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬å°±å¯ä»¥ç”¨<code>Python</code>æ¥å†™ä¸€ä¸ª<code>SVMç®—æ³•</code>å•¦</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="keyword">import</span> random</div><div class="line"><span class="keyword">import</span> logging</div><div class="line"></div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">from</span> sklearn.cross_validation <span class="keyword">import</span> train_test_split</div><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SVM</span><span class="params">(object)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, kernel=<span class="string">'linear'</span>,epsilon = <span class="number">0.001</span>)</span>:</span></div><div class="line">        self.kernel = kernel</div><div class="line">        self.epsilon = epsilon</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_init_parameters</span><span class="params">(self, features, labels)</span>:</span></div><div class="line"></div><div class="line">        self.X = features</div><div class="line">        self.Y = labels</div><div class="line"></div><div class="line">        self.b = <span class="number">0.0</span></div><div class="line">        self.n = len(features[<span class="number">0</span>])</div><div class="line">        self.N = len(features)</div><div class="line">        self.alpha = [<span class="number">0.0</span>] * self.N</div><div class="line">        self.E = [self._E_(i) <span class="keyword">for</span> i <span class="keyword">in</span> xrange(self.N)]</div><div class="line"></div><div class="line">        self.C = <span class="number">1000</span></div><div class="line">        self.Max_Interation = <span class="number">5000</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_satisfy_KKT</span><span class="params">(self, i)</span>:</span></div><div class="line">        ygx = self.Y[i] * self._g_(i)</div><div class="line">        <span class="keyword">if</span> abs(self.alpha[i])&lt;self.epsilon:</div><div class="line">            <span class="keyword">return</span> ygx &gt; <span class="number">1</span> <span class="keyword">or</span> ygx == <span class="number">1</span></div><div class="line">        <span class="keyword">elif</span> abs(self.alpha[i]-self.C)&lt;self.epsilon:</div><div class="line">            <span class="keyword">return</span> ygx &lt; <span class="number">1</span> <span class="keyword">or</span> ygx == <span class="number">1</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> abs(ygx<span class="number">-1</span>) &lt; self.epsilon</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_stop</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(self.N):</div><div class="line">            satisfy = self._satisfy_KKT(i)</div><div class="line"></div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> satisfy:</div><div class="line">                <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_select_two_parameters</span><span class="params">(self)</span>:</span></div><div class="line"></div><div class="line">        index_list = [i <span class="keyword">for</span> i <span class="keyword">in</span> xrange(self.N)]</div><div class="line"></div><div class="line">        i1_list_1 = filter(<span class="keyword">lambda</span> i: self.alpha[i] &gt; <span class="number">0</span> <span class="keyword">and</span> self.alpha[i] &lt; self.C, index_list)</div><div class="line">        i1_list_2 = list(set(index_list) - set(i1_list_1))</div><div class="line"></div><div class="line">        i1_list = i1_list_1</div><div class="line">        i1_list.extend(i1_list_2)</div><div class="line"></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> i1_list:</div><div class="line">            <span class="keyword">if</span> self._satisfy_KKT(i):</div><div class="line">                <span class="keyword">continue</span></div><div class="line"></div><div class="line">            E1 = self.E[i]</div><div class="line">            max_ = (<span class="number">0</span>, <span class="number">0</span>)</div><div class="line"></div><div class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> index_list:</div><div class="line">                <span class="keyword">if</span> i == j:</div><div class="line">                    <span class="keyword">continue</span></div><div class="line"></div><div class="line">                E2 = self.E[j]</div><div class="line">                <span class="keyword">if</span> abs(E1 - E2) &gt; max_[<span class="number">0</span>]:</div><div class="line">                    max_ = (abs(E1 - E2), j)</div><div class="line"></div><div class="line">            <span class="keyword">return</span> i, max_[<span class="number">1</span>]</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_K_</span><span class="params">(self, x1, x2)</span>:</span></div><div class="line"></div><div class="line">        <span class="keyword">if</span> self.kernel == <span class="string">'linear'</span>:</div><div class="line">            <span class="keyword">return</span> sum([x1[k] * x2[k] <span class="keyword">for</span> k <span class="keyword">in</span> xrange(self.n)])</div><div class="line">        <span class="keyword">if</span> self.kernel == <span class="string">'poly'</span>:</div><div class="line">            <span class="keyword">return</span> (sum([x1[k] * x2[k] <span class="keyword">for</span> k <span class="keyword">in</span> xrange(self.n)])+<span class="number">1</span>)**<span class="number">3</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">        <span class="keyword">print</span> <span class="string">'æ²¡æœ‰å®šä¹‰æ ¸å‡½æ•°'</span></div><div class="line">        <span class="keyword">return</span> <span class="number">0</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_g_</span><span class="params">(self, i)</span>:</span></div><div class="line"></div><div class="line">        result = self.b</div><div class="line"></div><div class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> xrange(self.N):</div><div class="line">            result += self.alpha[j] * self.Y[j] * self._K_(self.X[i], self.X[j])</div><div class="line"></div><div class="line">        <span class="keyword">return</span> result</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_E_</span><span class="params">(self, i)</span>:</span></div><div class="line"></div><div class="line">        <span class="keyword">return</span> self._g_(i) - self.Y[i]</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">try_E</span><span class="params">(self,i)</span>:</span></div><div class="line">        result = self.b-self.Y[i]</div><div class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> xrange(self.N):</div><div class="line">            <span class="keyword">if</span> self.alpha[j]&lt;<span class="number">0</span> <span class="keyword">or</span> self.alpha[j]&gt;self.C:</div><div class="line">                <span class="keyword">continue</span></div><div class="line">            result += self.Y[j]*self.alpha[j]*self._K_(self.X[i],self.X[j])</div><div class="line">        <span class="keyword">return</span> result</div><div class="line"></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">train</span><span class="params">(self, features, labels)</span>:</span></div><div class="line"></div><div class="line">        self._init_parameters(features, labels)</div><div class="line"></div><div class="line">        <span class="keyword">for</span> times <span class="keyword">in</span> xrange(self.Max_Interation):</div><div class="line">            </div><div class="line">            logging.debug(<span class="string">'iterater %d'</span> % times)</div><div class="line"></div><div class="line">            i1, i2 = self._select_two_parameters()</div><div class="line"></div><div class="line">            L = max(<span class="number">0</span>, self.alpha[i2] - self.alpha[i1])</div><div class="line">            H = min(self.C, self.C + self.alpha[i2] - self.alpha[i1])</div><div class="line"></div><div class="line">            <span class="keyword">if</span> self.Y[i1] == self.Y[i2]:</div><div class="line">                L = max(<span class="number">0</span>, self.alpha[i2] + self.alpha[i1] - self.C)</div><div class="line">                H = min(self.C, self.alpha[i2] + self.alpha[i1])</div><div class="line"></div><div class="line">            E1 = self.E[i1]</div><div class="line">            E2 = self.E[i2]</div><div class="line">            eta = self._K_(self.X[i1], self.X[i1]) + self._K_(self.X[i2], self.X[i2]) - <span class="number">2</span> * self._K_(self.X[i1], self.X[i2])   </div><div class="line"></div><div class="line">            alpha2_new_unc = self.alpha[i2] + self.Y[i2] * (E1 - E2) / eta     </div><div class="line"></div><div class="line">            alph2_new = <span class="number">0</span></div><div class="line">            <span class="keyword">if</span> alpha2_new_unc &gt; H:</div><div class="line">                alph2_new = H</div><div class="line">            <span class="keyword">elif</span> alpha2_new_unc &lt; L:</div><div class="line">                alph2_new = L</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                alph2_new = alpha2_new_unc</div><div class="line"></div><div class="line">            alph1_new = self.alpha[i1] + self.Y[i1] * \</div><div class="line">                self.Y[i2] * (self.alpha[i2] - alph2_new)</div><div class="line"></div><div class="line">            b_new = <span class="number">0</span></div><div class="line">            b1_new = -E1 - self.Y[i1] * self._K_(self.X[i1], self.X[i1]) * (alph1_new - self.alpha[i1]) - self.Y[i2] * self._K_(self.X[i2], self.X[i1]) * (alph2_new - self.alpha[i2]) + self.b</div><div class="line">            b2_new = -E2 - self.Y[i1] * self._K_(self.X[i1], self.X[i2]) * (alph1_new - self.alpha[i1]) - self.Y[i2] * self._K_(self.X[i2], self.X[i2]) * (alph2_new - self.alpha[i2]) + self.b</div><div class="line"></div><div class="line">            <span class="keyword">if</span> alph1_new &gt; <span class="number">0</span> <span class="keyword">and</span> alph1_new &lt; self.C:</div><div class="line">                b_new = b1_new</div><div class="line">            <span class="keyword">elif</span> alph2_new &gt; <span class="number">0</span> <span class="keyword">and</span> alph2_new &lt; self.C:</div><div class="line">                b_new = b2_new</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                b_new = (b1_new + b2_new) / <span class="number">2</span></div><div class="line"></div><div class="line">            self.alpha[i1] = alph1_new</div><div class="line">            self.alpha[i2] = alph2_new</div><div class="line">            self.b = b_new</div><div class="line"></div><div class="line">            self.E[i1] = self._E_(i1)</div><div class="line">            self.E[i2] = self._E_(i2)</div><div class="line"></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_predict_</span><span class="params">(self,feature)</span>:</span></div><div class="line">        result = self.b</div><div class="line"></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(self.N):</div><div class="line">            result += self.alpha[i]*self.Y[i]*self._K_(feature,self.X[i])</div><div class="line"></div><div class="line">        <span class="keyword">if</span> result &gt; <span class="number">0</span>:</div><div class="line">            <span class="keyword">return</span> <span class="number">1</span></div><div class="line">        <span class="keyword">return</span> <span class="number">-1</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(self,features)</span>:</span></div><div class="line">        results = []</div><div class="line"></div><div class="line">        <span class="keyword">for</span> feature <span class="keyword">in</span> features:</div><div class="line">            results.append(self._predict_(feature))</div><div class="line"></div><div class="line">        <span class="keyword">return</span> results</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/22/åˆ†ç±»ç»“æœæ··æ·†çŸ©é˜µ/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å½¼å¾—çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/12/22/åˆ†ç±»ç»“æœæ··æ·†çŸ©é˜µ/" itemprop="url">
                  åˆ†ç±»ç»“æœæ··æ·†çŸ©é˜µ
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-12-22T22:25:43+08:00">
                2017-12-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Machine-Learning/" itemprop="url" rel="index">
                    <span itemprop="name">Machine Learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <table>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">é¢„æµ‹ç»“æœ</th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>çœŸå®ç»“æœ</strong></td>
<td style="text-align: center;">æ­£ä¾‹ï¼ˆYesï¼‰</td>
<td style="text-align: center;">åä¾‹ï¼ˆNoï¼‰</td>
</tr>
<tr class="even">
<td style="text-align: center;">æ­£ä¾‹ï¼ˆYesï¼‰</td>
<td style="text-align: center;">TP</td>
<td style="text-align: center;">FN</td>
</tr>
<tr class="odd">
<td style="text-align: center;">åä¾‹ï¼ˆNoï¼‰</td>
<td style="text-align: center;">FP</td>
<td style="text-align: center;">TN</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
\begin{aligned}
Precision  &amp; = \frac {TP}{TP + FP} \\
\\
Recall &amp; = \frac {TP}{TP + FN}
\end{aligned}
\]</span></p>
<ul>
<li><code>æŸ¥å‡†ç‡(Precision)</code>: æŒ‡åœ¨æ‰€æœ‰é¢„æµ‹ä¸ºæ­£ä¾‹çš„æƒ…å†µä¸­ï¼Œé¢„æµ‹æ­£ä¾‹ä¸”å®é™…æ­£ä¾‹çš„æ¯”ä¾‹ã€‚<code>æŸ¥å‡†ç‡</code>å…³æ³¨çš„æ˜¯é¢„æµ‹æ­£ä¾‹æ­£ç¡®å æ‰€æœ‰é¢„æµ‹ä¸ºæ­£ä¾‹æƒ…å†µçš„æ¯”ä¾‹ï¼Œç™½è¯æ–‡å°±æ˜¯è¯´ï¼Œ<code>æŸ¥å‡†ç‡</code>å…³æ³¨çš„æ˜¯ä½ é¢„æµ‹äº†ä¸€å¤§å †æ­£ä¾‹çš„ä¾‹å­ï¼Œç„¶åé‡Œé¢æœ‰å¤šå°‘æ˜¯é¢„æµ‹æ­£ç¡®çš„ï¼Œå°±æ˜¯å‡†ä¸å‡†å˜›ã€‚</li>
<li><code>æŸ¥å…¨ç‡(Recall)</code>: æŒ‡åœ¨å®é™…ä¸ºæ­£ä¾‹çš„æƒ…å†µä¸­ï¼Œé¢„æµ‹ä¸ºæ­£ä¾‹çš„æ¯”ä¾‹ã€‚ç™½è¯æ–‡å°±æ˜¯è¯´ï¼Œ<code>æŸ¥å…¨ç‡</code>å…³æ³¨çš„æ˜¯ä½ æ­£ç¡®é¢„æµ‹äº†ä¸€å¤§å †æ­£ä¾‹ï¼Œæ•°é‡ä¸ºAï¼ŒçœŸå®æƒ…å†µä¸‹æ­£ä¾‹çš„æ•°é‡æ˜¯Bï¼Œç„¶åçœ‹Bé‡Œé¢æœ‰å¤šå°‘æ¯”ä¾‹çš„Aï¼Œç„¶åå»åˆ¤æ–­é¢„æµ‹æ­£ç¡®çš„æƒ…å†µå…¨ä¸å…¨ã€‚</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/18/Naive-Bayes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å½¼å¾—çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/12/18/Naive-Bayes/" itemprop="url">
                  Naive Bayes
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-12-18T15:25:37+08:00">
                2017-12-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Machine-Learning/" itemprop="url" rel="index">
                    <span itemprop="name">Machine Learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><code>Naive Bayes(æœ´ç´ è´å¶æ–¯æ³•)</code>æ˜¯åŸºäºè´å¶æ–¯å®šç†ä¸ç‰¹å¾æ¡ä»¶ç‹¬ç«‹å‡è®¾çš„åˆ†ç±»æ–¹æ³•ï¼Œå¯¹äºç»™å®šçš„è®­ç»ƒæ•°æ®é›†ï¼Œé¦–å…ˆåŸºäºç‰¹å¾æ¡ä»¶ç‹¬ç«‹å‡è®¾å­¦ä¹ è¾“å…¥/è¾“å‡ºçš„è”åˆæ¦‚ç‡åˆ†å¸ƒï¼›ç„¶ååŸºäºæ­¤æ¨¡å‹ï¼Œå¯¹ç»™å®šçš„è¾“å…¥<code>x</code>ï¼Œåˆ©ç”¨è´å¶æ–¯å®šç†æ±‚å‡ºåéªŒæ¦‚ç‡æœ€å¤§çš„è¾“å‡º<code>y</code>ã€‚</p>
<p><code>æœ´ç´ è´å¶æ–¯</code>å¯¹æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒä½œäº†æ¡ä»¶ç‹¬ç«‹æ€§çš„å‡è®¾ï¼Œå…·ä½“åœ°ï¼Œæ¡ä»¶ç‹¬ç«‹æ€§å‡è®¾æ˜¯ï¼š <span class="math display">\[
\begin{aligned}
P(X  =x|Y=c_k)  &amp;= P(X^{(1)}  = x^{(1)}, ï½¥ï½¥ï½¥, X^{(n)}=x^{(n)}|Y=c_k) \\
\\
&amp; = \prod_{j=1}^nP(X^{(j)} = x^{(j)}|Y=c_k)
\end{aligned}
\]</span> ç‹¬ç«‹æ¡ä»¶å‡è®¾å°±æ˜¯è¯´ç”¨äºåˆ†ç±»çš„ç‰¹å¾åœ¨ç±»ç¡®å®šçš„æ¡ä»¶ä¸‹éƒ½æ˜¯æ¡ä»¶ç‹¬ç«‹çš„ï¼Œè¿™ä¸ªå…¬å¼å°±æ˜¯ä¼¼ç„¶å‡½æ•°ã€‚ä»£è¡¨çš„æ˜¯ç»™å®šå‚æ•°åå˜é‡çš„æ¦‚ç‡ã€‚è¿™ä¸€å‡è®¾ä½¿æœ´ç´ è´å¶æ–¯å˜å¾—ç®€å•ï¼Œä½†ä»£ä»·å°±æ˜¯æœ‰æ—¶å€™ä¼šç‰ºç‰²ä¸€å®šçš„åˆ†ç±»å‡†ç¡®ç‡ã€‚</p>
<p><code>æœ´ç´ è´å¶æ–¯</code>åˆ†ç±»æ—¶ï¼Œå¯¹ç»™å®šçš„è¾“å…¥<code>x</code>ï¼Œé€šè¿‡å­¦ä¹ åˆ°çš„æ¨¡å‹è®¡ç®—åéªŒæ¦‚ç‡åˆ†å¸ƒ<code>P(Y=ck|X=x)</code>ï¼Œå°†åéªŒæ¦‚ç‡æœ€å¤§çš„ç±»ä½œä¸º<code>x</code>çš„ç±»è¾“å‡ºã€‚è€ŒåéªŒæ¦‚ç‡è®¡ç®—æ˜¯æ ¹æ®è´å¶æ–¯å®šç†è¿›è¡Œçš„ï¼š <span class="math display">\[
\begin{aligned}
P(Y=c_k|X=x) &amp;  = \frac {P(X=x|Y=c_k)\cdot P(Y=c_k)}{\sum_kP(X=x|Y=c_k)\cdot P(Y=c_k)} \\
\\
&amp; =\frac {P(Y=c_k)\cdot \prod_jP(X^{(j)} |Y=c_k)}{\sum_kP(Y=c_k)\cdot \prod_jP(X^{(j)} |Y=c_k)} \ \ \ k=1, 2, ...,K 
\end{aligned}
\]</span> äºæ˜¯<code>æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨</code>å¯ä»¥è¡¨ç¤ºä¸ºï¼š <span class="math display">\[
y = f(x) = \mathop{\arg\max}_{c_k} \frac {P(Y=c_k)\prod_jP(X^{(j)}=x^{(j)}|Y=c_k)}{\sum_kP(Y=c_k)\cdot \prod_jP(X^{(j)} |Y=c_k)}
\]</span> ç„¶åå…¶å®å¯¹äºæ¯ä¸ª<code>c_k</code>ï¼Œåˆ†æ¯éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å¯ä»¥ç®€åŒ–å…¬å¼ï¼š <span class="math display">\[
y = f(x) = \mathop{\arg\max}_{c_k}P(Y=c_k)\prod_jP(X^{(j)}=x^{(j)}|Y=c_k)
\]</span> ä¹Ÿå°±è¯´ï¼Œæœ´ç´ è´å¶æ–¯æ³•çš„å­¦ä¹ ä¸åˆ†ç±»åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p>
<ol type="1">
<li>è®¡ç®—å…ˆéªŒæ¦‚ç‡åŠæ¡ä»¶æ¦‚ç‡ï¼š</li>
</ol>
<p><span class="math display">\[
\begin{aligned}
&amp; P(Y=c_k) = \frac {\sum_{i=k}^NI(y_i=c_k)}{N},  \ \ \ k=1, 2, ..., K \\
&amp;P(X^{(j)} = a_{jl}|Y=c_k) = \frac {\sum_{i=1}^NI(x_i^{(j)} = a_{jl}, y=c_k)}{\sum_{i=1}^NI(y_i=c_k)} \\
\\
&amp; j = 1, 2, ..., n; \ \ \ l = 1, 2, ..., S_j; \ \ \ k = 1, 2, ..., K
\end{aligned}
\]</span></p>
<ol start="2" type="1">
<li>å¯¹äºç»™å®šçš„å®ä¾‹ï¼Œå¯ä»¥è¿›è¡Œè®¡ç®—ï¼š</li>
</ol>
<p><span class="math display">\[
\begin{aligned}
&amp; x =(x^{(1)}, x^{(2)}, x^{(3)}, ..., x^{(n)})^T \\
\\
&amp;P(Y=c_k)\prod_{j=1}^nP(X^{(j)} = x^{j}|Y = c_k), \ \ \ k = 1, 2, ..., K
\end{aligned}
\]</span></p>
<ol start="3" type="1">
<li>ç¡®å®šå®ä¾‹<code>x</code>çš„ç±»ï¼š</li>
</ol>
<p><span class="math display">\[
y = f(x) = \mathop{\arg\max}_{c_k}P(Y=c_k)\prod_jP(X^{(j)}=x^{(j)}|Y=c_k)
\]</span></p>
<ul>
<li><strong>æœ´ç´ è´å¶æ–¯ç®—æ³•çš„ä¸»è¦ä¼˜ç‚¹</strong>ï¼š</li>
</ul>
<ol type="1">
<li>Â å‘æºäºå¤å…¸æ•°å­¦ç†è®ºï¼Œæœ‰ç¨³å®šçš„åˆ†ç±»æ•ˆç‡</li>
<li>å¯¹å°è§„æ¨¡çš„æ•°æ®è¡¨ç°å¾ˆå¥½ï¼Œèƒ½å¤„ç†å¤šåˆ†ç±»ä»»åŠ¡ï¼Œé€‚åˆå¢é‡å¼è®­ç»ƒï¼Œå°¤å…¶æ˜¯æ•°æ®é‡è¶…å‡ºå†…å­˜æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€æ‰¹æ‰¹çš„å»å¢é‡è®­ç»ƒ</li>
<li>å¯¹ç¼ºå¤±æ•°æ®ä¸å¤ªæ•æ„Ÿï¼Œç®—æ³•ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå¸¸ç”¨äºæ–‡æœ¬åˆ†ç±»</li>
</ol>
<ul>
<li><strong>æœ´ç´ è´å¶æ–¯ç®—æ³•çš„ä¸»è¦ç¼ºç‚¹</strong>ï¼š</li>
</ul>
<ol type="1">
<li>æœ´ç´ è´å¶æ–¯å‡å®šå‡è®¾å±æ€§ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œåœ¨å±æ€§ä¸ªæ•°æ¯”è¾ƒå¤šæˆ–è€…å±æ€§ä¹‹é—´ç›¸å…³æ€§è¾ƒå¤§æ—¶ï¼Œåˆ†ç±»æ•ˆæœä¸å¥½ã€‚åœ¨å±æ€§ç›¸å…³æ€§è¾ƒå°æ—¶ï¼Œåˆ†ç±»æœ€ä¸ºè‰¯å¥½</li>
<li>éœ€è¦çŸ¥é“å…ˆéªŒæ¦‚ç‡ï¼Œä¸”å…ˆéªŒæ¦‚ç‡å¾ˆå¤šæ—¶å€™å–å†³äºå‡è®¾ã€‚å‡è®¾çš„å…ˆéªŒæ¨¡å‹ä¼šå½±å“é¢„æµ‹æ•ˆæœ</li>
<li>å¯¹è¾“å…¥æ•°æ®çš„è¡¨è¾¾å½¢å¼å¾ˆæ•æ„Ÿ</li>
</ol>
<p>ç„¶åä¸‹é¢æˆ‘ä»¬å¯ä»¥ç”¨Pythonæ¥å®ç°è¿™ä¸ªç®—æ³•å•¦ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">createFeaturesList</span><span class="params">(X)</span>:</span></div><div class="line">	featureSet = set([])</div><div class="line">	<span class="keyword">for</span> xi <span class="keyword">in</span> X:</div><div class="line">		featureSet = featureSet | set(xi)</div><div class="line">	<span class="keyword">return</span> list(featureSet)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">features2Vec</span><span class="params">(featuresList, x)</span>:</span></div><div class="line">	featureVec = [<span class="number">0</span>] * len(featuresList)</div><div class="line">	<span class="keyword">for</span> feature <span class="keyword">in</span> x:</div><div class="line">		featureVec[featuresList.index(feature)] = <span class="number">1</span></div><div class="line">	<span class="keyword">return</span> featureVec</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">train</span><span class="params">(featuresMatrix, y)</span>:</span></div><div class="line">	num_sample = len(featuresMatrix)</div><div class="line">	num_feature = len(featuresMatrix[<span class="number">0</span>])</div><div class="line">	<span class="comment"># è®¡ç®—P&#123;Y=1&#125;</span></div><div class="line">	P_Y_1 = (sum(y))/(float(num_sample))</div><div class="line">	P_Y_0 = <span class="number">1</span> - P_Y_1</div><div class="line">	</div><div class="line">	<span class="comment"># è®¡ç®—åœ¨ä¸åŒæ ‡ç­¾ä¸‹å¯¹åº”çš„ç‰¹å¾ä¸ªæ•°</span></div><div class="line">	P_1_Count = np.zeros(num_feature)</div><div class="line">	P_0_Count = np.zeros(num_feature)</div><div class="line"></div><div class="line">	<span class="comment"># è®¡ç®—Y=1å’ŒY=0çš„ä¸ªæ•°</span></div><div class="line">	Y_1_sum = sum(y)</div><div class="line">	Y_0_sum = len(y) - sum(y)</div><div class="line"></div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(num_sample):</div><div class="line">		<span class="keyword">if</span> y[i] == <span class="number">1</span>:</div><div class="line">			<span class="comment"># è®¡ç®—åœ¨Y = 1ä¸‹å¯¹åº”çš„ç‰¹å¾ä¸ªæ•°</span></div><div class="line">			P_1_Count += featuresMatrix[i]</div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			<span class="comment"># è®¡ç®—åœ¨Y = 0ä¸‹å¯¹åº”çš„ç‰¹å¾ä¸ªæ•°</span></div><div class="line">			P_0_Count += featuresMatrix[i]</div><div class="line"></div><div class="line">	<span class="comment"># è®¡ç®—P&#123;X=xi|y=1&#125; å’Œ P&#123;X=xi|y=0&#125;</span></div><div class="line">	P_1_Condition = (P_1_Count / Y_1_sum)</div><div class="line">	P_0_Condition = (P_0_Count / Y_0_sum)</div><div class="line"></div><div class="line">	<span class="keyword">return</span> P_1_Condition, P_0_Condition, P_Y_1</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">classify</span><span class="params">(features_Vec, P_1_Condition, P_0_Condition, P_Y_1)</span>:</span></div><div class="line">	prod1 = features_Vec * P_1_Condition</div><div class="line">	prod1 = reduce(<span class="keyword">lambda</span> x, y: x*y, prod1[prod1 &gt; <span class="number">0</span>])</div><div class="line">	prod0 = features_Vec * P_0_Condition</div><div class="line">	prod0 = reduce(<span class="keyword">lambda</span> x, y: x*y, prod0[prod0 &gt; <span class="number">0</span>])</div><div class="line"></div><div class="line">	p1 = prod1 * P_Y_1</div><div class="line">	p0 = prod0 * (<span class="number">1</span> - P_Y_1)</div><div class="line">	<span class="keyword">if</span> p1 &gt; p0:</div><div class="line">		<span class="keyword">return</span> <span class="number">1</span></div><div class="line">	<span class="keyword">else</span>:</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span></div><div class="line"></div><div class="line">X = [[<span class="number">1</span>,<span class="string">'s'</span>],[<span class="number">1</span>,<span class="string">'m'</span>],[<span class="number">1</span>,<span class="string">'m'</span>],[<span class="number">1</span>,<span class="string">'s'</span>],[<span class="number">1</span>,<span class="string">'s'</span>],[<span class="number">2</span>,<span class="string">'s'</span>],[<span class="number">2</span>,<span class="string">'m'</span>],[<span class="number">2</span>,<span class="string">'m'</span>],[<span class="number">2</span>,<span class="string">'l'</span>],[<span class="number">2</span>,<span class="string">'l'</span>],[<span class="number">3</span>,<span class="string">'l'</span>],[<span class="number">3</span>,<span class="string">'m'</span>],[<span class="number">3</span>,<span class="string">'m'</span>],[<span class="number">3</span>,<span class="string">'l'</span>],[<span class="number">3</span>,<span class="string">'l'</span>]]  </div><div class="line">y = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>]  </div><div class="line">featuresList = createFeaturesList(X)  </div><div class="line">featuresMatrix = []  </div><div class="line"><span class="keyword">for</span> xi <span class="keyword">in</span> X:  </div><div class="line">    featuresMatrix.append(features2Vec(featuresList,xi))  </div><div class="line">P_0_Conditon,P_1_Conditon,P_Y_1 = train(featuresMatrix,y) </div><div class="line">goal = [<span class="number">2</span>,<span class="string">'s'</span>]</div><div class="line">features2Vec = np.array(features2Vec(featuresList,goal))</div><div class="line">print(classify(features2Vec,P_0_Conditon,P_1_Conditon,P_Y_1))</div></pre></td></tr></table></figure>
<p>ä½†å…¶å®è¿™ä¸ª<code>Naive Bayes</code>è¿˜æœ‰å¾ˆå¤šé—®é¢˜ï¼Œè­¬å¦‚è¯´é‡åˆ°æ¦‚ç‡ä¸º0ï¼Œè¿™ä¸ªæ—¶å€™åº”è¯¥ç”¨è´å¶æ–¯ä¼°è®¡ï¼Œåœ¨å…¬å¼é‡Œé¢åŠ ä¸Šæ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ï¼Œé‚£ä¹ˆåˆ†ç±»åå·®å°†ä¼šå°‘å¾ˆå¤šã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/17/Logistic-Rregression/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å½¼å¾—çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/12/17/Logistic-Rregression/" itemprop="url">
                  Logistic Rregression
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-12-17T10:53:16+08:00">
                2017-12-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Machine-Learning/" itemprop="url" rel="index">
                    <span itemprop="name">Machine Learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>ä»Šå¤©çœ‹äº†æå¤§ä¼¼ç„¶ä¼°è®¡(<code>Maximum likelihood evaluation</code>)ï¼Œç„¶åå°±çœ‹åˆ°æå¤§ä¼¼ç„¶ä¼°è®¡åœ¨<code>Logistic Regression</code>ä¸Šé¢çš„åº”ç”¨ï¼Œå¿½ç„¶æœ‰ä¸€ç§é†é†çŒé¡¶çš„æ„Ÿè§‰ã€‚</p>
<p>é¦–å…ˆï¼ŒåŸæ¥<code>Logistic Regression</code>çš„ä¸­æ–‡è¯»æ³•æ˜¯é€»è¾‘æ–¯è°›å›å½’è€Œä¸æ˜¯é€»è¾‘å›å½’ï¼ŒçŸ¥é“çœŸç›¸çš„æˆ‘å¿½ç„¶è§‰å¾—ä»¥å‰çš„è‡ªå·±å¥½åœŸã€‚ã€‚ä½†è¿™ä¸æ˜¯é‡ç‚¹ï¼Œå…¶å®è¿™æ˜¯é‡ç‚¹ã€‚ã€‚å¥½å§</p>
<p><code>Logistic Regression</code>æ˜¯æ ¹æ®ä¸åŒçš„ç‰¹å¾é‡ï¼Œè¾“å‡º0å’Œ1ï¼Œå¹¶ä¸”åªèƒ½è¾“å‡º0å’Œ1ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>Sigmoid</code>å‡½æ•°æ¥å®ç°ã€‚ <span class="math display">\[
\sigma(x)  = \frac{1}{1+e^{-w x}} = \frac{e^{wt}}{1 + e^{wx}}
\]</span></p>
<p><span class="math display">\[
\sigma&#39;(x) =  \sigma(x)(1 - \sigma(x))
\]</span></p>
<p>è€Œä¸ºä»€ä¹ˆä¼šæ¶‰åŠåˆ°æå¤§ä¼¼ç„¶ä¼°è®¡å‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿåœ¨ç»™å®šçš„æ¦‚ç‡å¯†åº¦å‡½<code>Ïƒ(x)</code>ï¼Œä»¥åŠæ ·æœ¬æ•°æ®ä¸­ï¼Œå¾—åˆ°èƒ½å¤Ÿä»¥æœ€å¤§æ¦‚ç‡å‘ç”Ÿæ ·æœ¬æ•°æ®çš„å‚æ•°<code>w</code>çš„ä¼°è®¡ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å¼•å…¥ä¼¼ç„¶å‡½æ•°å¹¶ä¸”è®¡ç®—æå¤§ä¼¼ç„¶ä¼°è®¡ã€‚</p>
<p>ç¡®å®šäº†åˆ†ç±»å‡½æ•°ä¹‹åï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æŠŠ<code>Sigmoid</code>å‡½æ•°çš„è¾“å…¥è®°ä¸º<code>z</code>ï¼Œåˆ™ <span class="math display">\[
z = w_0x_0+w_1x_1+w_2x_2+...+w_nx_n = w^Tx
\]</span> å‘é‡<code>x</code>æ˜¯ç‰¹å¾å˜é‡ï¼Œæ˜¯è¾“å…¥æ•°æ®ï¼Œå‘é‡<code>w</code>æ˜¯å›å½’ç³»æ•°ã€‚æ‰€ä»¥æˆ‘ä»¬è¦åšçš„äº‹æƒ…å°±æ˜¯å¦‚ä½•ç¡®å®šæœ€ä¼˜çš„å›å½’ç³»æ•°<code>w(w0, w1, w2, ..., wn)</code></p>
<p>ç°åœ¨æ¥çœ‹çœ‹æˆ‘ä»¬æœ‰ä»€ä¹ˆå…¬å¼</p>
<ul>
<li><p>è¾“å…¥ç‰¹å¾å˜é‡ï¼š <span class="math display">\[z = w_0x_0+w_1x_1+w_2x_2+...+w_nx_n = w^Tx\]</span></p></li>
<li><p>åˆ†ç±»å‡½æ•°ï¼ˆé¢„æµ‹å‡½æ•°ï¼‰ï¼š <span class="math display">\[ h(z) =  \frac{1}{1+e^{-z}} = h_w(x)= \frac{1}{1+e^{-w^Tx}} \]</span></p></li>
<li><p>å¯¹äºä»»æ„ç¡®å®šçš„<code>x</code>å’Œ<code>w</code>ï¼Œæœ‰ï¼š</p>
<p><span class="math display">\[P(y=1|x, w)=h_w(x)\]</span></p>
<p><span class="math display">\[P(y = 0|x, w) = 1 - h_w(x)\]</span></p></li>
</ul>
<p>è¿™ä¸ªå…¬å¼å¯ä»¥å†™æˆï¼š <span class="math display">\[
P(y|x, w) = (h_w(x))^y(1-h_w(x))^{1-y}
\]</span></p>
<p>å–ä¼¼ç„¶å‡½æ•°ï¼š <span class="math display">\[
\begin{aligned}
L(w)&amp; =\prod_{i=1}^{m}P(y^{(i)}|x^{(i)}, w) \\
&amp; =\prod_{i = 1}^{m}(h_w(x^{(i)}))^{y^{(i)}}(1-h_w(x^{(i)}))^{1-y^{(i)}} 
\end{aligned}
\]</span> ç„¶åè½¬åŒ–ä¸ºå¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼Œè¿™æ ·æ›´æ–¹ä¾¿æ±‚è§£ã€‚ <span class="math display">\[
J(w) = logL(w) = \sum_{i=1}^{m}(y^{(i)}logh_w(x^{(i)}) + (1-y^{(i)})log(1-h_w(x^{(i)})))
\]</span> å¾—åˆ°å¯¹æ•°ä¼¼ç„¶å‡½æ•°<code>J(w)</code>åï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨å‡½æ•°<code>J(w)</code>æ¥è¡¨ç¤ºé¢„æµ‹å€¼å’Œå®é™…å€¼çš„åå·®ã€‚<code>J(w)</code>è¶Šå¤§ï¼Œè¡¨ç¤ºé¢„æµ‹å€¼ä¸å®é™…å€¼çš„å·®å¼‚è¶Šå°ï¼Œé¢„æµ‹è¶Šå‡†ç¡®ã€‚</p>
<p><code>Cost</code>å‡½æ•°å¯ä»¥å†™æˆï¼š <span class="math display">\[
Cost(h_w^x, y)=\left\{
\begin{aligned}
logh_w(x), &amp;  &amp;  { y = 1}  \\
1 - logh_w(x), &amp; &amp; {y = 0}
\end{aligned}
\right.
\]</span> ä¸‹é¢æˆ‘ä»¬éœ€è¦æ±‚<code>Cost</code>å‡½æ•°çš„æœ€å¤§å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹<code>J(w)</code>è¿›è¡Œæ±‚åå¯¼ï¼š <span class="math display">\[
\begin{aligned}
\frac {\partial}{\partial {w_j}}J(w) &amp; = \sum_{i=1}^m((y^{(i)}\frac{1}{h_w(x^{(i)})}-(1-y^{(i)})\frac{1}{1-h_w(x^{(i)})})\cdot\frac{\partial{h_w(x^{(i)})}}{\partial {w_j}})  \\
&amp; = \sum_{i=1}^m((y^{(i)}\frac{1}{h_w(x^{(i)})}-(1-y^{(i)})\frac{1}{1-h_w(x^{(i)})})\cdot(h_w(x^{(i)})\cdot(1-h_w(x^{(i)}))\cdot x_j) \\
&amp; = \sum_{i=1}^m((y^{(i)}\cdot (1-h_w(x^{(i)} )-(1-y^{(i)})\cdot h_w(x^{(i)})) \cdot x_j) \\
&amp; = \sum_{i=1}^m(y^{(i)}-h_w(x^{(i)}))\cdot x_j)
\end{aligned}
\]</span> å› æ­¤æˆ‘ä»¬å¾—åˆ°äº†æ¢¯åº¦ä¸Šå‡æ³•è¿­ä»£å…¬å¼ï¼š <span class="math display">\[
w_j := w_j + \alpha\sum_{i=1}^m(y^{(i)}-h_w(x^{(i)}))\cdot x_j)
\]</span> å¼„æ¸…æ¥šæ¯ä¸€å—åšä»€ä¹ˆä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨Pythonå†™ä¸€é<code>Logistic Regression</code>äº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(z)</span>:</span></div><div class="line">	<span class="keyword">return</span> <span class="number">1</span> / (<span class="number">1</span> + np.exp(-z))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">log_likelihood</span><span class="params">(X, y, w)</span>:</span></div><div class="line">	hypothesis = sigmoid(np.dot(w.T, x))</div><div class="line">	ll = np.sum(y * np.log(hypothesis) + (<span class="number">1</span> - y) * np.log(<span class="number">1</span> - hypothesis))</div><div class="line">	<span class="keyword">return</span> ll</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">logistic_regression</span><span class="params">(X, y, num_steps, learning_rate, add_intercept = False)</span>:</span></div><div class="line">	<span class="keyword">if</span> add_intercept:</div><div class="line">		intercept = np.ones((X.shape[<span class="number">0</span>], <span class="number">1</span>))</div><div class="line">		X = np.hstack((intercept, X))</div><div class="line"></div><div class="line">	weights = np.zeros(X.shape[<span class="number">1</span>])</div><div class="line"></div><div class="line">	<span class="keyword">for</span> step <span class="keyword">in</span> range(num_steps):</div><div class="line">		hypothesis = sigmoid(np.dot(X, weights.T))</div><div class="line">		error = y - hypothesis</div><div class="line">		gradient = np.dot(X.T, error)</div><div class="line">		weights += learning_rate * gradient</div><div class="line"></div><div class="line">	<span class="keyword">return</span> weights</div><div class="line"></div><div class="line">np.random.seed(<span class="number">12</span>)</div><div class="line">num_observations = <span class="number">5000</span></div><div class="line"></div><div class="line">x1 = np.random.multivariate_normal([<span class="number">0</span>, <span class="number">0</span>], [[<span class="number">1</span>, <span class="number">.75</span>], [<span class="number">.75</span>, <span class="number">1</span>]], num_observations)</div><div class="line">x2 = np.random.multivariate_normal([<span class="number">1</span>, <span class="number">4</span>], [[<span class="number">1</span>, <span class="number">.75</span>], [<span class="number">.75</span>, <span class="number">1</span>]], num_observations)</div><div class="line"></div><div class="line">X = np.vstack((x1, x2)).astype(np.float32)</div><div class="line">y = np.hstack((np.zeros(num_observations), np.ones(num_observations)))</div><div class="line"></div><div class="line">weights = logistic_regression(X, y, num_steps = <span class="number">50000</span>, learning_rate = <span class="number">5e-5</span>, add_intercept = <span class="keyword">True</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</div><div class="line"></div><div class="line">clf = LogisticRegression(fit_intercept=<span class="keyword">True</span>, C=<span class="number">1e15</span>)</div><div class="line">clf.fit(X, y)</div><div class="line">print(clf.intercept_, clf.coef_)</div><div class="line">print(weights)</div><div class="line"></div><div class="line">final_distribtion = np.dot(np.hstack((np.ones((X.shape[<span class="number">0</span>], <span class="number">1</span>)),</div><div class="line">						X)), weights)</div><div class="line">preds = np.round(sigmoid(final_distribtion))</div><div class="line">print(<span class="string">'Accuracy from scratch: &#123;0&#125;'</span>.format((preds == y).sum().astype(float) / len(preds)))</div><div class="line">print(<span class="string">'Accuracy from scikit-learn: &#123;0&#125;'</span>.format(clf.score(X, y)))</div><div class="line"></div><div class="line">[output]</div><div class="line"><span class="comment"># [-13.99400797] [[-5.02712572  8.23286799]]</span></div><div class="line"><span class="comment"># [-13.58690551  -4.8809644    7.99812915]</span></div><div class="line"><span class="comment"># Accuracy from scratch: 0.9948</span></div><div class="line"><span class="comment"># Accuracy from scikit-learn: 0.9948</span></div></pre></td></tr></table></figure>
<p>è²Œä¼¼è·Ÿ<code>scikit-learn</code>çš„ç»“æœå¾ˆæ¥è¿‘ï¼Œå®åœ¨æ˜¯å¤ªå¼€å¿ƒäº†ã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/13/Gradient-Descent/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å½¼å¾—çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/12/13/Gradient-Descent/" itemprop="url">
                  Gradient Descent
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-12-13T18:15:00+08:00">
                2017-12-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Machine-Learning/" itemprop="url" rel="index">
                    <span itemprop="name">Machine Learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>ä»å…­æœˆä»½å¼€å§‹ï¼Œå·²ç»çœ‹äº†å¾ˆå¤šPythonæœºå™¨å­¦ä¹ çš„ä¹¦ç±å’Œæ•™ç¨‹ï¼Œä½†æ˜¯ä¾ç„¶æœ‰äº›æ‘¸ä¸ç€å¤´è„‘ã€‚ç°åœ¨çœ‹æ¥ï¼Œå…¶å®ä¸€æ–¹é¢æ˜¯å¤ªè¿‡æ³¨é‡åº”ç”¨å±‚é¢è€Œæ²¡æœ‰å…³æ³¨å®è´¨æ€§çš„æ•°å­¦å±‚é¢å†…å®¹ã€‚è€Œå¦‚æœæ…¢æ…¢çœ‹ç®—æ³•å…¬å¼ï¼Œå…¶å®å¾ˆå¤šç–‘ç‚¹éƒ½ä¼šè¢«è§£å†³ã€‚æˆ‘è§‰å¾—è‡ªå·±å¯¹äºè¿™æ–¹é¢æ˜¯æœ‰ç€ä¸€ä¸ªè¿‘ä¹æåº¦ç–¯ç‹‚çš„æ‰§è¿·ï¼Œå¾ˆæƒ³å¼„æ˜ç™½é‡Œé¢çš„è¿ä½œæœºåˆ¶ã€‚</p>
<p>è€Œä»Šå¤©è¿™ä¸€å†…å®¹é‡Œé¢ï¼Œæˆ‘å°†åˆ†äº«è‡ªå·±å¯¹æœºå™¨å­¦ä¹ ç®—æ³•é‡Œé¢çš„æ¢¯åº¦ä¸‹é™æ–¹æ³•åšä¸€ä¸ªç¬”è®°å’Œæ€»ç»“ã€‚</p>
<p>åœ¨è¿›è¡Œè§£é‡Šæ¢¯åº¦ä¸‹é™æ–¹æ³•ä¹‹å‰ï¼Œéœ€è¦å¯¹æ–¹å‘å¯¼æ•°å’Œæ¢¯åº¦åšä¸€ä¸ªåŸºæœ¬çš„è§£é‡Šã€‚</p>
<blockquote>
<p>å¯¹äº<strong>æ–¹å‘å¯¼æ•°</strong>ï¼Œè®¾ z = f(x, y) åœ¨M0(x0, y0)å¤„å¯å¾®ï¼Œåˆ™f(x, y)åœ¨M0ç‚¹ä»»æ„æ–¹å‘<strong><em>l</em></strong> = ï¼ˆcosa, cosb)å­˜åœ¨æ–¹å‘å¯¼æ•°ä¸”ï¼š <span class="math display">\[
\frac{\partial f(x_0, y_0)}{\partial l} = \frac{\partial f(x_0, y_0)}{\partial x}cos\alpha+\frac{\partial f(x_0, y_0)}{\partial y}cos\beta
\]</span> å¯¹äºæ¢¯åº¦ï¼Œå‡½æ•°z = f(x, y)åœ¨ç‚¹M0çš„æ–¹å‘å¯¼æ•°è®¡ç®—å…¬å¼å¯æ”¹å†™æˆï¼š</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial f(x_0, y_0)}{\partial l} &amp; = (\frac{\partial f(x_0, y_0)}{\partial x}, \frac{\partial f(x_0, y_0)}{\partial y})Â· (cos \alpha, cos \beta) \\ \\ 
&amp; = grad(x_0, y_0)Â·l \\
 \\
&amp; = |gradf(x_0, y_0)|cos&lt;grad(x_0, y_0), l&gt;
\end{aligned}
\]</span> åœ¨è¿™é‡Œå‘é‡: <span class="math display">\[
grad  f(x_0, y_0) = (\frac{\partial f(x_0, y_0)}{x} , \frac{\partial f(x_0, y_0)}{\partial y} ï¼‰
\]</span></p>
<p>ç§°ä¸ºz = f(x, y) åœ¨ç‚¹M0çš„æ¢¯åº¦ï¼ˆå‘é‡ï¼‰ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬éœ€è¦æ±‚å¾—å‡½æ•°ä¸­æŸç‚¹å˜åŒ–æœ€å¿«çš„å€¼ï¼Œå…¶å®ä¹Ÿå°±æ˜¯æ±‚æ–¹å‘å¯¼æ•°æ¨¡çš„æœ€å¤§å€¼ï¼Œé‚£ä¹ˆæ¢¯åº¦çš„æ–¹å‘éœ€è¦è·Ÿå•ä½æ–¹å‘å‘é‡çš„å¤¹è§’ä¸º0ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå‡½æ•°åœ¨æŸç‚¹çš„æ¢¯åº¦ï¼Œå…¶æ–¹å‘æ˜¯å‡½æ•°åœ¨è¯¥ç‚¹çš„æ–¹å‘å¯¼æ•°æœ€å¤§çš„æ–¹å‘ï¼Œå®ƒçš„æ¨¡æ˜¯æœ€å¤§æ–¹å‘å¯¼æ•°çš„å€¼ã€‚</p>
</blockquote>
<p>å› æ­¤å¯¹äºæ–¹å‘å¯¼æ•°è€Œè¨€ï¼Œæ±‚çš„æ˜¯å‡½æ•°ä¸­æŸç‚¹åœ¨æŸä¸ªæ–¹å‘ä¸‹çš„å¯¼æ•°ï¼Œä¸åŒæ–¹å‘çš„å¯¼æ•°éƒ½ä¸ç›¸åŒï¼Œä¹Ÿå°±è¯´å‡½æ•°ä¸­æŸç‚¹æ²¿ä¸åŒæ–¹å‘çš„å˜åŒ–é€Ÿåº¦ä¸ä¸€æ ·ã€‚è€Œæ¢¯åº¦å°±æ˜¯å‡½æ•°å¯¹å˜é‡åå¯¼æ•°çš„é›†åˆã€‚</p>
<p>å‡è®¾æœ‰å¦‚ä¸‹ä¸€ä¸ªçº¿æ€§å›å½’é—®é¢˜ï¼Œå…¬å¼å¦‚ä¸‹ï¼š &gt; <span class="math display">\[
&gt; h(x) =h_\theta(x) =\theta_0+\theta_1x_1+\theta_2x_2
&gt; \]</span> &gt;</p>
<p>å…¶ä¸­xæ˜¯è‡ªå˜é‡ï¼Œæ¯”å¦‚è¯´æˆ¿å­é¢ç§¯ï¼ŒÎ¸æ˜¯æƒé‡å‚æ•°ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ±‚è§£çš„å…·ä½“å€¼ã€‚</p>
<p>ç„¶åæˆ‘ä»¬è¿˜éœ€è¦å¼•å…¥æŸå¤±å‡½æ•°ï¼ˆ<code>Loss Function</code>æˆ–è€…å«<code>Cost Function</code>)ï¼Œç›®çš„æ˜¯ä¸ºäº†åœ¨æ¢¯åº¦ä¸‹é™æ—¶ç”¨æ¥è¡¡é‡æ›´æ–°åçš„å‚æ•°æ˜¯å¦æ˜¯å‘ç€æ­£ç¡®çš„æ–¹å‘å‰è¿›ã€‚å¦‚ä¸‹æŸå¤±å‡½æ•°(mè¡¨ç¤ºè®­ç»ƒé›†æ ·æœ¬æ•°é‡)</p>
<p><span class="math display">\[
J(\theta) = \sum_{i=1}^{m}\frac{1}{2}Â·(h_\theta(x^{(i)}) - y^{(i)})^2
\]</span> å› ä¸ºæˆ‘ä»¬çš„ç›®çš„ï¼Œæ˜¯è¦æ‰¾åˆ°è¿™ä¸ªæŸå¤±å‡½æ•°çš„å€¼æœ€å°çš„å‚æ•°ä¸‹çš„ç›®æ ‡å‡½æ•°<code>h(x)</code>ï¼Œæ‰€ä»¥é¢å¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å…¶å®å¾ˆå®¹æ˜“æƒ³åˆ°åå¯¼æ•°ã€‚ç»“åˆæ–¹å‘å¯¼æ•°ä»¥åŠæ¢¯åº¦è¿™ä¸€ä¸ªæ¦‚å¿µï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æŸä¸ªæ ·æœ¬æ•°æ®åœ¨å‡½æ•°ä¸­ä¸‹é™é€Ÿåº¦æœ€å¿«çš„æ–¹å‘ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿå¯¹<code>Loss Function</code>æ±‚æœ€ä¼˜è§£ï¼Œè€Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ±‚<code>Loss Function</code>çš„æ¢¯åº¦ç„¶åä¸æ–­æ›´æ–°å‚æ•°æ¥å¾—åˆ°ã€‚å¦‚æœæˆ‘ä»¬å¾—åˆ°äº†<code>Loss Function</code>çš„æœ€ä¼˜è§£ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå°±èƒ½å¾—åˆ°ç›®æ ‡å‡½æ•°<code>h(x)</code>ã€‚</p>
<p>ä¸‹é¢å°†å¯¹<code>Loss Function</code>è¿›è¡ŒæŸä¸€ä¸ªå‚æ•°Î¸içš„åå¯¼æ•°ï¼š</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial}{\partial \theta_j}J(\theta) &amp;= \frac{\partial}{\partial \theta_j}\frac{1}{2}Â·(h_\theta(x) - y)^2 \\\\
&amp; = 2 Â· \frac{1}{2}Â·(h_\theta(x) - y) Â· \frac{\partial}{\partial \theta_j}(h_\theta(x) - y) \\\\
&amp; = (h_\theta(x) - y)  \cdot \frac{\partial}{\partial \theta_j}(\sum_{i=0}^{n}\theta_ix_i- y) \\\\
&amp; = h_\theta(x) - y) x_j
\end{aligned}
\]</span> åœ¨æ±‚å‡º<code>Loss Function</code>å¯¹äºæŸä¸€ä¸ªå‚æ•°çš„åå¯¼æ•°ä¹‹åï¼Œæˆ‘ä»¬å®é™…ä¸Šå·²ç»æ±‚å¾—åˆ°äº†<code>Loss Function</code>åœ¨æŸä¸€ç‚¹M0ä¸‹å˜åŒ–é€Ÿåº¦æœ€å¿«çš„æ–¹å‘ï¼Œä¹Ÿå°±æ˜¯ç¡®å®šÎ¸içš„å€¼ã€‚è¿™ä¸ªæ—¶å€™ï¼Œåªè¦é€æ­¥è¿­ä»£ï¼Œå°±å¯ä»¥æ±‚å‡ºåœ¨ç»™å®šçš„æ•°æ®é›†ä¸­ï¼Œ<code>Loss Function</code>æœ€ä¼˜è§£ä¸‹çš„ç›®æ ‡å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰Î¸çš„æœ€ä¼˜è§£ã€‚</p>
<p>äºæ˜¯å¯¹äºè¿™ä¸€ä¸ªæœ€åŸºæœ¬çš„çº¿æ€§å›å½’ä¾‹å­ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä¸Š<code>Python</code>ä»£ç äº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="comment">#y=2 * (x1) + (x2) + 3 </span></div><div class="line">rate = <span class="number">0.001</span></div><div class="line">x_train = np.array([    [<span class="number">1</span>, <span class="number">2</span>],    [<span class="number">2</span>, <span class="number">1</span>],    [<span class="number">2</span>, <span class="number">3</span>],    [<span class="number">3</span>, <span class="number">5</span>],    [<span class="number">1</span>, <span class="number">3</span>],    [<span class="number">4</span>, <span class="number">2</span>],    [<span class="number">7</span>, <span class="number">3</span>],    [<span class="number">4</span>, <span class="number">5</span>],    [<span class="number">11</span>, <span class="number">3</span>],    [<span class="number">8</span>, <span class="number">7</span>]    ])</div><div class="line">y_train = np.array([<span class="number">7</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">20</span>, <span class="number">16</span>, <span class="number">28</span>, <span class="number">26</span>])</div><div class="line">x_test  = np.array([    [<span class="number">1</span>, <span class="number">4</span>],    [<span class="number">2</span>, <span class="number">2</span>],    [<span class="number">2</span>, <span class="number">5</span>],    [<span class="number">5</span>, <span class="number">3</span>],    [<span class="number">1</span>, <span class="number">5</span>],    [<span class="number">4</span>, <span class="number">1</span>]    ])</div><div class="line"></div><div class="line">a = np.random.normal()</div><div class="line">b = np.random.normal()</div><div class="line">c = np.random.normal()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">h</span><span class="params">(x)</span>:</span></div><div class="line">    <span class="keyword">return</span> a*x[<span class="number">0</span>]+b*x[<span class="number">1</span>]+c</div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10000</span>):</div><div class="line">    sum_a=<span class="number">0</span></div><div class="line">    sum_b=<span class="number">0</span></div><div class="line">    sum_c=<span class="number">0</span></div><div class="line">    <span class="keyword">for</span> x, y <span class="keyword">in</span> zip(x_train, y_train):</div><div class="line">        sum_a = sum_a + rate*(y-h(x))*x[<span class="number">0</span>]</div><div class="line">        sum_b = sum_b + rate*(y-h(x))*x[<span class="number">1</span>]</div><div class="line">        sum_c = sum_c + rate*(y-h(x))</div><div class="line">    a = a + sum_a</div><div class="line">    b = b + sum_b</div><div class="line">    c = c + sum_c</div><div class="line">    plt.plot([h(xi) <span class="keyword">for</span> xi <span class="keyword">in</span> x_test])</div><div class="line"></div><div class="line">print(a)</div><div class="line">print(b)</div><div class="line">print(c)</div><div class="line"></div><div class="line">result=[h(xi) <span class="keyword">for</span> xi <span class="keyword">in</span> x_train]</div><div class="line">print(result)</div><div class="line"></div><div class="line">result=[h(xi) <span class="keyword">for</span> xi <span class="keyword">in</span> x_test]</div><div class="line">print(result)</div><div class="line"></div><div class="line">plt.show()</div></pre></td></tr></table></figure>
<p><img src="/images/Figure_1.png"></p>
<p>ç„¶è€Œï¼Œ è¿™æ ·çš„å†™æ³•å¯¹äºæ•ˆç‡è€Œè¨€æ˜¯ä¸€ä¸ªååˆ†å¤§çš„é—®é¢˜ï¼Œï¼Œæ•´ä¸ªç¨‹åºè·‘ä¸‹æ¥çš„æ—¶é—´ååˆ†é•¿ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå°±æƒ³åˆ°äº†<strong>æ¢¯åº¦ä¸‹é™çŸ¢é‡åŒ–</strong>ï¼Œé€šè¿‡çŸ¢é‡åŒ–ï¼Œèƒ½å¤Ÿå°†è¿ç®—è¿‡ç¨‹è½¬ä¸ºçº¿æ€§ä»£æ•°çš„è®¡ç®—ï¼Œåˆ©ç”¨é€†çŸ©é˜µå’ŒçŸ©é˜µä¹˜æ³•ï¼Œæ•´ä¸ªè®¡ç®—é€Ÿåº¦å¤§å¤§æé«˜ã€‚</p>
<p><span class="math display">\[
\begin{aligned}
h_\theta(x) &amp;= \theta_0 + \theta_1x_1 + \theta_2x_2  \\\\
J(\theta) &amp; = \frac{1}{2m}\sum_{i=1}^{m}(h_\theta(x^{(i)}) - y^{(i)})^{2} \\\\
\theta_j &amp;:= \theta_j - \alpha\frac{1}{m}\sum_{i=1}^{m}(h_\theta(x^{(i)}) - y^{(i)})x_j^{(i)}
\end{aligned}
\]</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="comment">#y=2 * (x1) + (x2) + 3 </span></div><div class="line">rate = <span class="number">0.001</span></div><div class="line">X = np.array([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">2</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">3</span>], </div><div class="line">              [<span class="number">3</span>, <span class="number">5</span>], [<span class="number">1</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">2</span>], </div><div class="line">              [<span class="number">7</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>], [<span class="number">11</span>, <span class="number">3</span>]])</div><div class="line">y = np.array([<span class="number">7</span>, <span class="number">8</span>, <span class="number">10</span>, </div><div class="line">              <span class="number">14</span>, <span class="number">8</span>, <span class="number">13</span>, </div><div class="line">              <span class="number">20</span>, <span class="number">16</span>, <span class="number">28</span>])</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_cost</span><span class="params">(X, y, theta)</span>:</span></div><div class="line">	<span class="keyword">return</span> np.sum(np.square(np.dot(X, theta) - y)) / (<span class="number">2</span> * len(y))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">gradient_descent_vectorization</span><span class="params">(X, y, learning_rate, iterations)</span>:</span></div><div class="line">	X = np.column_stack((np.ones(len(X)), X))</div><div class="line">	theta = np.zeros(X.shape[<span class="number">1</span>])</div><div class="line">	m = len(X)</div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(iterations):</div><div class="line">		hypothesis = np.dot(X, theta)</div><div class="line">		loss = hypothesis - y</div><div class="line">		gradient = np.dot(X.T, loss) / m</div><div class="line">		theta = theta - learning_rate * gradient</div><div class="line">	<span class="keyword">return</span> X, theta</div><div class="line"></div><div class="line">learning_rate = <span class="number">0.01</span></div><div class="line">iterations = <span class="number">50000</span></div><div class="line">X, theta = gradient_descent_vectorization(X, y, learning_rate, iterations)</div><div class="line">cost = compute_cost(X, y, theta)</div><div class="line"></div><div class="line">print(<span class="string">"theta1 = "</span>,theta[<span class="number">1</span>], <span class="string">"theta2 = "</span>, theta[<span class="number">2</span>], <span class="string">"theta3 = "</span>, theta[<span class="number">0</span>])</div><div class="line">print(<span class="string">'cost:'</span>, cost)</div><div class="line"></div><div class="line"></div><div class="line">[output]</div><div class="line">theta1 =  <span class="number">2.02720821766</span> theta2 =  <span class="number">1.17962898412</span> theta3 =  <span class="number">2.2645149405</span></div><div class="line">cost: <span class="number">0.0354239310129</span></div><div class="line">[Finished <span class="keyword">in</span> <span class="number">0.7</span>s]</div></pre></td></tr></table></figure>
<p>åªèƒ½è¯´ï¼Œç»è¿‡çŸ¢é‡åŒ–è¿ç®—åçš„æ¢¯åº¦ä¸‹é™æ•ˆç‡çœŸçš„å¾ˆé«˜ã€‚è¿˜æ²¡æœ‰çŸ¢é‡åŒ–çš„æ¢¯åº¦ä¸‹é™ï¼Œåœ¨ç›¸åŒè¿­ä»£æ¬¡æ•°å’Œå­¦ä¹ é€Ÿåº¦ä¸‹çš„æ‰€éœ€æ—¶é—´æ¥è¿‘67sï¼Œè€Œç›®å‰çŸ¢é‡åŒ–åçš„æ—¶é—´æ˜¯0.7sï¼Œè¶³è¶³å¿«äº†ä¸€ç™¾å€ã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/28/Python-zip-with-iter/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å½¼å¾—çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/28/Python-zip-with-iter/" itemprop="url">
                  Python zip( ) with iter( )
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-11-28T15:54:57+08:00">
                2017-11-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python-Notes/" itemprop="url" rel="index">
                    <span itemprop="name">Python_Notes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>ä»Šå¤©çœ‹åˆ°åˆ·leetcodeçš„æ—¶å€™ï¼Œçœ‹åˆ°å¦‚ä¸‹ä¸€ä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">matrixReshape</span><span class="params">(self, nums, r, c)</span>:</span></div><div class="line">        flat = sum(nums, [])</div><div class="line">        <span class="keyword">if</span> len(flat) != c*r:</div><div class="line">            <span class="keyword">return</span> nums</div><div class="line">        </div><div class="line">        tuples = zip(*([iter(flat)] * c))</div><div class="line">        <span class="keyword">return</span> map(list, tuples)</div></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘å°±å¯¹<code>tuples = zip(*([iter(flat)] * c))</code>å¾ˆç–‘æƒ‘ï¼Œä¸æ˜¯å¾ˆæ¸…æ¥šé‡Œé¢ç©¶ç«Ÿæ˜¯æ€ä¹ˆè¿è¡Œçš„ã€‚é€šè¿‡åœ¨ç½‘ä¸ŠæŸ¥æ‰¾å„ç§èµ„æ–™ï¼Œgoogleå’Œstackoverflowä¹‹åï¼Œæˆ‘å°è¯•æŠŠæˆ‘çš„ç†è§£å†™åœ¨ä¸‹é¢ã€‚</p>
<hr>
<p>é¦–å…ˆï¼Œ æ¥çœ‹<code>x=[[1, 2], [3, 4]]</code>ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">x = [[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]]</div><div class="line">a = zip(*[x]*<span class="number">3</span>)</div><div class="line"><span class="keyword">print</span> a</div><div class="line"></div><div class="line">[output]</div><div class="line">[([<span class="number">1</span>, <span class="number">2</span>], [<span class="number">1</span>, <span class="number">2</span>], [<span class="number">1</span>, <span class="number">2</span>]), ([<span class="number">3</span>, <span class="number">4</span>], [<span class="number">3</span>, <span class="number">4</span>], [<span class="number">3</span>, <span class="number">4</span>])]</div></pre></td></tr></table></figure>
<p>è€Œä¸Šé¢è¿™ä¸€æ­¥ç›¸å½“äºä¸‹é¢è¿™ä¸€æ­¥</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">b = zip(x, x, x)</div><div class="line"><span class="keyword">print</span> b</div><div class="line"></div><div class="line">[otuput]</div><div class="line">[([<span class="number">1</span>, <span class="number">2</span>], [<span class="number">1</span>, <span class="number">2</span>], [<span class="number">1</span>, <span class="number">2</span>]), ([<span class="number">3</span>, <span class="number">4</span>], [<span class="number">3</span>, <span class="number">4</span>], [<span class="number">3</span>, <span class="number">4</span>])]</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ¥çœ‹æˆ‘ä»¬æ¥çœ‹ä¸‹ <code>[x] * 3</code> çš„ç»“æœæ˜¯ä»€ä¹ˆã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">x2 = [x]*<span class="number">3</span></div><div class="line">x2</div><div class="line"></div><div class="line">[output]</div><div class="line">[[[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]], [[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]], [[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]]]</div></pre></td></tr></table></figure>
<p>ç»“æœæ˜¯[x]*3 ç”Ÿæˆä¸€ä¸ªåˆ—è¡¨x2ï¼Œç„¶åè¿™ä¸ªåˆ—è¡¨x2é‡Œé¢åŒ…æ‹¬ä¸‰ä¸ªå¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æ˜¯åˆ—è¡¨x</p>
<p>æ‰€ä»¥å½“æ‰§è¡Œ<code>zip(*[x]*3)</code>çš„æ—¶å€™ï¼Œå®ƒé¦–å…ˆunpackäº†<code>x2</code>è¿™ä¸€ä¸ªåˆ—è¡¨ï¼ŒæŠŠx2é‡Œé¢çš„å¯¹è±¡å…¨éƒ¨æ‹†åˆ†å‡ºæ¥ã€‚æ‰€ä»¥è¿™ä¸€è¡Œä»£ç çš„æ­¥éª¤åº”è¯¥æ˜¯ä»¥ä¸‹ï¼š</p>
<ul>
<li><code>[x]*3</code> ==&gt; <code>[x, x, x]</code>, è¿™é‡Œæˆ‘ä»¤ <code>buff = [x] * 3</code></li>
<li><code>*buff</code> ==&gt; <code>x, x, x</code></li>
<li>æ‰€ä»¥<code>zip(*buff)</code> ==&gt; <code>zip(x, x, x)</code></li>
</ul>
<p>ä¸‹é¢æ¥çœ‹çœ‹ï¼Œå¦‚æœç»“åˆäº†è¿­ä»£å™¨ä¼šæ€ä¹ˆæ ·ã€‚ä¾‹å­ï¼š <code>zip(*([iter(x)] * 2))</code></p>
<p>å¯¹äº <code>zip(*([iter(x)] * 2))</code> ï¼Œ å¦‚æœå°† <code>buff = iter(x)</code>ï¼Œé‚£ä¹ˆå°†ç­‰åŒäº <code>zip(buff, buff)</code> å› æ­¤</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">zip(*([iter(x)]*<span class="number">2</span>))</div><div class="line"></div><div class="line">[output]</div><div class="line">[([<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>])]</div></pre></td></tr></table></figure>
<p>å› ä¸º<code>iter()</code>æ˜¯è¿­ä»£å™¨ï¼Œè¿™é‡Œè¿­ä»£äº†ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡äº§å‡ºæ˜¯[1, 2]ï¼Œ ç¬¬äºŒæ¬¡æ˜¯[3, 4]ã€‚ç„¶åä¼šå°†è¿™æ¬¡è¿­ä»£ç»“æœç»„åˆæˆä¸€ä¸ªå…ƒç»„ã€‚è€Œç”±äºè¿­ä»£ä¸¤æ¬¡ä¹‹åï¼Œ<code>x</code>é‡Œé¢å·²ç»æ²¡æœ‰å¯¹è±¡å¯ä»¥è¿›è¡Œè¿­ä»£ï¼Œæ‰€ä»¥è¿”å›è¿™ä¸¤ä¸ªå¯¹è±¡æ‰€ç»„åˆçš„å…ƒç»„ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">buff = iter(x)</div><div class="line">zip(buff, buff)</div><div class="line"></div><div class="line">[output]</div><div class="line">[([<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>])]</div></pre></td></tr></table></figure>
<hr>
<p>å¥½äº†ï¼Œè§£é‡Šå®Œä¹‹åï¼Œé‚£ä¹ˆ<code>tuples = zip(*([iter(flat)] * c))</code>å°±å¾ˆå¥½ç†è§£äº†ã€‚</p>
<p>å‡è®¾<code>flat = [1, 2, 3, 4]</code>ï¼Œ<code>c = 2</code>ã€‚</p>
<ol type="1">
<li>è¿›è¡Œç¬¬ä¸€æ¬¡æ€»çš„è¿­ä»£ï¼Œé‡Œé¢åˆ†åˆ«è¿­ä»£ä¸¤æ¬¡<code>iter(flat)</code>, <code>iter(flat)</code>ï¼Œå°†ä¸¤æ¬¡ç»“æœç»„åˆæˆå…ƒç»„ï¼Œç»“æœæ˜¯<code>(1,2)</code></li>
<li>å› ä¸º<code>flat</code>é‡Œé¢è¿˜æœ‰ä¸¤ä¸ªå…ƒç´ <code>3</code>å’Œ<code>4</code>ï¼Œæ°å¥½èƒ½å‡‘åˆæˆä¸¤æ¬¡è¿­ä»£ï¼Œæ‰€ä»¥å†è¿›è¡Œè¿­ä»£ï¼Œå°†ä¸¤æ¬¡ç»“æœç»„åˆæˆå…ƒç»„ï¼Œè¿”å›ç»“æœ<code>(3, 4)</code></li>
<li>ç„¶åå†å°†è¿™ä¸¤ä¸ªç»“æœç»„åˆæˆåˆ—è¡¨å½¢å¼è¿”å›ï¼Œç»“æœæ˜¯<code>[(1, 2), (3, 4)]</code></li>
</ol>
<p>å‡è®¾<code>flat = [1, 2, 3, 4]</code>ï¼Œ<code>c = 1</code>ã€‚</p>
<ol type="1">
<li>è¿›è¡Œç¬¬ä¸€æ¬¡è¿­ä»£<code>iter(flat)</code>ï¼Œå°†ç»“æœç»„åˆæˆå…ƒç»„ï¼Œç»“æœæ˜¯<code>(1,)</code></li>
<li>è¿›è¡Œç¬¬äºŒæ¬¡è¿­ä»£<code>iter(flat)</code>ï¼Œå°†ç»“æœç»„åˆæˆå…ƒç»„ï¼Œç»“æœæ˜¯<code>(2,)</code></li>
<li>è¿›è¡Œç¬¬ä¸‰æ¬¡è¿­ä»£<code>iter(flat)</code>ï¼Œå°†ç»“æœç»„åˆæˆå…ƒç»„ï¼Œç»“æœæ˜¯<code>(3,)</code></li>
<li>è¿›è¡Œç¬¬å››æ¬¡è¿­ä»£<code>iter(flat)</code>ï¼Œå°†ç»“æœç»„åˆæˆå…ƒç»„ï¼Œç»“æœæ˜¯<code>(4,)</code></li>
<li>å°†è¿™å››æ¬¡è¿­ä»£çš„ç»“æœç»„åˆæˆåˆ—è¡¨å½¢å¼è¿”å›ï¼Œç»“æœæ˜¯<code>[(1,), (2,), (3, ), (4,)]</code></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/05/MLè¯»ä¹¦ç¬”è®°ä¸€/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å½¼å¾—çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/05/MLè¯»ä¹¦ç¬”è®°ä¸€/" itemprop="url">
                  MLè¯»ä¹¦ç¬”è®°ä¸€
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-09-05T09:51:37+08:00">
                2017-09-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Machine-Learning/" itemprop="url" rel="index">
                    <span itemprop="name">Machine Learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>æœ‰å¥½é•¿ä¸€æ®µæ—¶é—´æ²¡æœ‰æ›´æ–°åšå®¢ï¼Œå‰æ®µæ—¶é—´ä¸€ç›´éƒ½åœ¨çœ‹æœºå™¨å­¦ä¹ çš„ç›¸å…³ä¹¦ç±ï¼Œä½†ä¸€ç›´éƒ½æ²¡æœ‰çœ‹å¤ªæ‡‚ã€‚ç¬¬ä¸€æœ¬çœ‹çš„æ˜¯è·Ÿè´å¶æ–¯æ¦‚ç‡ç›¸å…³çš„ï¼Œå°è±¡æœ€æ·±åˆ»çš„æ˜¯é‡Œé¢è®²äº†ä¸€ä¸ª<code>pymc</code>çš„åº“ï¼Œå¾ˆå¤šç»†èŠ‚å‚æ•°ä¹¦æœ¬ä¸Šå¹¶æ²¡æœ‰åšå¾ˆè¯¦å°½çš„è§£é‡Šï¼Œå¤§å¤šæ•°æ—¶å€™å°±ç›´æ¥è®²å¦‚ä½•åº”ç”¨ï¼Œè™½ç„¶è§è¯†äº†è¿™ä¸ªåº“çš„å¼ºå¤§ï¼Œä½†æœ‰å¾ˆå¤šåœ°æ–¹å’Œæ€è·¯éƒ½æ— ä»é€‚åº”ã€‚ç¬¬äºŒæœ¬ä¹¦è®²çš„æ˜¯Pythonæœºå™¨å­¦ä¹ é‡Œé¢ä¸€äº›åŸºæœ¬æ¦‚å¿µå’Œåº”ç”¨ï¼Œä»ç›‘ç£å­¦ä¹ æ— ç›‘ç£å­¦ä¹ åˆ°çº¿æ€§å›å½’é‡Œé¢çš„æœ€å°äºŒä¹˜æ³•å’Œå²­å›å½’ï¼Œåˆ°äº†åé¢çš„é›†æˆå­¦ä¹ æ–¹æ³•ã€‚è¿™æœ¬ä¹¦æˆ‘åŸºæœ¬ä¸Šå°±æ˜¯ä»£ç éƒ½æ•²è¿‡ä¸€éï¼Œæ€»ä½“ä¸Šæ‘¸äº†ä¸€äº›æ€è·¯ã€‚ä¹¦æœ¬æŠŠä¸€äº›æ¨¡å‹çš„ç»†èŠ‚è®²å¾—å¾ˆç»†ï¼Œä¼¼æ‡‚éæ‡‚ã€‚ä½†æ— è®ºå¦‚ä½•ï¼Œè¢«è¿™ä¸¤æœ¬ä¹¦è™å®Œä¹‹åï¼Œæˆ‘æ€»ç®—å¯¹æœºå™¨å­¦ä¹ çš„è®¤è¯†ç›¸æ¯”ä»¥å‰æ²¡æœ‰é‚£ä¹ˆæ¨¡ç³Šï¼Œ</p>
<p>ç°åœ¨æˆ‘çš„å­¦ä¹ è®¡åˆ’å°±æ˜¯ï¼Œçœ‹ä¸€ç« å‘¨å¿—åè€å¸ˆçš„<code>ã€Šæœºå™¨å­¦ä¹ ã€‹</code>ï¼ŒæŠŠæ¦‚å¿µæ•°å­¦å…¬å¼å…¨éƒ¨å¼„æ¸…æ¥šï¼Œä¸ç€æ€¥çœ‹ä¸‹ä¸€ç« ã€‚ç„¶ååœ¨<code>ã€ŠPythonæœºå™¨å­¦ä¹ ç»å…¸å®ä¾‹ã€‹</code>æŠŠå¯¹åº”çš„æ¡ˆä¾‹å’Œåº”ç”¨éƒ½å­¦ä¸€éï¼Œåšåˆ°å­¦ä»¥è‡´ç”¨ã€‚ç„¶ååœ¨Youtubeä¸Šçœ‹æå®æ¯…æ•™æˆå¯¹åº”çš„MLè¯¾ç¨‹ï¼Œæœ€ååœ¨<code>ã€ŠPythonæ•°æ®åˆ†æå®æˆ˜ã€‹</code>çœ‹ä¸€ç« ï¼Œå·©å›º<code>Python</code>åœ¨æ•°æ®åˆ†æé‡Œé¢åº“çš„åº”ç”¨ã€‚ç„¶åå†<code>ã€Šæœºå™¨å­¦ä¹ ã€‹</code>â€”&gt;<code>ã€ŠPythonæœºå™¨å­¦ä¹ ç»å…¸æ¡ˆä¾‹ã€‹</code>â€”&gt;Youtubeä¸­æå®æ¯…æ•™æˆå¯¹åº”çš„MLè¯¾ç¨‹â€”&gt;<code>ã€ŠPythonæ•°æ®åˆ†æå®æˆ˜ã€‹</code>å¾ªç¯ã€‚ç›®å‰åœ¨è¿›è¡Œç¬¬ä¸€ä¸ªå¾ªç¯ï¼Œåˆšåˆšåˆ·äº†<code>ã€ŠPythonæœºå™¨å­¦ä¹ ç»å…¸æ¡ˆä¾‹ã€‹</code>çš„ç¬¬ä¸€ç« <code>çº¿æ€§å›å½’</code>ï¼Œç›®å‰ä¸¤ä¸ªè¿‡ç¨‹è¿˜æ˜¯å—ç›ŠåŒªæµ…ã€‚æ‰€ä»¥å°±åœ¨è¿™é‡Œè®°å½•æˆ‘çš„å­¦ä¹ ç¬”è®°ã€‚</p>
<p>é¦–å…ˆï¼Œç›‘ç£å­¦ä¹ æ˜¯æŒ‡åœ¨æœ‰æ ‡è®°çš„æ ·æœ¬(<code>labeld samples</code>)ä¸Šå»ºç«‹æœºå™¨å­¦ä¹ çš„æ¨¡å‹ã€‚æœ‰äº†è¿™äº›å¸¦æ ‡è®°çš„æ•°æ®ï¼Œç®—æ³•å°±å¯ä»¥å­¦ä¼šå¦‚ä½•æ ¹æ®è¾“å…¥çš„å‚æ•°è®¡ç®—ã€‚æ— ç›‘ç£è¡€è™šé¢å¯¹çš„æ˜¯æ²¡æœ‰æ ‡è®°çš„æ•°æ®ã€‚å‡è®¾éœ€è¦æŠŠä¸€äº›æ•°æ®åˆ†æˆä¸åŒçš„ç»„åˆ«ï¼Œä½†æ˜¯å¯¹åˆ†ç»„çš„æ¡ä»¶æ¯«ä¸çŸ¥æƒ…ï¼Œäºæ˜¯ï¼Œæ— ç›‘ç£å­¦ä¹ ç®—æ³•å°±ä¼šä»¥æœ€åˆç†çš„æ–¹å¼å°†æ•°æ®é›†åˆ†æˆç¡®å®šæ•°é‡çš„ç»„åˆ«ã€‚</p>
<h4 id="ä¸€æ•°æ®é¢„å¤„ç†æŠ€æœ¯">ä¸€ã€æ•°æ®é¢„å¤„ç†æŠ€æœ¯</h4>
<p>ä¸ºäº†è®©æœºå™¨å­¦ä¹ ç®—æ³•ç†è§£åŸå§‹æ•°æ®ï¼Œéœ€è¦å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ã€‚</p>
<p>1.<u>å‡å€¼ç§»é™¤</u></p>
<p>é€šå¸¸ä¼šæŠŠæ¯ä¸ªç‰¹å¾çš„å¹³å‡å€¼ç§»é™¤ï¼Œä»¥ä¿è¯ç‰¹å¾å‡å€¼ä¸º0ï¼ˆå³æ ‡å‡†åŒ–å¤„ç†ï¼‰ã€‚è¿™æ ·åšå¯ä»¥æ¶ˆé™¤ç‰¹å¾å½¼æ­¤çš„åå·®ï¼ˆbiasï¼‰ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</div><div class="line"></div><div class="line">data = np.array([</div><div class="line">  [<span class="number">3</span>, <span class="number">-1.5</span>, <span class="number">2</span>, <span class="number">-5.4</span>],</div><div class="line">  [<span class="number">0</span>, <span class="number">4</span>, <span class="number">-0.3</span>, <span class="number">2.1</span>],</div><div class="line">  [<span class="number">1</span>, <span class="number">3.3</span>, <span class="number">-1.9</span>, <span class="number">-4.3</span>]</div><div class="line">])</div><div class="line">data_standardized = preprocessing.scale(data)</div><div class="line"><span class="keyword">print</span> <span class="string">"\nMean ="</span>, data_standardized.mean(axis=<span class="number">0</span>)</div><div class="line"><span class="keyword">print</span> <span class="string">"\nStd deviation ="</span>, data_standardized.std(axis=<span class="number">0</span>)</div><div class="line"></div><div class="line">[Result]</div><div class="line">Mean =  [  <span class="number">5.55111512e-17</span>  <span class="number">-1.11022302e-16</span>  <span class="number">-7.40148683e-17</span>  <span class="number">-7.40148683e-17</span>]</div><div class="line">Std deviation = [ <span class="number">1.</span>  <span class="number">1.</span>  <span class="number">1.</span>  <span class="number">1.</span>]</div></pre></td></tr></table></figure>
<p>2.<u>èŒƒå›´ç¼©æ”¾</u>ï¼ˆScalingï¼‰</p>
<p>æ•°æ®ç‚¹ä¸­æ¯ä¸ªç‰¹å¾çš„æ•°å€¼èŒƒå›´å¯èƒ½å˜åŒ–å¾ˆå¤§ï¼Œå› æ­¤ï¼Œæœ‰æ—¶å°†ç‰¹å¾çš„æ•°å€¼èŒƒå›´ç¼©æ”¾åˆ°åˆç†çš„å¤§å°æ˜¯éå¸¸é‡è¦ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">data_scaler = preprocessing.MinMaxScaler(feature_range=(<span class="number">0</span>, <span class="number">1</span>))</div><div class="line">data_scaled= data_scaler.fit_transform(data)</div><div class="line"><span class="keyword">print</span> <span class="string">"\nMin max scaled data ="</span>, data_scaled</div><div class="line"></div><div class="line">[Result]</div><div class="line">Min max scaled data =</div><div class="line">[[ <span class="number">1.</span>          <span class="number">0.</span>          <span class="number">1.</span>          <span class="number">0.</span>        ]</div><div class="line"> [ <span class="number">0.</span>          <span class="number">1.</span>          <span class="number">0.41025641</span>  <span class="number">1.</span>        ]</div><div class="line"> [ <span class="number">0.33333333</span>  <span class="number">0.87272727</span>  <span class="number">0.</span>          <span class="number">0.14666667</span>]]</div></pre></td></tr></table></figure>
<p>3.<u>å½’ä¸€åŒ–</u>ï¼ˆNormalizationï¼‰</p>
<p>æ•°æ®å½’ä¸€åŒ–ç”¨äºå¯¹ç‰¹å¾å‘é‡çš„å€¼è¿›è¡Œè°ƒæ•´ï¼Œä¿è¯æ¯ä¸ªç‰¹å¾å‘é‡çš„å€¼éƒ½ç¼©æ”¾åˆ°ç›¸åŒçš„æ•°å€¼èŒƒå›´ã€‚ç¡®ä¿æ•°æ®ç‚¹æ²¡æœ‰å› ä¸ºç‰¹å¾çš„åŸºæœ¬æ€§è´¨è€Œäº§ç”Ÿè¾ƒå¤§å·®å¼‚ï¼Œç¡®ä¿æ•°æ®å¤„äºåŒä¸€æ•°é‡çº§ï¼Œæé«˜ä¸åŒç‰¹å¾æ•°æ®çš„å¯æ¯”æ€§ã€‚</p>
<p>å¸¸ç”¨çš„å½’ä¸€åŒ–å½¢å¼å°±æ˜¯å°†ç‰¹å¾å‘é‡è°ƒæ•´ä¸ºL1èŒƒæ•°ï¼Œä½¿ç‰¹å¾å‘é‡çš„æ•°å€¼ä¹‹å’Œä¸º1ã€‚L0èŒƒæ•°æ˜¯æŒ‡å‘é‡ä¸­é0çš„å…ƒç´ ä¸ªæ•°ã€‚å¦‚æœç”¨L0èŒƒæ•°æ¥è§„åˆ™åŒ–ä¸€ä¸ªå‚æ•°çŸ©é˜µWï¼Œä¼šå¸Œæœ›Wå¤§éƒ¨åˆ†å…ƒç´ éƒ½æ˜¯0ã€‚L1èŒƒæ•°å’ŒL2èŒƒæ•°éƒ½å¯ä»¥å®ç°çŸ©é˜µç¨€ç–ï¼ŒL1å› å…·æœ‰æ¯”L0æ›´å¥½çš„ä¼˜åŒ–æ±‚è§£ç‰¹å¾è€Œè¢«å¹¿æ³›åº”ç”¨ã€‚è€Œå‚æ•°ç¨€ç–èƒ½å¤Ÿæ›´å¥½çš„è¿›è¡Œç‰¹å¾é€‰æ‹©ä»¥åŠå¢å¼ºè§£é‡Šæ€§ã€‚L2èŒƒæ•°åœ¨å›å½’é‡Œé¢ä¹Ÿå«â€œå²­å›å½’(<code>Ridge Regression</code>)â€ï¼Œä¹Ÿè¢«ç§°ä¸ºæƒå€¼è¡°å‡weight decayã€‚å²­å›å½’èƒ½å¤Ÿæ”¹å–„æ¨¡å‹è¿‡æ‹Ÿåˆé—®é¢˜ã€‚åœ¨L2èŒƒæ•°ä¸­ï¼Œé™åˆ¶äº†å‚æ•°çš„å˜åŒ–æ³¢åŠ¨èŒƒå›´ï¼Œé™ä½äº†æ ‡å‡†å·®ã€‚æ€»çš„è€Œè¨€ï¼ŒL2èŒƒæ•°å¯ä»¥é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œæå‡æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">data_normalized = preprocessing.normalize(data, norm=<span class="string">'l1'</span>)</div><div class="line"><span class="keyword">print</span> <span class="string">"\nL1 normalized data ="</span>, data_normalized</div><div class="line"></div><div class="line">[Result]</div><div class="line">Min max scaled data =</div><div class="line">[[ <span class="number">1.</span>          <span class="number">0.</span>          <span class="number">1.</span>          <span class="number">0.</span>        ]</div><div class="line"> [ <span class="number">0.</span>          <span class="number">1.</span>          <span class="number">0.41025641</span>  <span class="number">1.</span>        ]</div><div class="line"> [ <span class="number">0.33333333</span>  <span class="number">0.87272727</span>  <span class="number">0.</span>          <span class="number">0.14666667</span>]]</div></pre></td></tr></table></figure>
<p>4.<u>äºŒå€¼åŒ–</u>ï¼ˆBinarizationï¼‰</p>
<p>äºŒå€¼åŒ–ç”¨äºå°†æ•°å€¼ç‰¹å¾å‘é‡è½¬æ¢ä¸ºå¸ƒå°”ç±»å‹å‘é‡ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">data_binarized = preprocessing.Binarizer(threshold=<span class="number">1.4</span>).transform(data)</div><div class="line"><span class="keyword">print</span> <span class="string">"\nBinarized data ="</span>, data_binarized</div><div class="line"></div><div class="line">[Result]</div><div class="line">Binarized data =</div><div class="line">[[ <span class="number">1.</span>  <span class="number">0.</span>  <span class="number">1.</span>  <span class="number">0.</span>]</div><div class="line"> [ <span class="number">0.</span>  <span class="number">1.</span>  <span class="number">0.</span>  <span class="number">1.</span>]</div><div class="line"> [ <span class="number">0.</span>  <span class="number">1.</span>  <span class="number">0.</span>  <span class="number">0.</span>]]</div></pre></td></tr></table></figure>
<p>5.<u>ç‹¬çƒ­ç¼–ç </u></p>
<p>ç‹¬çƒ­ç¼–ç å¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§æ”¶ç´§ï¼ˆtightenï¼‰ç‰¹å¾å‘é‡çš„å·¥å…·ã€‚å®ƒæŠŠç‰¹å¾å‘é‡çš„æ¯ä¸ªç‰¹å¾ä¸ç‰¹å¾çš„éé‡å¤æ€»æ•°ç›¸å¯¹åº”ï¼Œé€šè¿‡<em>one of k</em>çš„å½¢å¼å¯¹æ¯ä¸ªå€¼è¿›è¡Œç¼–ç ã€‚ç‰¹å¾å‘é‡çš„æ¯ä¸ªç‰¹å¾å€¼éƒ½æŒ‰ç…§è¿™ç§æ–¹å¼ç¼–ç ï¼Œèƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°è¡¨ç¤ºç©ºé—´ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">encoder = preprocessing.OneHotEncoder()</div><div class="line">encoder.fit([[<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">12</span>], [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">3</span>], [<span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">12</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>]])</div><div class="line">encoder_vector = encoder.transform([[<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">3</span>]]).toarray()</div><div class="line"><span class="keyword">print</span> <span class="string">"\nEncoded vector \n"</span>, encoder_vector</div><div class="line"></div><div class="line">[Result]</div><div class="line">Encoded vector =</div><div class="line">[[ <span class="number">0.</span>  <span class="number">0.</span>  <span class="number">1.</span>  <span class="number">0.</span>  <span class="number">1.</span>  <span class="number">0.</span>  <span class="number">0.</span>  <span class="number">0.</span>  <span class="number">1.</span>  <span class="number">1.</span>  <span class="number">0.</span>]]</div></pre></td></tr></table></figure>
<h4 id="äºŒæ ‡è®°ç¼–ç æ–¹æ³•">äºŒã€æ ‡è®°ç¼–ç æ–¹æ³•</h4>
<p>åœ¨ç›‘ç£å­¦ä¹ ä¸­ï¼Œç»å¸¸éœ€è¦å¤„ç†å„ç§æ ‡è®°ã€‚æ ‡è®°ç¼–ç å°±æ˜¯æŠŠå•è¯æ ‡è®°è½¬æ¢æˆæ•°å€¼å½¢å¼ï¼Œè®©ç®—æ³•æ‡‚å¾—å¦‚ä½•æ“ä½œæ ‡è®°ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">from sklearn import preprocessing</div><div class="line"></div><div class="line">label_encoder = preprocessing.LabelEncoder()</div><div class="line">input_classes = ['audi', 'ford', 'audi', 'toyota', 'ford', 'bmw']</div><div class="line">label_encoder.fit(input_classes)</div><div class="line">print "\n Class mapping:"</div><div class="line">for i, item in enumerate(label_encoder.classes_):</div><div class="line">    print item, '--&gt;', i</div><div class="line"></div><div class="line">[Result]</div><div class="line">Class mapping:</div><div class="line">audi --&gt; 0</div><div class="line">bmw --&gt; 1</div><div class="line">ford --&gt; 2</div><div class="line">toyota --&gt; 3</div></pre></td></tr></table></figure>
<p>åŒæ ·ï¼Œå¦‚æœéœ€è¦ä¸€ç»„æ ‡è®°ï¼Œä¹Ÿèƒ½éå¸¸è½»æ¾åœ°è½¬æ¢å®ƒä»¬ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">labels = [<span class="string">'toyota'</span>, <span class="string">'ford'</span>, <span class="string">'audi'</span>]</div><div class="line">encoded_labels = label_encoder.transform(labels)</div><div class="line"><span class="keyword">print</span> <span class="string">"\nLabels ="</span>, labels</div><div class="line"><span class="keyword">print</span> <span class="string">"Encoded labels ="</span>, list(encoded_labels)</div><div class="line"></div><div class="line">[Result]</div><div class="line">Labels = [<span class="string">'toyota'</span>, <span class="string">'ford'</span>, <span class="string">'audi'</span>]</div><div class="line">Encoded labels = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">0</span>]</div><div class="line"></div><div class="line">encoded_labels = [<span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]</div><div class="line">decoded_labels = label_encoder.inverse_transform(encoded_labels)</div><div class="line"><span class="keyword">print</span> <span class="string">"\nEncoded labels ="</span>, encoded_labels</div><div class="line"><span class="keyword">print</span> <span class="string">"Decoded labels ="</span>, list(decoded_labels)</div><div class="line"></div><div class="line">[Result]</div><div class="line">Encoded labels = [<span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]</div><div class="line">Decoded labels = [<span class="string">'ford'</span>, <span class="string">'bmw'</span>, <span class="string">'audi'</span>, <span class="string">'bmw'</span>]</div></pre></td></tr></table></figure>
<h4 id="ä¸‰åˆ›å»ºçº¿æ€§å›å½’å™¨">ä¸‰ã€åˆ›å»ºçº¿æ€§å›å½’å™¨</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"></div><div class="line">filename = sys.argv[<span class="number">1</span>]</div><div class="line">X = []</div><div class="line">y = []</div><div class="line"><span class="keyword">with</span> open(filename, <span class="string">'r'</span>) <span class="keyword">as</span> f:</div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</div><div class="line">        xt, yt = [float(i) <span class="keyword">for</span> i <span class="keyword">in</span> line.split(<span class="string">','</span>)]</div><div class="line">        X.append(xt)</div><div class="line">        y.append(yt)</div><div class="line">    </div><div class="line">num_training = int(<span class="number">0.8</span> * len(X))</div><div class="line">num_test = len(X) - num_training</div><div class="line"></div><div class="line">X_train = np.array(X[:num_training]).reshape((num_training, <span class="number">1</span>))</div><div class="line">y_train = np.array(y[:num_training])</div><div class="line"></div><div class="line">X_test = np.array(X[num_training:]).reshape((num_test, <span class="number">1</span>))</div><div class="line">y_test = np.array(y[num_training:])</div><div class="line"></div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> linear_model</div><div class="line"></div><div class="line">linear_regressor = linear_model.LinearRegression()</div><div class="line"></div><div class="line">y_test_pred = linear_regressor.predict(X_test)</div><div class="line"></div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"></div><div class="line">plt.scatter(X_test, y_test, color=<span class="string">'green'</span>)</div><div class="line">plt.plot(X_test, y_test_pred, color=<span class="string">'black'</span>, linewidth=<span class="number">4</span>)</div><div class="line">plt.xticks(())</div><div class="line">plt.yticks(())</div><div class="line">plt.show()</div></pre></td></tr></table></figure>
<figure>
<img src="/images/linear.png" alt="linear"><figcaption>linear</figcaption>
</figure>
<h4 id="å››è®¡ç®—å›å½’å‡†ç¡®æ€§">å››ã€è®¡ç®—å›å½’å‡†ç¡®æ€§</h4>
<p>ç°åœ¨å»ºç«‹äº†å›å½’å™¨ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¯„ä»·å›å½’å™¨çš„æ‹Ÿåˆæ•ˆæœã€‚</p>
<ul>
<li><p>å¹³å‡ç»å¯¹è¯¯å·®ï¼ˆMean Absolute Errorï¼‰ï¼šç»™å®šæ•°æ®é›†çš„æ‰€æœ‰æ•°æ®ç‚¹çš„ç»å¯¹è¯¯å·®å¹³å‡å€¼ã€‚</p></li>
<li><p>å‡æ–¹è¯¯å·®ï¼ˆMean Squared Errorï¼‰ï¼šç»™å®šæ•°æ®é›†çš„æ‰€æœ‰æ•°æ®ç‚¹çš„è¯¯å·®çš„å¹³æ–¹çš„å¹³å‡å€¼ã€‚</p></li>
<li><p>ä¸­ä½æ•°ç»å¯¹è¯¯å·®ï¼ˆMedian Absolute Errorï¼‰ï¼šç»™å®šæ‰€æœ‰æ•°æ®é›†çš„æ‰€æœ‰æ•°æ®ç‚¹çš„è¯¯å·®çš„ä¸­ä½æ•°ã€‚è¿™ä¸ªæŒ‡æ ‡çš„ä¸»è¦ä¼˜ç‚¹æ˜¯å¯ä»¥æ¶ˆé™¤å¼‚å¸¸å€¼çš„å¹²æ‰°ã€‚</p></li>
<li><p>è§£é‡Šæ–¹å·®åˆ†ï¼ˆExplained Variance Scoreï¼‰ï¼šç”¨äºè¡¡é‡æ¨¡å‹å¯¹æ•°æ®é›†æ³¢åŠ¨çš„è§£é‡Šèƒ½åŠ›ï¼Œå¦‚æœå¾—åˆ†1.0åˆ†ï¼Œè¡¨æ˜æ¨¡å‹æ˜¯å®Œç¾çš„ã€‚</p></li>
<li><p>Ræ–¹å¾—åˆ†ï¼ˆR2 Scoreï¼‰ï¼šæŒ‡ç¡®å®šæ€§ç›¸å…³ç³»æ•°ï¼Œç”¨äºè¡¡é‡æ¨¡å‹å¯¹æœªçŸ¥æ ·æœ¬é¢„æµ‹çš„æ•ˆæœã€‚æœ€å¥½çš„å¾—åˆ†æ˜¯1.0ã€‚</p>
<p>ä¸€èˆ¬éƒ½æ˜¯ä¿è¯å‡æ–¹è¯¯å·®æœ€ä½ï¼Œè§£é‡Šæ–¹å·®åˆ†æœ€é«˜ã€‚</p>
<figure>
<img src="/images/r2.png" alt="r2"><figcaption>r2</figcaption>
</figure>
<figure>
<img src="/images/explained_variance.png" alt="explained_variance"><figcaption>explained_variance</figcaption>
</figure></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sklearn.metrics <span class="keyword">as</span> sm</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"Mean absolute error ="</span>, round(sm.mean_absolute_error(y_test, y_test_pred), <span class="number">2</span>)</div><div class="line"><span class="keyword">print</span> <span class="string">"Mean squared error ="</span>, round(sm.mean_squared_error(y_test, y_test_pred), <span class="number">2</span>)</div><div class="line"><span class="keyword">print</span> <span class="string">"Median absolute error ="</span>, round(sm.median_absolute_error(y_test, y_test_pred), <span class="number">2</span>)</div><div class="line"><span class="keyword">print</span> <span class="string">"Explained variance score ="</span>, round(sm.explained_variance_score(y_test, y_test_pred), <span class="number">2</span>)</div><div class="line"><span class="keyword">print</span> <span class="string">"R2 score ="</span>, round(sm.r2_score(y_test, y_test_pred), <span class="number">2</span>)</div></pre></td></tr></table></figure>
<h4 id="äº”åˆ›å»ºå²­å›å½’å™¨">äº”ã€åˆ›å»ºå²­å›å½’å™¨</h4>
<p>çº¿æ€§å›å½’çš„ä¸»è¦é—®é¢˜æ˜¯å¯¹å¼‚å¸¸å€¼æ•æ„Ÿï¼Œç”±äºå¼‚å¸¸å€¼è¯¯å·®çš„ç»å¯¹å€¼å¾ˆå¤§ï¼Œå› æ­¤ä¼šå¼•èµ·é—®é¢˜ï¼Œä»è€Œç ´åæ•´ä¸ªæ¨¡å‹ã€‚ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œåˆ©ç”¨å²­å›å½’å¼•å…¥æ­£åˆ™åŒ–é¡¹çš„ç³»æ•°ä½œä¸ºé˜ˆå€¼æ¥æ¶ˆé™¤å¼‚å¸¸å€¼çš„å½±å“ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"></div><div class="line">filename = sys.argv[<span class="number">1</span>]</div><div class="line">X = []</div><div class="line">y = []</div><div class="line"><span class="keyword">with</span> open(filename, <span class="string">'r'</span>) <span class="keyword">as</span> f:</div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</div><div class="line">        data = [float(i) <span class="keyword">for</span> i <span class="keyword">in</span> line.split(<span class="string">','</span>)]</div><div class="line">        xt, yt = data[:<span class="number">-1</span>], data[<span class="number">-1</span>]</div><div class="line">        X.append(xt)</div><div class="line">        y.append(yt)</div><div class="line">        </div><div class="line">num_training = int(<span class="number">0.8</span> * len(X))</div><div class="line">num_test = len(X) - num_training</div><div class="line"></div><div class="line">X_train = np.array(X[:num_training])</div><div class="line">y_train = np.array(y[:num_training])</div><div class="line"></div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> linear_model</div><div class="line"></div><div class="line">linear_regressor = linear_model.LinearRegression()</div><div class="line"><span class="comment"># alphaå‚æ•°æ§åˆ¶å›å½’å™¨çš„å¤æ‚ç¨‹åº¦ï¼Œå½“alphaè¶‹äº0æ—¶ï¼Œå²­å›å½’å°±æ˜¯ç”¨æ™®é€šæœ€å°äºŒä¹˜æ³•çš„çº¿å½¢å›å½’å™¨</span></div><div class="line"><span class="comment"># å¦‚æœå¸Œæœ›æ¨¡å‹å¯¹å¼‚å¸¸å€¼ä¸é‚£ä¹ˆæ•æ„Ÿï¼Œå°±éœ€è¦è®¾ç½®ä¸€ä¸ªè¾ƒå¤§çš„alphaå€¼</span></div><div class="line">ridge_regressor = linear_model.Ridge(alpha=<span class="number">0.01</span>, fit_intercept=<span class="keyword">True</span>, max_iter=<span class="number">10000</span>)</div><div class="line"></div><div class="line">linear_regressor.fit(X_train, y_train)</div><div class="line">ridge_regressor.fit(X_train, y_train)</div><div class="line"></div><div class="line">y_test_pred = linear_regressor.predict(X_test)</div><div class="line">y_test_pred_ridge = ridge_regressor.predict(X_test)</div><div class="line"></div><div class="line"><span class="keyword">import</span> sklearn.metrics <span class="keyword">as</span> sm</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"LINEAR:"</span></div><div class="line"><span class="keyword">print</span> <span class="string">"Mean absolute error ="</span>, round(sm.mean_absolute_error(y_test, y_test_pred), <span class="number">2</span>) </div><div class="line"><span class="keyword">print</span> <span class="string">"Mean squared error ="</span>, round(sm.mean_squared_error(y_test, y_test_pred), <span class="number">2</span>) </div><div class="line"><span class="keyword">print</span> <span class="string">"Median absolute error ="</span>, round(sm.median_absolute_error(y_test, y_test_pred), <span class="number">2</span>) </div><div class="line"><span class="keyword">print</span> <span class="string">"Explained variance score ="</span>, round(sm.explained_variance_score(y_test, y_test_pred), <span class="number">2</span>) </div><div class="line"><span class="keyword">print</span> <span class="string">"R2 score ="</span>, round(sm.r2_score(y_test, y_test_pred), <span class="number">2</span>)</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"\nRIDGE:"</span></div><div class="line"><span class="keyword">print</span> <span class="string">"Mean absolute error ="</span>, round(sm.mean_absolute_error(y_test, y_test_pred_ridge), <span class="number">2</span>) </div><div class="line"><span class="keyword">print</span> <span class="string">"Mean squared error ="</span>, round(sm.mean_squared_error(y_test, y_test_pred_ridge), <span class="number">2</span>) </div><div class="line"><span class="keyword">print</span> <span class="string">"Median absolute error ="</span>, round(sm.median_absolute_error(y_test, y_test_pred_ridge), <span class="number">2</span>) </div><div class="line"><span class="keyword">print</span> <span class="string">"Explained variance score ="</span>, round(sm.explained_variance_score(y_test, y_test_pred_ridge), <span class="number">2</span>) </div><div class="line"><span class="keyword">print</span> <span class="string">"R2 score ="</span>, round(sm.r2_score(y_test, y_test_pred_ridge), <span class="number">2</span>)</div><div class="line"></div><div class="line">[Result]</div><div class="line">LINEAR:</div><div class="line">Mean absolute error = <span class="number">3.95</span></div><div class="line">Mean squared error = <span class="number">23.15</span></div><div class="line">Median absolute error = <span class="number">3.69</span></div><div class="line">Explained variance score = <span class="number">0.84</span></div><div class="line">R2 score = <span class="number">0.83</span></div><div class="line"></div><div class="line">RIDGE:</div><div class="line">Mean absolute error = <span class="number">3.95</span></div><div class="line">Mean squared error = <span class="number">23.15</span></div><div class="line">Median absolute error = <span class="number">3.69</span></div><div class="line">Explained variance score = <span class="number">0.84</span></div><div class="line">R2 score = <span class="number">0.83</span></div></pre></td></tr></table></figure>
<h4 id="å…­åˆ›å»ºå¤šé¡¹å¼å›å½’å™¨">å…­ã€åˆ›å»ºå¤šé¡¹å¼å›å½’å™¨</h4>
<p>çº¿æ€§å›å½’æ¨¡å‹æœ‰ä¸€ä¸ªä¸»è¦çš„å±€é™æ€§ï¼Œå°±æ˜¯åªèƒ½æŠŠè¾“å…¥æ•°æ®æ‹Ÿåˆæˆç›´çº¿ï¼Œè€Œå¤šé¡¹å¼å›å½’æ¨¡å‹é€šè¿‡æ‹Ÿåˆå¤šé¡¹å¼æ–¹ç¨‹å¼æ¥å…‹æœè¿™ç±»é—®é¢˜ï¼Œä»è€Œæé«˜æ¨¡å‹çš„å‡†ç¡®æ€§ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> PolynomialFeatures</div><div class="line"></div><div class="line"><span class="comment"># æŠŠå¤šé¡¹å¼çš„æ¬¡æ•°è®¾ç½®ä¸º10</span></div><div class="line">polynomial = PolynomialFeatures(degree=<span class="number">10</span>)</div><div class="line">X_train_transformed = polynomial.fit_transform(X_train)</div><div class="line">datapoint = [<span class="number">0.39</span>, <span class="number">2.78</span>, <span class="number">7.11</span>]</div><div class="line">poly_datapoint = polynomial.fit_transform(datapoint)</div><div class="line"></div><div class="line">poly_linear_model = linear_model.LinearRegression()</div><div class="line">poly_linear_model.fit(X_train_transformed, y_train)</div><div class="line"><span class="keyword">print</span> <span class="string">"\nLinear regression:\n"</span>, linear_regressor.predict(datapoint)[<span class="number">0</span>]</div><div class="line"><span class="keyword">print</span> <span class="string">"\nPolynomial regression:\n"</span>, poly_linear_model.predict(poly_datapoint)[<span class="number">0</span>]</div><div class="line"></div><div class="line">sgd_regressor = linear_model.SGDRegressor(loss=<span class="string">'huber'</span>, n_iter=<span class="number">50</span>)</div><div class="line">sgd_regressor.fit(X_train, y_train)</div><div class="line"><span class="keyword">print</span> <span class="string">"\nSGD regressor:\n"</span>, sgd_regressor.predict(datapoint)</div><div class="line"></div><div class="line">[Result]</div><div class="line">Linear regression:</div><div class="line">[<span class="number">-11.0587295</span>]</div><div class="line"></div><div class="line">Polynomial regression:</div><div class="line">[<span class="number">-8.149308</span>]</div><div class="line"></div><div class="line">SGD regressor:</div><div class="line">[<span class="number">-7.9607662</span>]</div></pre></td></tr></table></figure>
<h4 id="ä¸ƒä¼°ç®—æˆ¿å±‹ä»·æ ¼">ä¸ƒã€ä¼°ç®—æˆ¿å±‹ä»·æ ¼</h4>
<p>ä¸‹é¢å°†ä½¿ç”¨<code>AdaBoost</code>ç®—æ³•çš„å†³ç­–æ ‘å›å½’å™¨(<code>decision tree regressor</code>)æ¥è§£å†³æˆ¿å±‹ä¼°ä»·è¿™ä¸€é—®é¢˜ã€‚</p>
<p>å†³ç­–æ ‘æ˜¯ä¸€ä¸ªæ ‘çŠ¶æ¨¡å‹ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½åšå‡ºä¸€ä¸ªå†³ç­–ï¼Œä»è€Œå½±å“ç»“æœã€‚å¶å­èŠ‚ç‚¹è¡¨ç¤ºè¾“å‡ºæ•°å€¼ï¼Œåˆ†æ”¯è¡¨ç¤ºæ ¹æ®è¾“å…¥ç‰¹å¾åšå‡ºçš„ä¸­é—´å†³ç­–ã€‚<code>Adaboost</code>ç®—æ³•æ˜¯æŒ‡è‡ªé€‚åº”å¢å¼º(<code>Adaptive boosting</code>)ç®—æ³•ï¼Œè¿™æ˜¯ä¸€ç§åˆ©ç”¨å…¶ä»–ç³»ç»Ÿå¢å¼ºæ¨¡å‹å‡†ç¡®æ€§çš„æŠ€æœ¯ã€‚è¿™ç§æŠ€æœ¯å°†ä¸åŒç‰ˆæœ¬çš„ç®—æ³•ç»“æœè¿›è¡Œç»„åˆï¼Œç”¨åŠ æƒæ±‡æ€»çš„æ–¹å¼è·å¾—æœ€ç»ˆç»“æœï¼Œè¢«ç§°ä¸ºå¼±å­¦ä¹ (<code>weak learners</code>)ã€‚<code>Adaboost</code>ç®—æ³•åœ¨æ¯ä¸ªé˜¶æ®µè·å–çš„ä¿¡æ¯éƒ½ä¼šåé¦ˆåˆ°æ¨¡å‹ä¸­ï¼Œè¿™æ ·å­¦ä¹ å™¨å°±å¯ä»¥åœ¨åä¸€é˜¶æ®µé‡ç‚¹è®­ç»ƒéš¾ä»¥åˆ†ç±»çš„æ ·æœ¬ã€‚è¿™ç§å­¦ä¹ æ–¹å¼å¯ä»¥å¢å¼ºç³»ç»Ÿçš„å‡†ç¡®æ€§ã€‚</p>
<p>é¦–å…ˆä½¿ç”¨<code>Adaboost</code>ç®—æ³•å¯¹æ•°æ®é›†åˆè¿›è¡Œå›å½’æ‹Ÿåˆï¼Œå†è®¡ç®—è¯¯å·®ï¼Œç„¶åæ ¹æ®è¯¯å·®è¯„ä¼°ç»“æœï¼Œç”¨åŒæ ·çš„æ•°æ®é›†é‡æ–°æ‹Ÿåˆã€‚å¯ä»¥æŠŠè¿™äº›çœ‹ä½œæ˜¯å›å½’å™¨çš„è°ƒä¼˜è¿‡ç¨‹ï¼Œç›´åˆ°è¾¾åˆ°é¢„æœŸçš„å‡†ç¡®æ€§ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor, AdaBoostRegressor</div><div class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeRegressor</div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</div><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error, explained_variance_score</div><div class="line"><span class="keyword">from</span> sklearn.utils <span class="keyword">import</span> shuffle</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_feature_importance</span><span class="params">(feature_importances, title, feature_names)</span>:</span></div><div class="line">    <span class="comment"># Normalize the importance values</span></div><div class="line">    feature_importances = <span class="number">100.0</span> * (feature_importances / max(feature_importances))</div><div class="line">    </div><div class="line">    <span class="comment"># å°†å¾—åˆ†ä»é«˜åˆ°ä½æ’åº</span></div><div class="line">    index_sorted = np.flipud(np.argsort(feature_importances))</div><div class="line">    </div><div class="line">    <span class="comment"># Arrange the X ticks</span></div><div class="line">    pos = np.arange(index_sorted.shape[<span class="number">0</span>]) + <span class="number">0.5</span></div><div class="line">    </div><div class="line">    <span class="comment"># Plot the bar graph</span></div><div class="line">    plt.figure()</div><div class="line">    plt.bar(pos, feature_importances[index_sorted], align=<span class="string">'center'</span>)</div><div class="line">    plt.xticks(pos, feature_names[index_sorted])</div><div class="line">    plt.ylabel(<span class="string">'Relative Importances'</span>)</div><div class="line">    plt.title(title)</div><div class="line">    plt.show()</div><div class="line">    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    </div><div class="line">    <span class="comment"># Load housing data</span></div><div class="line">    housing_data = datasets.load_boston()</div><div class="line">    </div><div class="line">    <span class="comment"># Shuffle the data</span></div><div class="line">    X, y = shuffle(housing_data, data, housing_data.target, random_state=<span class="number">7</span>)</div><div class="line">    </div><div class="line">    num_training = int(<span class="number">0.8</span> * len(X))</div><div class="line">    X_train, y_train = X[:num_training], y[:num_training]</div><div class="line">    X_test, y_test = X[num_training:], y[num_training:]</div><div class="line">    </div><div class="line">    <span class="comment"># Fit decision tree regression model</span></div><div class="line">    dt_regressor = DecisionTreeRegressor(max_depth=<span class="number">4</span>)</div><div class="line">    dt_regressor.fit(X_train, y_train)</div><div class="line">    </div><div class="line">    <span class="comment"># Fit decision tree regression model with AdaBoost</span></div><div class="line">    ab_regressor = AdaBoostRegressor(DecisionTreeRegressor(max_depth=<span class="number">4</span>), n_estimators=<span class="number">400</span>, random_state=<span class="number">7</span>)</div><div class="line">    </div><div class="line">    <span class="comment"># Evaluate performance of Decision Tree regressor</span></div><div class="line">    y_pred_dt = dt_regressor.predict(X_test)</div><div class="line">    mse = mean_squared_error(y_test, y_pred_dt)</div><div class="line">    env = explained_variance_score(y_test, y_pred_dt)</div><div class="line">    <span class="keyword">print</span> <span class="string">"####\n Decision Tree performance ####"</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"Mean squared error ="</span>, round(mse, <span class="number">2</span>)</div><div class="line">    <span class="keyword">print</span> <span class="string">"Explained variance score ="</span>, round(evs, <span class="number">2</span>)</div><div class="line">    </div><div class="line">    <span class="comment"># Evaluate performance of AdaBoost</span></div><div class="line">    y_pred_dt_ab = dt_regressor.predict(X_test)</div><div class="line">    mse = mean_squared_error(y_test, y_pred_dt_ab)</div><div class="line">    env = explained_variance_score(y_test, y_pred_dt_ab)</div><div class="line">    <span class="keyword">print</span> <span class="string">"####\n Decision Tree performance ####"</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"Mean squared error ="</span>, round(mse, <span class="number">2</span>)</div><div class="line">    <span class="keyword">print</span> <span class="string">"Explained variance score ="</span>, round(evs, <span class="number">2</span>)</div><div class="line">    </div><div class="line">    <span class="comment"># Plot relative feature importances</span></div><div class="line">    plot_feature_importances(dt_regressor.feature_importances_,</div><div class="line">                            <span class="string">'Decision Tree regressor'</span>, housing_data.feature_names)</div><div class="line">    plot_feature_importances(ab_regressor.feature_importances_,</div><div class="line">                            <span class="string">'AdaBoost regressor'</span>, housing_data.feature_names)</div><div class="line">    </div><div class="line">[Result]</div><div class="line"><span class="comment">#### Decision Tree performance ####</span></div><div class="line">Mean squared error = <span class="number">14.79</span></div><div class="line">Explained variance score = <span class="number">0.82</span></div><div class="line"></div><div class="line"><span class="comment">#### AdaBoost performance ####</span></div><div class="line">Mean squared error = <span class="number">7.64</span></div><div class="line">Explained variance score = <span class="number">0.91</span></div></pre></td></tr></table></figure>
<figure>
<img src="/images/Decision_tree.png" alt="AdaBoost"><figcaption>AdaBoost</figcaption>
</figure>
<figure>
<img src="/images/Decision_tree.png" alt="Decision_tree"><figcaption>Decision_tree</figcaption>
</figure>
<h4 id="å…«è¯„ä¼°å…±äº«å•è½¦çš„éœ€æ±‚åˆ†å¸ƒ">å…«ã€è¯„ä¼°å…±äº«å•è½¦çš„éœ€æ±‚åˆ†å¸ƒ</h4>
<p>ä¸‹é¢ç”¨éšæœºæ£®æ—å›å½’å™¨(<code>random forest regressor</code>)æ¥è§£å†³å…±äº«å•è½¦çš„éœ€æ±‚åˆ†å¸ƒé—®é¢˜ã€‚éšæœºæ£®æ—æ˜¯ä¸€ä¸ªå†³ç­–æ ‘é›†åˆï¼Œå®ƒåŸºæœ¬ä¸Šå°±æ˜¯ç”¨ä¸€ç»„ç”±æ•°æ®é›†çš„è‹¥å¹²å­é›†æ„å»ºçš„å†³ç­–æ ‘æ„æˆï¼Œå†ç”¨å†³ç­–æ ‘å¹³å‡å€¼æ”¹å–„æ•´ä½“å­¦ä¹ æ•ˆæœã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor</div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</div><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error, explained_variance_score</div><div class="line"><span class="keyword">from</span> sklearn.utils <span class="keyword">import</span> shuffle</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"></div><div class="line"><span class="keyword">from</span> housing <span class="keyword">import</span> plot_feature_importances</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_dataset</span><span class="params">(filename)</span>:</span></div><div class="line">    file_reader = csv.reader(open(filename, <span class="string">'rb'</span>), delimiter=<span class="string">','</span>)</div><div class="line">    X, y = [], []</div><div class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> file_reader:</div><div class="line">        X.append(row[<span class="number">2</span>:<span class="number">13</span>])</div><div class="line">        y.append(row[<span class="number">-1</span>])</div><div class="line">    </div><div class="line">    <span class="comment"># Extract feature names</span></div><div class="line">    features_names = np.array(X[<span class="number">0</span>])</div><div class="line">    </div><div class="line">    <span class="comment"># Remove the first row because they are feature names</span></div><div class="line">    <span class="keyword">return</span> np.array(X[<span class="number">1</span>:]).astype(np.float32), np.array(y[<span class="number">1</span>:]).astype(np.float32), feature_names</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    </div><div class="line">    <span class="comment"># Load the dataset from the input file</span></div><div class="line">    X, y, feature_names = load_datasets(sys.argv[<span class="number">1</span>])</div><div class="line">    X, y = shuffle(X, y, random_state=<span class="number">7</span>)</div><div class="line">    </div><div class="line">    <span class="comment"># Split the data</span></div><div class="line">    num_training = int(<span class="number">0.9</span> * len(X))</div><div class="line">    X_train, y_train = X[:num_training], y[:num_training]</div><div class="line">    X_test, y_test = X[num_training:], y[num_training:]</div><div class="line">    </div><div class="line">    <span class="comment"># Fit Random Forest regression model</span></div><div class="line">    <span class="comment"># n_estimatoræ˜¯è¯„ä¼°å™¨çš„æ•°é‡ï¼Œè¡¨ç¤ºéšæœºæ£®æ—éœ€è¦ä½¿ç”¨çš„å†³ç­–æ ‘æ•°é‡</span></div><div class="line">    <span class="comment"># max_depthæ˜¯æŒ‡æ¯ä¸ªå†³ç­–æ ‘çš„æœ€å¤§æ·±åº¦</span></div><div class="line">    <span class="comment"># min_samples_splitæ˜¯æŒ‡å†³ç­–æ ‘åˆ†è£‚ä¸€ä¸ªèŠ‚ç‚¹éœ€è¦ç”¨åˆ°çš„æœ€å°æ•°æ®æ ·æœ¬é‡</span></div><div class="line">    rf_regressor = RandomForestRegressor(n_estimator=<span class="number">1000</span>, max_depth=<span class="number">10</span>, min_samples_split=<span class="number">2</span>)</div><div class="line">    rf_regressor.fit(X_train, y_train)</div><div class="line">    </div><div class="line">    y_pred = rf_regressor.predict(X_test)</div><div class="line">    mse = mean_squared_error(y_test, y_pred)</div><div class="line">    evs = explained_variance_score(y_test, y_pred)</div><div class="line">    <span class="keyword">print</span> <span class="string">"\n #### Random Forest regressor performance ####"</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"Mean squared error ="</span>, round(mse, <span class="number">2</span>)</div><div class="line">    <span class="keyword">print</span> <span class="string">"Explained variance score = "</span>, round(mse, <span class="number">2</span>)</div><div class="line"></div><div class="line">[Result]</div><div class="line"><span class="comment">#### Random Forest regressor performance ####</span></div><div class="line">Mean squared error = <span class="number">362009.79</span></div><div class="line">Explained variance score = <span class="number">0.89</span></div></pre></td></tr></table></figure>
<figure>
<img src="/images/By%20day.png" alt="By day"><figcaption>By day</figcaption>
</figure>
<figure>
<img src="/images/By%20hour.png" alt="By hour"><figcaption>By hour</figcaption>
</figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/30/ã€ŠPythonè®¾è®¡æ¨¡å¼ã€‹è¯»ä¹¦ç¬”è®°ä¸‰/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å½¼å¾—çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/30/ã€ŠPythonè®¾è®¡æ¨¡å¼ã€‹è¯»ä¹¦ç¬”è®°ä¸‰/" itemprop="url">
                  ã€ŠPythonè®¾è®¡æ¨¡å¼ã€‹è¯»ä¹¦ç¬”è®°ä¸‰
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-07-30T19:33:21+08:00">
                2017-07-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python-Notes/" itemprop="url" rel="index">
                    <span itemprop="name">Python_Notes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>è¿™å‘¨çš„å­¦ä¹ è®¡åˆ’æ˜¯é˜…è¯»<code>å‘½ä»¤æ¨¡å¼</code>ã€<code>è§£é‡Šå™¨æ¨¡å¼</code>ã€<code>è§‚å¯Ÿè€…æ¨¡å¼</code>å’Œ<code>æ¨¡ç‰ˆæ¨¡å¼</code>ã€‚</p>
<p><u>å‘½ä»¤æ¨¡å¼</u></p>
<p>å‘½ä»¤è®¾è®¡æ¨¡å¼å¸®åŠ©æˆ‘ä»¬å°†ä¸€ä¸ªæ“ä½œï¼ˆæ’¤é”€ã€é‡åšã€å¤åˆ¶ã€ç²˜è´´ç­‰ï¼‰å°è£…ä¸€ä¸ªå¯¹è±¡ã€‚è¿™æ„å‘³ç€åˆ›å»ºä¸€ä¸ªç±»ï¼ŒåŒ…å«å®è¯¥æ“ä½œæ‰€éœ€è¦çš„æ‰€æœ‰é€»è¾‘å’Œæ–¹æ³•ã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­æ˜¯ä½¿ç”¨å‘½ä»¤æ¨¡å¼å®ç°æœ€åŸºæœ¬çš„æ–‡ä»¶æ“ä½œå·¥å…·ã€‚</p>
<ul>
<li>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶éšæ„å†™å…¥ä¸€ä¸ªå­—ç¬¦ä¸²</li>
<li>è¯»å–ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹</li>
<li>é‡å‘½åä¸€ä¸ªæ–‡ä»¶</li>
<li>åˆ é™¤ä¸€ä¸ªæ–‡ä»¶</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> os </div><div class="line"></div><div class="line">verbose = <span class="keyword">True</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">RenameFile</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, path_src, path_dest)</span>:</span></div><div class="line">        self.src, self.dest = path_src, path_dest</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">execute</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">if</span> verbose:</div><div class="line">            print(<span class="string">"[renaming '&#123;&#125;' to '&#123;&#125;'"</span>.format(self.src, self.dest))</div><div class="line">        os.rename(self.src, self.dest)</div><div class="line">    </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CreateFile</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, path, txt=<span class="string">'hello world\n'</span>)</span>:</span></div><div class="line">        self.path, self.txt = path, txt</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">execute</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">if</span> verbose:</div><div class="line">            print(<span class="string">"[creating file '&#123;&#125;']"</span>.format(self.path))</div><div class="line">        <span class="keyword">with</span> open(self.path, mode=<span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> out_file:</div><div class="line">            out_file.write(self.txt)</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">undo</span><span class="params">(self)</span>:</span></div><div class="line">        delete_file(self.path)</div><div class="line">    </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReadFile</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, path)</span>:</span></div><div class="line">        self.path = path</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">execute</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">if</span> verbose:</div><div class="line">            print(<span class="string">"[reading file '&#123;&#125;']"</span>.format(self.path))</div><div class="line">        <span class="keyword">with</span> open(self.path, mode=<span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> in_file:</div><div class="line">            print(in_file.read(), end=<span class="string">''</span>)</div><div class="line">            </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete_file</span><span class="params">(path)</span>:</span></div><div class="line">    <span class="keyword">if</span> verbose:</div><div class="line">        print(<span class="string">"deleting file '&#123;&#125;'"</span>.format(path))</div><div class="line">    os.remove(path)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    orig_name, new_name = <span class="string">'file1'</span>, <span class="string">'file2'</span></div><div class="line">    </div><div class="line">    commands = []</div><div class="line">    <span class="keyword">for</span> cmd <span class="keyword">in</span> CreateFIle(orig_name), ReadFile(orig_name), RenameFile(orig_name, new_name):</div><div class="line">        commands.append(cmd)</div><div class="line">    [c.execute() <span class="keyword">for</span> c <span class="keyword">in</span> commands]</div><div class="line">    </div><div class="line">    answer = input(<span class="string">'reverse the executed commands? []y/n'</span>)</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> answer <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">'yY'</span>:</div><div class="line">        print(<span class="string">"the result is &#123;&#125;"</span>.format(new_name))</div><div class="line">        exit()</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> reversed(commands):</div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            c.undo()</div><div class="line">        <span class="keyword">except</span> AttributeError <span class="keyword">as</span> e:</div><div class="line">            <span class="keyword">pass</span></div><div class="line"> </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure>
<p><u>è§£é‡Šå™¨æ¨¡å¼</u></p>
<p>åœ¨è§£é‡Šå™¨æ¨¡å¼ä¸­ï¼Œæœ‰ä¸€ä¸ªååˆ†é‡è¦çš„åè¯ï¼Œå°±æ˜¯<code>DSL(Domain Specific Language)</code>ï¼Œé¢†åŸŸç‰¹å®šè¯­è¨€ã€‚<code>DSL</code>æ˜¯ä¸€ç§é’ˆå¯¹ä¸€ä¸ªç‰¹å®šé¢†åŸŸçš„æœ‰é™è¡¨è¾¾èƒ½åŠ›ã€‚</p>
<p>è€Œ<code>DSL</code>åˆ†ä¸ºå†…éƒ¨<code>DSL</code>å’Œå¤–éƒ¨<code>DSL</code>ã€‚å†…éƒ¨<code>DSL</code>æ„å»ºåœ¨ä¸€ç§å®¿ä¸»ç¼–ç¨‹è¯­è¨€ä¸­ã€‚å†…éƒ¨<code>DSL</code>çš„ä¸€ä¸ªä¾‹å­æ˜¯ï¼Œä½¿ç”¨<code>Python</code>è§£å†³çº¿æ€§æ–¹ç¨‹ç»„çš„ä¸€ç§è¯­è¨€ã€‚ä½¿ç”¨å†…éƒ¨<code>DSL</code>çš„ä¼˜åŠ¿æ˜¯æˆ‘ä»¬ä¸å¿…æ‹…å¿ƒåˆ›å»ºã€ç¼–è¯‘åŠè§£æè¯­æ³•ï¼Œå› ä¸ºè¿™äº›å·²ç»è¢«å®¿ä¸»è¯­è¨€è§£å†³æ‰äº†ã€‚åŠ£åŠ¿æ˜¯ä¼šå—é™äºå®¿ä¸»è¯­è¨€çš„ç‰¹æ€§ã€‚å¦‚æœå®¿ä¸»è¯­è¨€ä¸å…·å¤‡è¿™äº›ç‰¹æ€§ï¼Œæ„å»ºä¸€ç§è¡¨è¾¾èƒ½åŠ›å¼ºã€ç®€æ´è€Œä¸”ä¼˜ç¾çš„å†…éƒ¨<code>DSL</code>æ˜¯å¯Œæœ‰æŒ‘æˆ˜æ€§çš„ã€‚</p>
<p>å¤–éƒ¨<code>DSL</code>ä¸ä¾èµ–æŸç§å®¿ä¸»è¯­è¨€ã€‚<code>DSL</code>çš„åˆ›å»ºè€…å¯ä»¥å†³å®šè¯­è¨€çš„æ–¹æ–¹é¢é¢ï¼ˆè¯­æ³•ã€å¥æ³•ç­‰ï¼‰ï¼Œä½†ä¹Ÿè¦è´Ÿè´£ä¸ºå…¶åˆ›å»ºä¸€ä¸ªè§£æå™¨å’Œç¼–è¯‘å™¨ã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­æ˜¯åˆ›å»ºä¸€ç§å†…éƒ¨<code>DSL</code>æ§åˆ¶ä¸€ä¸ªæ™ºèƒ½å±‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> pyparsing <span class="keyword">import</span> Word, OneOrMore, Optional, Group, Suppress, alphanums</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Gate</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.is_open = <span class="keyword">False</span></div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'Open'</span> <span class="keyword">if</span> self.is_open <span class="keyword">else</span> <span class="string">'closed'</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">open</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'opening the gate'</span>)</div><div class="line">        self.is_open = <span class="keyword">True</span></div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">close</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'closing the gate'</span>)</div><div class="line">        self.is_open = <span class="keyword">False</span></div><div class="line">        </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Garage</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">		self.is_open = <span class="keyword">False</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'open'</span> <span class="keyword">if</span> self.is_open <span class="keyword">else</span> <span class="string">'closed'</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">open</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'opening the garage'</span>)</div><div class="line">        self.is_open = <span class="keyword">True</span></div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">close</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'closing the garage'</span>)</div><div class="line">        self.is_open = <span class="keyword">False</span></div><div class="line">    </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Aircondition</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.is_on = <span class="keyword">False</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'on'</span> <span class="keyword">if</span> self.is_on <span class="keyword">else</span> <span class="string">'off'</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">turn_on</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'turning on the aircondition'</span>)</div><div class="line">        self.is_on = <span class="keyword">True</span></div><div class="line">          </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">turn_off</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'turning off the aircondition'</span>)</div><div class="line">        self.is_on = <span class="keyword">True</span></div><div class="line">        </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Heating</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.is_on = <span class="keyword">False</span></div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'on'</span> <span class="keyword">if</span> self.is_on <span class="keyword">else</span> <span class="string">'off'</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">turn_on</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'turning on the heating'</span>)</div><div class="line">        self.is_on = <span class="keyword">True</span></div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">turn_off</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'turning off the heating'</span>)</div><div class="line">        self.is_on = <span class="keyword">False</span></div><div class="line">        </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Boiler</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.temperature = <span class="number">83</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'boiler temperature: &#123;&#125;'</span>.format(self.temperature)</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">increase_temperature</span><span class="params">(self, amount)</span>:</span></div><div class="line">        print(<span class="string">"increasing the boiler's temperature by &#123;&#125; degress"</span>.format(amount))</div><div class="line">        self.temperature += amount</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrease_temperature</span><span class="params">(self, amount)</span>:</span></div><div class="line">        print(<span class="string">"decreasing the boiler's temperature by &#123;&#125; degress"</span>.format(amount))</div><div class="line">        self.temperature -= amount</div><div class="line"> </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fridge</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.temperature = <span class="number">2</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'fridge temperature: &#123;&#125;'</span>.format(self.temperature)</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">increase_temperature</span><span class="params">(self, amount)</span>:</span></div><div class="line">        print(<span class="string">"increasing the fridge's temperature by &#123;&#125; degrees"</span>.format(amount))</div><div class="line">        self.temperature += amount</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrease_temperature</span><span class="params">(self, amount)</span>:</span></div><div class="line">        print(<span class="string">"decreasing the fridge's temperature by &#123;&#125; degrees"</span>.format(amount))</div><div class="line">        self.temperature -= amount</div><div class="line">        </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    word = Word(alphanums)</div><div class="line">    command = Group(OneOrMore(word))</div><div class="line">    token = Suppress(<span class="string">"-&gt;"</span>)</div><div class="line">    device = Group(OneOrMore(word))</div><div class="line">    argument = Group(OneOrMore(word))</div><div class="line">    event = command + token + device + Optional(token + argument)</div><div class="line">    </div><div class="line">    gate = Gate()</div><div class="line">    garage = Garage()</div><div class="line">    airco = Aircondition()</div><div class="line">    heating = Heating()</div><div class="line">    boiler = Boiler()</div><div class="line">    fridge = Fridge()</div><div class="line">    </div><div class="line">    tests = (<span class="string">'open -&gt; gate'</span>, </div><div class="line">             <span class="string">'close -&gt; garage'</span>,</div><div class="line">             <span class="string">'turn on -&gt; aircondition'</span>,</div><div class="line">             <span class="string">'turn off -&gt; heating'</span>, </div><div class="line">             <span class="string">'increase -&gt; boiler temperature -&gt; 5 degrees'</span>,</div><div class="line">             <span class="string">'decrease -&gt; fridge temperature -&gt; 2 degress'</span>)</div><div class="line">    open_actions = &#123;<span class="string">'gate'</span>: gate.open, </div><div class="line">                    <span class="string">'garage'</span>: garage.open, </div><div class="line">                    <span class="string">'aircondition'</span>: airco.turn_on,</div><div class="line">                    <span class="string">'heating'</span>: heating.turn_on,</div><div class="line">                    <span class="string">'boiler temperature'</span>: boiler.increase_temperature,</div><div class="line">                    <span class="string">'fridge temperature'</span>: fridge.increase_temperature&#125;</div><div class="line">    close_actions = &#123;<span class="string">'gate'</span>: gate.close, </div><div class="line">                    <span class="string">'garage'</span>: garage.close, </div><div class="line">                    <span class="string">'aircondition'</span>: airco.turn_off,</div><div class="line">                    <span class="string">'heating'</span>: heating.turn_off,</div><div class="line">                    <span class="string">'boiler temperature'</span>: boiler.decrease_temperature,</div><div class="line">                    <span class="string">'fridge temperature'</span>:fridge.decrease_temperature&#125;</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> tests:</div><div class="line">        <span class="keyword">if</span> len(event.parseString(t)) == <span class="number">2</span>:</div><div class="line">            cmd, dev = event.parseString(t)</div><div class="line">            cmd_str, dev_str = <span class="string">' '</span>.join(cmd), <span class="string">' '</span>join(dev)</div><div class="line">            <span class="keyword">if</span> <span class="string">'open'</span> <span class="keyword">in</span> cmd_str <span class="keyword">or</span> <span class="string">'turn on'</span> <span class="keyword">in</span> cmd_str:</div><div class="line">                open_actions[dev_str]()</div><div class="line">            <span class="keyword">elif</span> <span class="string">'close'</span> <span class="keyword">in</span> cmd_str <span class="keyword">or</span> <span class="string">'turn on'</span> <span class="keyword">in</span> cmd_str:</div><div class="line">                close_actions[dev_str]()</div><div class="line">         <span class="keyword">elif</span> len(event.parseString(t)) == <span class="number">3</span>:</div><div class="line">            cmd, dev, arg= event.parseString(t)</div><div class="line">            cmd_str, dev_str, arg_str = <span class="string">' '</span>.join(cmd), <span class="string">' '</span>.join(dev), <span class="string">' '</span>.join(arg)</div><div class="line">            num_arg = <span class="number">0</span></div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                num_arg = int(arg_str.split()[<span class="number">0</span>])</div><div class="line">            <span class="keyword">except</span> ValueError <span class="keyword">as</span> err:</div><div class="line">                print(<span class="string">"expected number nut got: '&#123;&#125;'"</span>.format(arg_str[<span class="number">0</span>]))</div><div class="line">            <span class="keyword">if</span> <span class="string">'increase'</span> <span class="keyword">in</span> cmd_str <span class="keyword">and</span> num_arg &gt; <span class="number">0</span>:</div><div class="line">                open_actions[dev_str](num_arg)</div><div class="line">            <span class="keyword">elif</span> <span class="string">'decrease'</span> <span class="keyword">in</span> cmd_str <span class="keyword">and</span> num_arg &gt; <span class="number">0</span>:</div><div class="line">                close_actions[dev_str](num_arg)</div><div class="line">                </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure>
<p><u>è§‚å¯Ÿè€…æ¨¡å¼</u></p>
<p>è§‚å¯Ÿè€…æ¨¡å¼æè¿°çš„æ˜¯å•ä¸ªå¯¹è±¡ï¼ˆå‘å¸ƒè€…ï¼Œåˆç§°ä¸ºä¸»æŒäººæˆ–å¯è§‚å¯Ÿè€…ï¼‰ä¸ä¸€ä¸ªæˆ–å¤šä¸ªå¯¹è±¡ï¼ˆè®¢é˜…è€…ï¼Œåˆç§°ä¸ºè§‚å¯Ÿè€…ï¼‰ä¹‹é—´çš„å‘å¸ƒ-è®¢é˜…å…³ç³»ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Publisher</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.observers = []</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(self, observer)</span>:</span></div><div class="line">        <span class="keyword">if</span> observer <span class="keyword">not</span> <span class="keyword">in</span> self.observers:</div><div class="line">            self.observers.append(observer)</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            print(<span class="string">'Failed to add: &#123;&#125;'</span>.format(observer))</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">remove</span><span class="params">(self, observer)</span>:</span></div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            self.observers.remove(observer)</div><div class="line">        <span class="keyword">except</span> ValueError:</div><div class="line">            print(<span class="string">'Failed to remove: &#123;&#125;'</span>.format(observer))</div><div class="line">            </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">notify</span><span class="params">(self)</span>:</span></div><div class="line">        [o.notify(self) <span class="keyword">for</span> o <span class="keyword">in</span> self.observers]</div><div class="line">        </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">DefaultFormatter</span><span class="params">(Publisher)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></div><div class="line">        Publisher.__init__(self)</div><div class="line">        self.name = name</div><div class="line">        self._data = <span class="number">0</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">"&#123;&#125;: '&#123;&#125;' has data = &#123;&#125;"</span>.format(type(self).__name__, self.name, self._data)</div><div class="line">    </div><div class="line"><span class="meta">    @property</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">data</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self._data</div><div class="line">    </div><div class="line"><span class="meta">    @data.setter</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">data</span><span class="params">(self, new_value)</span>:</span></div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            self._data = int(new_value)</div><div class="line">        <span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</div><div class="line">            print(<span class="string">'Error: &#123;&#125;'</span>.format(e))</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            self.notify()</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">HexFormatter</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">notify</span><span class="params">(self, publisher)</span>:</span></div><div class="line">        print(<span class="string">"&#123;&#125;: '&#123;&#125;' has now hex data = &#123;&#125;"</span>.format(type(self).__name__, publisher.name, hex(publisher.data)))</div><div class="line">        </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BinaryFormatter</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">notify</span><span class="params">(self, publisher)</span>:</span></div><div class="line">        print(<span class="string">"&#123;&#125;: '&#123;&#125;' has now bin data = &#123;&#125;"</span>.format(type(self).__name__, publisher.name, bin(publisher.data)))</div><div class="line">        </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    df = DefaultFormatter(<span class="string">'test1'</span>)</div><div class="line">    print(df)</div><div class="line">    </div><div class="line">    print()</div><div class="line">    hf = HexFormatter()</div><div class="line">    df.add(hf)</div><div class="line">    df.data = <span class="number">3</span></div><div class="line">    print(df)</div><div class="line">    </div><div class="line">    print()</div><div class="line">    bf = BinaryFormatter()</div><div class="line">    df.add(bf)</div><div class="line">    df.data = <span class="number">21</span></div><div class="line">    print(df)</div><div class="line">    </div><div class="line">    print()</div><div class="line">    df.remove(hf)</div><div class="line">    df.data = <span class="number">40</span></div><div class="line">    print(df)</div><div class="line">    </div><div class="line">    print()</div><div class="line">    df.remove(hf)</div><div class="line">    df.add(hf)</div><div class="line">    </div><div class="line">    df.data = <span class="string">'hello'</span></div><div class="line">    print(df)</div><div class="line">    </div><div class="line">    print()</div><div class="line">    df.data = <span class="number">15.8</span></div><div class="line">    print(df)</div><div class="line">    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure>
<p><u>æ¨¡ç‰ˆæ¨¡å¼</u></p>
<p>å¹¿åº¦ä¼˜å…ˆæœç´¢å’Œæ·±åº¦ä¼˜å…ˆæœç´¢èƒ½å¤Ÿä½“ç°ä¸€äº›é€šç”¨ä½†éå…¨éƒ¨çš„æ­¥éª¤ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#BFS</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">bfs</span><span class="params">(graph, start, end)</span>:</span></div><div class="line">    path = []</div><div class="line">    visited = [start]</div><div class="line">    <span class="keyword">while</span> visited:</div><div class="line">        current = visited.pop(<span class="number">0</span>)</div><div class="line">        <span class="keyword">if</span> current <span class="keyword">not</span> <span class="keyword">in</span> path:</div><div class="line">            path.append(current)</div><div class="line">            <span class="keyword">if</span> current == end:</div><div class="line">                print(path)</div><div class="line">				<span class="keyword">return</span> (<span class="keyword">True</span>, path)</div><div class="line">            <span class="keyword">if</span> current <span class="keyword">not</span> <span class="keyword">in</span> graph:</div><div class="line">                <span class="keyword">continue</span></div><div class="line">        visited = visited + graph[current]</div><div class="line">    <span class="keyword">return</span> (<span class="keyword">False</span>, path)</div><div class="line"></div><div class="line"><span class="comment">#DFS</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(graph, start, end)</span>:</span></div><div class="line">    path = []</div><div class="line">    visited = [start]</div><div class="line">    <span class="keyword">while</span> visited:</div><div class="line">        current = visited.pop(<span class="number">0</span>)</div><div class="line">        <span class="keyword">if</span> current <span class="keyword">not</span> <span class="keyword">in</span> path:</div><div class="line">            path.append(current)</div><div class="line">        	<span class="keyword">if</span> current == end:</div><div class="line">                print(path)</div><div class="line">                <span class="keyword">return</span> (<span class="keyword">True</span>, path)</div><div class="line">            <span class="keyword">if</span> current <span class="keyword">not</span> <span class="keyword">in</span> graph:</div><div class="line">                <span class="keyword">continue</span></div><div class="line">        visited = graph[current] + visited</div><div class="line">    <span class="keyword">return</span> (<span class="keyword">False</span>, path)</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œä¸¤ä¸ªç®—æ³•æœ‰å¤§é‡çš„é‡å¤ï¼Œè€Œåªæœ‰ä¸€è¡Œä¸åŒï¼Œå› æ­¤å¯ä»¥è¿ç”¨æ¨¡ç‰ˆæ¨¡å¼ï¼Œæ¥è§£å†³ä»£ç å†—ä½™çš„é—®é¢˜ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">traverse</span><span class="params">(graph, start, end, action)</span>:</span></div><div class="line">    path = []</div><div class="line">    visited = [start]</div><div class="line">    <span class="keyword">while</span> visited:</div><div class="line">        current = visited.pop(<span class="number">0</span>)</div><div class="line">        <span class="keyword">if</span> current <span class="keyword">not</span> <span class="keyword">in</span> path:</div><div class="line">            path.append(current)</div><div class="line">            <span class="keyword">if</span> current == end:</div><div class="line">                <span class="keyword">return</span> (<span class="keyword">True</span>, path)</div><div class="line">            <span class="keyword">if</span> current <span class="keyword">not</span> <span class="keyword">in</span> graph:</div><div class="line">                <span class="keyword">continue</span></div><div class="line">        visited = action(visited, graph[current])</div><div class="line">     <span class="keyword">return</span> (<span class="keyword">False</span>, path)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">extend_bfs_path</span><span class="params">(visited, current)</span>:</span></div><div class="line">    <span class="keyword">return</span> visited + current</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">extend_dfs_path</span><span class="params">(visited, current)</span>:</span></div><div class="line">    <span class="keyword">return</span> current + visited</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/29/ã€ŠPythonè®¾è®¡æ¨¡å¼ã€‹è¯»ä¹¦ç¬”è®°äºŒ/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å½¼å¾—çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/29/ã€ŠPythonè®¾è®¡æ¨¡å¼ã€‹è¯»ä¹¦ç¬”è®°äºŒ/" itemprop="url">
                  ã€ŠPythonè®¾è®¡æ¨¡å¼ã€‹è¯»ä¹¦ç¬”è®°äºŒ
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-07-29T19:29:23+08:00">
                2017-07-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python-Notes/" itemprop="url" rel="index">
                    <span itemprop="name">Python_Notes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>è¿™å‘¨çš„å­¦ä¹ è®¡åˆ’æ˜¯é˜…è¯»<code>å¤–è§‚æ¨¡å¼</code>ã€<code>äº«å…ƒæ¨¡å¼</code>ã€<code>æ¨¡å‹-è§†å›¾-æ§åˆ¶å™¨æ¨¡å¼</code>ã€<code>ä»£ç†æ¨¡å¼</code>å’Œ<code>è´£ä»»é“¾æ¨¡å¼</code>ã€‚</p>
<p><u>å¤–è§‚è®¾è®¡æ¨¡å¼</u></p>
<p>å¤–è§‚è®¾è®¡æ¨¡å¼çš„ä½œç”¨æ˜¯éšè—ç³»ç»Ÿçš„å†…éƒ¨å¤æ‚æ€§ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªç®€åŒ–çš„æ¥å£å‘å®¢æˆ·ç«¯æš´éœ²å¿…è¦çš„éƒ¨åˆ†ã€‚ä½¿ç”¨å¤–è§‚æ¨¡å¼çš„æœ€å¸¸è§ç†ç”±æ˜¯ä¸ºä¸€ä¸ªå¤æ‚ç³»ç»Ÿæä¾›å•ä¸ªç®€å•çš„å…¥å£ç‚¹ã€‚å¼•å…¥å¤–è§‚ä¹‹åï¼Œå®¢æˆ·ç«¯ä»£ç é€šè¿‡ç®€å•åœ°è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ï¼å‡½æ•°å°±èƒ½ä½¿ç”¨ä¸€ä¸ªç³»ç»Ÿã€‚åŒæ—¶ï¼Œå†…éƒ¨ç³»ç»Ÿå¹¶ä¸ä¼šä¸¢å¤±ä»»ä½•åŠŸèƒ½ï¼Œå¤–è§‚åªæ˜¯å°è£…äº†å†…éƒ¨ç³»ç»Ÿã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªé¢å¤–çš„å¥½å¤„ï¼Œå°±æ˜¯æˆ‘ä»¬å¯ä»¥æ”¹å˜ç³»ç»Ÿå†…éƒ¨ï¼Œä½†å®¢æˆ·ç«¯ä»£ç ç”¨æˆ·ä¸ç”¨å…³å¿ƒè¿™ä¸ªæ”¹å˜ï¼Œä¹Ÿä¸ä¼šå—è¿™ä¸ªæ”¹å˜çš„å½±å“ã€‚</p>
<p>ä¸‹é¢å°†ä»¥å¤šæœåŠ¡è¿›ç¨‹æ“ä½œç³»ç»Ÿä½¿ç”¨çš„æ¥å£å®ç°æ¥è¯´æ˜å¤–è§‚æ¨¡å¼æ˜¯å¦‚ä½•ä½“ç°çš„ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum</div><div class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> ABCMeta, abstractmethod</div><div class="line"></div><div class="line">State = Enum(<span class="string">'State'</span>, <span class="string">'new running sleeping restart zombie'</span>)</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>:</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Process</span>:</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Server</span><span class="params">(metaclass=ABCMeta)</span>:</span></div><div class="line"><span class="meta">    @abstractmethod</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">pass</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.name</div><div class="line">    </div><div class="line"><span class="meta">    @abstractmethod</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">boot</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">pass</span></div><div class="line">    </div><div class="line"><span class="meta">    @abstractmethod</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">kill</span><span class="params">(self, restart=True)</span>:</span></div><div class="line">        <span class="keyword">pass</span></div><div class="line">    </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileServer</span><span class="params">(Server)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.name = <span class="string">"FileServer"</span></div><div class="line">        self.state = State.new</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">boot</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'booting the &#123;&#125;'</span>.format(self))</div><div class="line">        self.state = State.running</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">kill</span><span class="params">(self, restart=True)</span>:</span></div><div class="line">        print(<span class="string">'Killing &#123;&#125;'</span>.format(self))</div><div class="line">        self.state = State.restart <span class="keyword">if</span> restart <span class="keyword">else</span> State.zombie</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create_file</span><span class="params">(self, user, name, permissions)</span>:</span></div><div class="line">        print(<span class="string">"trying to create the file '&#123;&#125;' for user '&#123;&#125;' with permissions &#123;&#125;"</span>.format(name, user, permissions))</div><div class="line">        </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProcessServer</span><span class="params">(Server)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.name = <span class="string">'ProcessServer'</span></div><div class="line">        self.state = State.new</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">boot</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'booting the &#123;&#125;'</span>.format(self))</div><div class="line">        self.state = State.running</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">kill</span><span class="params">(self, restart=True)</span>:</span></div><div class="line">        print(<span class="string">'Killing &#123;&#125;'</span>.format(self))</div><div class="line">        self.state = State.restart <span class="keyword">if</span> restart <span class="keyword">else</span> State.zombie</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create_process</span><span class="params">(self, user, name)</span>:</span></div><div class="line">        print(<span class="string">"trying to create the process '&#123;&#125;' for user '&#123;&#125;'"</span>.format(name, user))</div><div class="line">        </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">WindowServer</span>:</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">NetworkServer</span>:</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">OperatingSystem</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.fs = FileServer()</div><div class="line">        self.ps = ProcessServer()</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start</span><span class="params">(self)</span>:</span></div><div class="line">        [i.boot() <span class="keyword">for</span> i <span class="keyword">in</span> (self.fs, self.ps)]</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create_file</span><span class="params">(self, user, name, permissions)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.ps.create_process(user, name)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    os = OperatingSystem()</div><div class="line">    os.start()</div><div class="line">    os.create_file(<span class="string">'foo'</span>, <span class="string">'hello'</span>, <span class="string">'-rw-r-r'</span>)</div><div class="line">    os.create_process(<span class="string">'bar'</span>, <span class="string">'ls/tmp'</span>)</div><div class="line">    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure>
<p><u>äº«å…ƒæ¨¡å¼</u></p>
<p>ä¸€ä¸ªäº«å…ƒï¼ˆFlyweightï¼‰å°±æ˜¯ä¸€ä¸ªåŒ…å«çŠ¶æ€ç‹¬ç«‹çš„ä¸å¯å˜ï¼ˆåˆç§°å›ºæœ‰çš„ï¼‰æ•°æ®çš„å…±äº«å¯¹è±¡ï¼Œäº«å…ƒæ—¨åœ¨ä¼˜åŒ–æ€§èƒ½å’Œå†…å­˜ä½¿ç”¨ã€‚è‹¥æƒ³äº«å…ƒæ¨¡å¼æœ‰æ•ˆï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹å‡ ä¸ªæ¡ä»¶ï¼š</p>
<ul>
<li>åº”ç”¨éœ€è¦ä½¿ç”¨å¤§é‡çš„å¯¹è±¡</li>
<li>å¯¹è±¡å¤ªå¤šï¼Œå­˜å‚¨ï¼æ¸²æŸ“å®ƒä»¬çš„ä»£ä»·å¤ªå¤§ã€‚ä¸€æ—¦ç§»é™¤å¯¹è±¡ä¸­çš„å¯å˜çŠ¶æ€ï¼ˆå› ä¸ºåœ¨éœ€è¦ä¹‹æ—¶ï¼Œåº”è¯¥ç”±å®¢æˆ·ç«¯ä»£ç æ˜¾å¼åœ°ä¼ é€’ç»™äº«å…ƒï¼‰ï¼Œå¤šç»„ä¸åŒçš„å¯¹è±¡å¯è¢«ç›¸å¯¹æ›´å°‘çš„å…±äº«å¯¹è±¡æ‰€æ›¿ä»£ã€‚</li>
<li>å¯¹è±¡IDå¯¹äºåº”ç”¨ä¸é‡è¦ã€‚å…±äº«å¯¹è±¡ä¼šé€ æˆIDæ¯”è¾ƒçš„å¤±è´¥ï¼Œæ‰€ä»¥ä¸èƒ½ä¾èµ–å¯¹è±¡IDï¼ˆé‚£äº›åœ¨å®¢æˆ·ç«¯ä»£ç çœ‹æ¥ä¸åŒçš„å¯¹è±¡ï¼Œæœ€ç»ˆå…·æœ‰ç›¸åŒçš„IDï¼‰ã€‚</li>
</ul>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨åº”ç”¨éœ€è¦åˆ›å»ºå¤§é‡çš„è®¡ç®—ä»£ä»·å¤§ä½†å…±äº«è®¸å¤šå±æ€§çš„å¯¹è±¡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨äº«å…ƒã€‚</p>
<p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œå°†ä¼šæ„é€ ä¸€å°ç‰‡æ°´æœæ ‘çš„æ£®æ—ï¼Œå°åˆ°èƒ½ç¡®ä¿åœ¨å•ä¸ªç»ˆç«¯é¡µé¢ä¸­é˜…è¯»æ•´ä¸ªè¾“å‡ºã€‚ç„¶è€Œï¼Œæ— è®ºä½ æ„é€ çš„æ£®æ—æœ‰å¤šå¤§ï¼Œå†…å­˜åˆ†é…éƒ½ä¿æŒç›¸åŒã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> random</div><div class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum</div><div class="line"></div><div class="line">TreeType = Enum(<span class="string">'TreeType'</span>, <span class="string">'apple_tree cherry_tree peach_tree'</span>)</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tree</span>:</span></div><div class="line">    pool = dict()</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, tree_type)</span>:</span></div><div class="line">        obj = cls.pool.get(tree_type, <span class="keyword">None</span>)</div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> obj:</div><div class="line">            obj = object.__new__(cls)</div><div class="line">            cls.pool[tree_type] = obj</div><div class="line">            obj.tree_type = tree_type</div><div class="line">        <span class="keyword">return</span> obj</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">render</span><span class="params">(self, age, x, y)</span>:</span></div><div class="line">        print(<span class="string">'render a tree of type &#123;&#125; and age &#123;&#125; at (&#123;&#125;, &#123;&#125;)'</span>).format(self.tree_type, age, x, y)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    rnd = random.Random()</div><div class="line">    age_min, age_max = <span class="number">1</span>, <span class="number">30</span></div><div class="line">    min_point, max_point = <span class="number">0</span>, <span class="number">100</span></div><div class="line">    tree_counter = <span class="number">0</span></div><div class="line">    </div><div class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">10</span>):</div><div class="line">        t1 = Tree(TreeType.apple_tree)</div><div class="line">        t1.render(rnd.randint(age_min, age_max),</div><div class="line">         		  rnd.randint(min_point, max_point),</div><div class="line">                  rnd.randint(min_point, max_point))</div><div class="line">        tree_counter+=<span class="number">1</span></div><div class="line">    </div><div class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">3</span>):</div><div class="line">        t2 = Tree(TreeType.apple_tree)</div><div class="line">        t2.render(rnd.randint(age_min, age_max),</div><div class="line">         		  rnd.randint(min_point, max_point),</div><div class="line">                  rnd.randint(min_point, max_point))</div><div class="line">        tree_counter+=<span class="number">1</span></div><div class="line">        </div><div class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">5</span>):</div><div class="line">        t3 = Tree(TreeType.apple_tree)</div><div class="line">        t3.render(rnd.randint(age_min, age_max),</div><div class="line">         		  rnd.randint(min_point, max_point),</div><div class="line">                  rnd.randint(min_point, max_point))</div><div class="line">        tree_counter+=<span class="number">1</span></div><div class="line">        </div><div class="line">    print(<span class="string">'trees rendered: &#123;&#125;'</span>.format(tree_counter))</div><div class="line">    print(<span class="string">'trees actually created: &#123;&#125;'</span>.format(len(Tree.pool)))</div><div class="line">    </div><div class="line">    t4 = Tree(TreeType.cherry_tree)</div><div class="line">    t5 = Tree(TreeType.cherry_tree)</div><div class="line">    t6 = Tree(TreeType.apple_tree)</div><div class="line">    print(<span class="string">'&#123;&#125; == &#123;&#125;? &#123;&#125;'</span>.format(id(t4), id(t5), id(t4) == id(t5)))</div><div class="line">    print(<span class="string">'&#123;&#125; == &#123;&#125;? &#123;&#125;'</span>.format(id(t5), id(t6), id(t5) == id(t6)))</div><div class="line">    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure>
<p><u>æ¨¡å‹-è§†å›¾-æ§åˆ¶å™¨æ¨¡å¼</u></p>
<p>å…³æ³¨ç‚¹åˆ†ç¦»ï¼ˆSeperation of Concernsï¼ŒSoCï¼‰åŸåˆ™æ˜¯è½¯ä»¶å·¥ç¨‹ç›¸å…³çš„è®¾è®¡åŸåˆ™ä¹‹ä¸€ã€‚SoCåŸåˆ™èƒŒåçš„æ€æƒ³æ˜¯å°†ä¸€ä¸ªåº”ç”¨åˆ‡åˆ†æˆä¸åŒçš„éƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†è§£å†³ä¸€ä¸ªå•ç‹¬çš„å…³æ³¨ç‚¹ã€‚åˆ†å±‚è®¾è®¡ä¸­çš„å±‚æ¬¡ï¼ˆæ•°æ®è®¿é—®å±‚ã€ä¸šåŠ¡é€»è¾‘å±‚å’Œè¡¨ç¤ºå±‚ç­‰ï¼‰å³æ˜¯å…³æ³¨ç‚¹çš„ä¾‹å­ã€‚ä½¿ç”¨SoCåŸåˆ™èƒ½ç®€åŒ–è½¯ä»¶åº”ç”¨çš„å¼€å‘å’Œç»´æŠ¤ã€‚</p>
<p>ä¸€å¼€å§‹æ¥è§¦<code>MVC</code>æ¨¡å¼æ˜¯å› ä¸ºå­¦ä¹ <code>Django</code>ï¼Œ<code>Django</code>æŠŠé€»è¾‘å±‚ã€æ•°æ®å±‚å’Œè¡¨ç¤ºå±‚éƒ½åˆ†å¼€ä¸‰ä¸ªéƒ¨åˆ†ã€‚æ‰€ä»¥å„ä¸ªæ¨¡å—çš„å®ç°éœ€è¦åœ¨å¯¹åº”çš„éƒ¨åˆ†ä¸­å¡«å†™ï¼Œè¿™æ ·å±‚æ¬¡æ¯”è¾ƒåˆ†æ˜ï¼Œå‡å°‘äº†æŠŠæ‰€æœ‰éƒ¨åˆ†éƒ½æ‰åœ¨ä¸€èµ·è€Œé€ æˆé”™è¯¯çš„é—®é¢˜ã€‚</p>
<p><u>ä»£ç†æ¨¡å¼</u></p>
<p>ä»£ç†æ¨¡å¼æœ‰ä»¥ä¸‹å››ç§ï¼š</p>
<ul>
<li>è¿œç¨‹ä»£ç†ï¼šå®é™…å­˜åœ¨äºä¸åŒåœ°å€ç©ºé—´ï¼ˆä¾‹å¦‚ï¼ŒæŸä¸ªç½‘ç»œæœåŠ¡å™¨ï¼‰çš„å¯¹è±¡åœ¨æœ¬åœ°çš„ä»£ç†è€…ã€‚</li>
<li>è™šæ‹Ÿä»£ç†ï¼šç”¨äºæ‡’åˆå§‹åŒ–ï¼Œå°†ä¸€ä¸ªå¤§è®¡ç®—é‡å¯¹è±¡çš„åˆ›å»ºå»¶è¿Ÿåˆ°çœŸæ­£éœ€è¦çš„æ—¶å€™è¿›è¡Œã€‚</li>
<li>ä¿æŠ¤ï¼é˜²æŠ¤ä»£ç†ï¼šæ§åˆ¶å¯¹æ•æ„Ÿå¯¹è±¡çš„è®¿é—®ã€‚</li>
<li>æ™ºèƒ½ï¼ˆå¼•ç”¨ï¼‰ä»£ç†ï¼šåœ¨å¯¹è±¡è¢«è®¿é—®æ—¶æ‰§è¡Œé¢å¤–çš„åŠ¨ä½œã€‚æ­¤ç±»ä»£ç†çš„ä¾‹å­åŒ…æ‹¬å¼•ç”¨è®¡æ•°å’Œçº¿ç¨‹å®‰å…¨æ£€æŸ¥ã€‚</li>
</ul>
<p>ä¸‹é¢çš„ä¾‹å­æ˜¯å®ç°ä¸€ä¸ªç®€å•çš„ä¿æŠ¤ä»£ç†æ¥æŸ¥çœ‹å’Œæ·»åŠ ç”¨æˆ·ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SensitiveInfo</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.users = [<span class="string">'nick'</span>, <span class="string">'tom'</span>, <span class="string">'ben'</span>, <span class="string">'mike'</span>]</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'There are &#123;&#125; users: &#123;&#125;'</span>.format(len(self.users), <span class="string">''</span>.join(self.users)))</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(self, user)</span>:</span></div><div class="line">        self.users.append(user)</div><div class="line">        print(<span class="string">'Added user &#123;&#125;'</span>.format(user))</div><div class="line">        </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Info</span>:</span></div><div class="line">    <span class="string">"""SensitiveInfoçš„ä¿æŠ¤ä»£ç†"""</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.protected = SensitiveInfo()</div><div class="line">        self.secret = <span class="string">'0xdeadbeef'</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read</span><span class="params">(self)</span>:</span></div><div class="line">        self.protected.read()</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(self, user)</span>:</span></div><div class="line">        sec = input(<span class="string">'what is the secret'</span>)</div><div class="line">        self.protected.add(user) <span class="keyword">if</span> sec == self.secret <span class="keyword">else</span> print(<span class="string">"That's wrong"</span>)</div><div class="line">        </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    info = Info()</div><div class="line">    </div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        print(<span class="string">'1. read list |==| 2. add user |==| 3. quit'</span>)</div><div class="line">        key = input(<span class="string">'choose option: '</span>)</div><div class="line">        <span class="keyword">if</span> key == <span class="string">'1'</span>:</div><div class="line">            info.read()</div><div class="line">        <span class="keyword">elif</span> key == <span class="string">'2'</span>:</div><div class="line">            name = input(<span class="string">'choose username: '</span>)</div><div class="line">            info.add(name)</div><div class="line">        <span class="keyword">elif</span> key == <span class="string">'3'</span>:</div><div class="line">            exit()</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            print(<span class="string">'unknown option: &#123;&#125;'</span>.format(key))</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure>
<p><u>è´£ä»»é“¾æ¨¡å¼</u></p>
<p>è´£ä»»é“¾ï¼ˆ<code>Chain of Responsibility</code>ï¼‰æ¨¡å¼ç”¨äºè®©å¤šä¸ªå¯¹è±¡æ¥å¤„ç†å•ä¸ªè¯·æ±‚æ—¶ï¼Œæˆ–è€…ç”¨äºé¢„å…ˆä¸çŸ¥é“åº”è¯¥ç”±å“ªä¸ªå¯¹è±¡ï¼ˆæ¥è‡ªæŸä¸ªå¯¹è±¡é“¾ï¼‰æ¥å¤„ç†æŸä¸ªç‰¹å®šè¯·æ±‚æ—¶ã€‚åœ¨æ— æ³•é¢„çŸ¥çŸ¥é“å¤„ç†ç¨‹åºçš„æ•°é‡å’Œç±»å‹æ—¶ï¼Œè¯¥æ¨¡å¼æœ‰åŠ©äºå¯¹è¯·æ±‚ï¼å¤„ç†äº‹æƒ…è¿›è¡Œå»ºæ¨¡ã€‚é€‚åˆä½¿ç”¨è´£ä»»é“¾æ¨¡å¼çš„ç³»ç»Ÿä¾‹å­åŒ…æ‹¬åŸºäºäº‹ä»¶çš„ç³»ç»Ÿã€é‡‡è´­ç³»ç»Ÿå’Œè¿è¾“ç³»ç»Ÿã€‚</p>
<p>ä¸‹é¢æ˜¯ç”¨è´£ä»»é“¾æ¨¡å¼å®ç°ä¸€ä¸ªç®€å•çš„äº‹ä»¶ç³»ç»Ÿã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Event</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></div><div class="line">        self.name = name</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.name</div><div class="line">    </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, parent=None)</span>:</span></div><div class="line">        self.parent = parent</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span><span class="params">(self, event)</span>:</span></div><div class="line">        handler = <span class="string">'handler_&#123;&#125;'</span>.format(event)</div><div class="line">        <span class="keyword">if</span> hasattr(self, handler):</div><div class="line">            method = getattr(self, handler)</div><div class="line">            method(event)</div><div class="line">        <span class="keyword">elif</span> self.parent:</div><div class="line">            self.parent.handler(event)</div><div class="line">        <span class="keyword">elif</span> hasattr(self, <span class="string">'handler_default'</span>):</div><div class="line">            self.handler_default(event)</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainWindow</span><span class="params">(Widget)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle_close</span><span class="params">(self, event)</span>:</span></div><div class="line">        print(<span class="string">'MainWindow: &#123;&#125;'</span>.format(event))</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handler_default</span><span class="params">(self, event)</span>:</span></div><div class="line">        print(<span class="string">'MainWindow: &#123;&#125;'</span>.format(event))</div><div class="line">        </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SendDialog</span><span class="params">(Widget)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle_paint</span><span class="params">(self, event)</span>:</span></div><div class="line">        print(<span class="string">'SendDialog: &#123;&#125;'</span>.format(event))</div><div class="line">        </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MsgText</span><span class="params">(Widget)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handler_down</span><span class="params">(self, event)</span>:</span></div><div class="line">        print(<span class="string">'MsgText: &#123;&#125;'</span>.format(event))</div><div class="line">        </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    mw = MainWindow()</div><div class="line">    sd = SendDialog(mw)</div><div class="line">    msg = MsgText(sd)</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> e <span class="keyword">in</span> (<span class="string">'down'</span>, <span class="string">'paint'</span>, <span class="string">'unhandled'</span>, <span class="string">'close'</span>):</div><div class="line">        evt = Event(e)</div><div class="line">        print(<span class="string">'\nSending event -&#123;&#125;- to MainWindow'</span>.format(evt))</div><div class="line">        mw.handle(evt)</div><div class="line">        print(<span class="string">'Sending event -&#123;&#125;- to SendDialog'</span>.format(evt))</div><div class="line">        sd.handle(evt)</div><div class="line">        print(<span class="string">'Sending event -&#123;&#125;- to MsgText'</span>.format(evt))</div><div class="line">        msg.handle(evt)</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/21/ã€ŠPythonè®¾è®¡æ¨¡å¼ã€‹è¯»ä¹¦ç¬”è®°ä¸€/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å½¼å¾—çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/21/ã€ŠPythonè®¾è®¡æ¨¡å¼ã€‹è¯»ä¹¦ç¬”è®°ä¸€/" itemprop="url">
                  ã€ŠPythonè®¾è®¡æ¨¡å¼ã€‹è¯»ä¹¦ç¬”è®°ä¸€
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-07-21T15:40:54+08:00">
                2017-07-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python-Notes/" itemprop="url" rel="index">
                    <span itemprop="name">Python_Notes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>è¿™å‘¨å¼€å§‹é˜…è¯»ã€Šç²¾é€šPythonè®¾è®¡æ¨¡å¼ã€‹ï¼Œæœ¬å‘¨çš„å­¦ä¹ è®¡åˆ’æ˜¯é˜…è¯»<code>å·¥å‚æ¨¡å¼</code>ã€<code>å»ºé€ è€…æ¨¡å¼</code>ã€<code>åŸå‹æ¨¡å¼</code>ã€<code>é€‚é…å™¨æ¨¡å¼</code>å’Œ<code>ä¿®é¥°å™¨æ¨¡å¼</code>ã€‚</p>
<p>åœ¨å·¥å‚æ¨¡å¼ä¸­ï¼Œå®¢æˆ·ç«¯å¯ä»¥è¯·æ±‚ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œæ— éœ€çŸ¥é“è¿™ä¸ªå¯¹è±¡æ¥è‡ªå“ªé‡Œï¼›ä¹Ÿå°±æ˜¯ä½¿ç”¨å“ªä¸ªç±»æ¥ç”Ÿæˆè¿™ä¸ªå¯¹è±¡ã€‚å·¥å‚èƒŒåçš„æ€æƒ³æ˜¯ç®€åŒ–å¯¹è±¡çš„åˆ›å»ºï¼ŒåŸºäºä¸€ä¸ªä¸­å¿ƒåŒ–å‡½æ•°æ¥å®ç°ï¼Œæ›´æ˜“äºè¿½è¸ªåˆ›å»ºäº†å“ªäº›å¯¹è±¡ã€‚é€šè¿‡å°†åˆ›å»ºå¯¹è±¡çš„ä»£ç å’Œä½¿ç”¨å¯¹è±¡çš„ä»£ç è§£è€¦ï¼Œå·¥å‚èƒ½å¤Ÿé™ä½åº”ç”¨ç»´æŠ¤çš„å¤æ‚åº¦ã€‚</p>
<p>å·¥å‚é€šå¸¸æœ‰ä¸¤ç§å½¢å¼ï¼šä¸€ç§æ˜¯å·¥å‚æ–¹æ³•(<code>Factory Method</code>)ï¼Œå¯¹ä¸åŒçš„è¾“å…¥å‚æ•°è¿”å›ä¸åŒçš„å¯¹è±¡ï¼›ç¬¬äºŒç§æ˜¯æŠ½è±¡å·¥å‚ï¼Œå®ƒæ˜¯ä¸€ç»„ç”¨äºåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³äº§å“çš„ç³»åˆ—ã€‚</p>
<p>åœ¨å·¥å‚æ–¹æ³•æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬æ‰§è¡Œå•ä¸ªå‡½æ•°ï¼Œä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼ˆæä¾›ä¿¡æ¯è¡¨æ˜æˆ‘ä»¬æƒ³è¦ä»€ä¹ˆï¼‰ï¼Œä½†å¹¶ä¸è¦æ±‚çŸ¥é“ä»»ä½•å…³äºå¯¹è±¡å¦‚ä½•å®ç°ä»¥åŠå¯¹è±¡æ¥è‡ªå“ªé‡Œçš„ç»†èŠ‚ã€‚</p>
<p>ä¸‹é¢æœ‰ä¸€ä¸ªä¾‹å­ï¼Œå°±æ˜¯æœ‰ä¸€äº›è¾“å…¥æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªXMLæ–‡ä»¶å’Œä¸€ä¸ªJSONæ–‡ä»¶ä¸­ï¼Œè¦å¯¹è¿™ä¸¤ä¸ªæ–‡ä»¶è¿›è¡Œè§£æï¼Œè·å–ä¸€äº›ä¿¡æ¯ã€‚åŒæ—¶ï¼Œå¸Œæœ›èƒ½å¤Ÿå¯¹è¿™äº›ï¼ˆä»¥åŠå°†æ¥æ¶‰åŠçš„æ‰€æœ‰ï¼‰å¤–éƒ¨æœåŠ¡è¿›è¡Œé›†ä¸­å¼çš„å®¢æˆ·ç«¯è¿æ¥ã€‚ç„¶ååˆ†åˆ«ä½¿ç”¨<code>Python</code>çš„ä¸¤ä¸ªåº“ï¼ˆ<code>xml.etree.ElementTree</code>å’Œ<code>json</code>ï¼‰æ¥å¤„ç†XMLå’ŒJSONã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> etree</div><div class="line"><span class="keyword">import</span> json</div></pre></td></tr></table></figure>
<p>ç±»<code>JSONConnector</code>è§£æJSONæ–‡ä»¶ï¼Œé€šè¿‡<code>parsed_data()</code>æ–¹æ³•ä»¥ä¸€ä¸ªå­—å…¸ï¼ˆ<code>dict</code>ï¼‰çš„å½¢å¼è¿”å›æ•°æ®ã€‚ä¿®é¥°å™¨<code>property</code>ä½¿<code>parsed_data()</code>æ˜¾å¾—æ›´åƒä¸€ä¸ªå¸¸è§„çš„å˜é‡ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ–¹æ³•ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">JSONConnector</span>:</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, filepath)</span>:</span></div><div class="line">        self.data = dict()</div><div class="line">        <span class="keyword">with</span> open(filepath, mode=<span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</div><div class="line">            self.data = json.load(f)</div><div class="line">    </div><div class="line"><span class="meta">    @property</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parsed_data</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.data</div></pre></td></tr></table></figure>
<p>ç±»<code>XMLConnector</code>è§£æXMLæ–‡ä»¶ï¼Œé€šè¿‡<code>parsed_data()</code>æ–¹æ³•ä»¥<code>xml.etree.Element</code>åˆ—è¡¨çš„å½¢å¼è¿”å›æ‰€æœ‰æ•°æ®ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">XMLConnector</span>:</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, filepath)</span>:</span></div><div class="line">        self.tree = etree.parse(filepath)</div><div class="line">        </div><div class="line"><span class="meta">    @property</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parsed_data</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.tree</div></pre></td></tr></table></figure>
<p>å‡½æ•°<code>connection_factory</code>æ˜¯ä¸€ä¸ªå·¥å‚æ–¹æ³•ï¼ŒåŸºäºè¾“å…¥æ–‡ä»¶è·¯å¾„çš„æ‰©å±•åè¿”å›ä¸€ä¸ª<code>JSONConnector</code>æˆ–<code>XMLConnector</code>çš„å®ä¾‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">connector_factory</span><span class="params">(filepath)</span>:</span></div><div class="line">    <span class="keyword">if</span> filepath.endswith(<span class="string">'json'</span>):</div><div class="line">        connector = JSONConnector</div><div class="line">    <span class="keyword">elif</span> filepath.endswith(<span class="string">'xml'</span>):</div><div class="line">        connector = XMLConnector</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">raise</span> ValueError(<span class="string">'Cannot connect to &#123;&#125;'</span>.format(filepath))</div></pre></td></tr></table></figure>
<p>ä¸ºä¾¿äºæ•´ä½“ç†è§£ï¼Œä¸‹é¢ç»™å‡ºå·¥å‚æ–¹æ³•å®ç°çš„å®Œæ•´ä»£ç ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> etree</div><div class="line"><span class="keyword">import</span> json</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">JSONConnector</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, filepath)</span>:</span></div><div class="line">        self.data = dict()</div><div class="line">        <span class="keyword">with</span> open(filepath, mode=<span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</div><div class="line">            self.data = json.load(f)</div><div class="line"><span class="meta">    @property</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parsed_data</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.data</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">XMLConnector</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, filepath)</span>:</span></div><div class="line">        self.tree = etree.parse(filepath)</div><div class="line">        </div><div class="line"><span class="meta">    @property</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parsed_data</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.tree</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">connection_factory</span><span class="params">(filepath)</span>:</span></div><div class="line">    <span class="keyword">if</span> filepath.endswith(<span class="string">'json'</span>):</div><div class="line">        connector = JSONConnector</div><div class="line">    <span class="keyword">elif</span> filepath.endswith(<span class="string">'xml'</span>):</div><div class="line">        connector = XMLConnector</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">raise</span> ValueError(<span class="string">'Cannot connect to &#123;&#125;'</span>.format(filepath))</div><div class="line">    <span class="keyword">return</span> connector(filepath)</div><div class="line">                  </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">connect_to</span><span class="params">(filepath)</span>:</span></div><div class="line">    factory = <span class="keyword">None</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        factory = connection_factory(filepath)</div><div class="line">    <span class="keyword">except</span> ValueError <span class="keyword">as</span> ve:</div><div class="line">        print(ve)</div><div class="line">    <span class="keyword">return</span> factory</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    sqlite_factory = connect_to(<span class="string">'data/person.sq3'</span>)</div><div class="line">    print()</div><div class="line">    </div><div class="line">    xml_factory = connect_to(<span class="string">'data/person.xml'</span>)</div><div class="line">    xml_data = xml_factory.parsed_data</div><div class="line">    liars = xml_data.findall(<span class="string">".//&#123;&#125;[&#123;&#125;='&#123;&#125;']"</span>.format(<span class="string">'person'</span>, <span class="string">'lastName'</span>, <span class="string">'Liar'</span>))</div><div class="line">    print(<span class="string">'found: &#123;&#125; persons'</span>.format(len(liars)))</div><div class="line">    <span class="keyword">for</span> liar <span class="keyword">in</span> liars:</div><div class="line">        print(<span class="string">'first name: &#123;&#125;'</span>.format(liar.find(<span class="string">'firstName'</span>).text))</div><div class="line">        print(<span class="string">'last name: &#123;&#125;'</span>.format(liar.find(<span class="string">'lastName'</span>).text))</div><div class="line">        [print(<span class="string">'phone number (&#123;&#125;)'</span>.format(p.attrib[<span class="string">'type'</span>]), p.text) <span class="keyword">for</span> p <span class="keyword">in</span> liar.find(<span class="string">'phoneNumbers'</span>)]</div><div class="line">    print()</div><div class="line">    </div><div class="line">    json_factory = connect_to(<span class="string">'data/donut.json'</span>)</div><div class="line">    json_data = json_factory.parsed_data</div><div class="line">    print(<span class="string">'found: &#123;&#125; donuts'</span>.format(len(json_data)))</div><div class="line">    <span class="keyword">for</span> donut <span class="keyword">in</span> json_data:</div><div class="line">        print(<span class="string">'name: &#123;&#125;'</span>.format(donut[<span class="string">'name'</span>]))</div><div class="line">        print(<span class="string">'price: $&#123;&#125;'</span>.format(donut[<span class="string">'ppu'</span>]))</div><div class="line">        [print(<span class="string">'topping: &#123;&#125; &#123;&#125;'</span>.format(t[<span class="string">'id'</span>], t[<span class="string">'type'</span>])) <span class="keyword">for</span> t <span class="keyword">in</span> donut[<span class="string">'topping'</span>]]</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure>
<p>å¯¹äºæŠ½è±¡å·¥å‚ï¼Œå®ƒæ‹¥æœ‰å·¥å‚æ–¹æ³•æ¨¡å¼çš„å¥½å¤„ï¼šè®©å¯¹è±¡çš„åˆ›å»ºæ›´å®¹æ˜“è¿½è¸ªï¼›å°†å¯¹è±¡åˆ›å»ºä¸ä½¿ç”¨è§£è€¦ï¼›æä¾›ä¼˜åŒ–å†…å­˜å ç”¨å’Œåº”ç”¨æ€§èƒ½çš„æ½œåŠ›ã€‚è€ŒæŠ½è±¡å·¥å‚æœ‰ä¸€ä¸ªä¼˜ç‚¹ï¼Œå°±æ˜¯åœ¨ä½¿ç”¨å·¥å‚æ–¹æ³•æ—¶ä»ç”¨æˆ·è§†è§’é€šå¸¸æ˜¯çœ‹ä¸åˆ°çš„ï¼Œé‚£å°±æ˜¯æŠ½è±¡å·¥å‚èƒ½å¤Ÿé€šè¿‡æ”¹å˜æ¿€æ´»çš„å·¥å‚æ–¹æ³•åŠ¨æ€åœ°ï¼ˆè¿è¡Œæ—¶ï¼‰æ”¹å˜åº”ç”¨è¡Œä¸ºã€‚</p>
<p>ä¸‹é¢å°è¯•åˆ›å»ºä¸€ä¸ªæ¸¸æˆï¼ŒåŒ…å«ä¸¤ä¸ªæ¸¸æˆï¼Œä¸€ä¸ªé¢å‘å­©å­ï¼Œä¸€ä¸ªé¢å‘æˆäººã€‚åœ¨è¿è¡Œæ—¶ï¼ŒåŸºäºç”¨æˆ·è¾“å…¥ï¼Œå†³å®šè¯¥åˆ›å»ºå“ªä¸ªæ¸¸æˆå¹¶è¿è¡Œã€‚æ¸¸æˆçš„åˆ›å»ºéƒ¨åˆ†ç”±ä¸€ä¸ªæŠ½è±¡å·¥å‚ç»´æŠ¤ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Frog</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.name</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">interact_with</span><span class="params">(self, obstacle)</span>:</span></div><div class="line">        print(<span class="string">'&#123;&#125; the Frog encounters &#123;&#125; and &#123;&#125;!'</span>.format(self, obstacle, obstacle.action()))</div><div class="line">        </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bug</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'a bug'</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">action</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'eats it'</span></div><div class="line">    </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FrogWorld</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></div><div class="line">        print(self)</div><div class="line">        self.player_name = name</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'\n\n\t------ Frog World -------'</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">make_character</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> Frog(self.player_name)</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">make_obstacle</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> Bug()</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Wizard</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.name</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">interact_with</span><span class="params">(self, obstacle)</span>:</span></div><div class="line">        print(<span class="string">'&#123;&#125; the Wizard battles against &#123;&#125; and &#123;&#125;!'</span>.format(self, obstacle, obstacle.action()))</div><div class="line"> </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ork</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'an evil ork'</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">action</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'kills it'</span></div><div class="line">    </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">WizardWorld</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></div><div class="line">        print(self)</div><div class="line">        self.player_name = name</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'\n\n\t ----- Wizard World -----'</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">make_character</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> Wizard(self.player_name)</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">make_obstacle</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> Ork()</div></pre></td></tr></table></figure>
<p>å»ºé€ è€…æ¨¡å¼å’Œå·¥å‚æ¨¡å¼çš„å·®åˆ«å¹¶ä¸å¤ªæ˜ç¡®ã€‚ä¸»è¦çš„åŒºåˆ«åœ¨äºå·¥å‚æ¨¡å¼ä»¥å•ä¸ªæ­¥éª¤åˆ›å»ºå¯¹è±¡ï¼Œè€Œå»ºé€ è€…æ¨¡å¼ä»¥å¤šä¸ªæ­¥éª¤åˆ›å»ºå¯¹è±¡ï¼Œå¹¶ä¸”å‡ ä¹å§‹ç»ˆä¼šä½¿ç”¨ä¸€ä¸ªæŒ‡æŒ¥è€…ã€‚å¦å¤–ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼Œåœ¨å·¥å‚æ¨¡å¼ä¸‹ï¼Œä¼šç«‹å³è¿”å›ä¸€ä¸ªåˆ›å»ºå¥½çš„å¯¹è±¡ï¼›è€Œåœ¨å»ºé€ è€…æ¨¡å¼ä¸‹ï¼Œä»…åœ¨éœ€è¦æ—¶å®¢æˆ·ç«¯ä»£ç æ‰æ˜¾å¼åœ°è¯·æ±‚æŒ‡æŒ¥è€…è¿”å›æœ€ç»ˆçš„å¯¹è±¡å’Œç½‘é¡µã€‚</p>
<p>ä¸‹é¢ç”¨å»ºé€ è€…è®¾è®¡æ¨¡å¼æ¥å®ç°ä¸€ä¸ªæ¯”è¨è®¢è´­çš„åº”ç”¨ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum</div><div class="line"><span class="keyword">import</span> time</div><div class="line"></div><div class="line">PizzaProgress = Enum(<span class="string">'PizzaProgress'</span>, <span class="string">'queued preparation baking ready'</span>)</div><div class="line">PizzaDough = Enum(<span class="string">'PizzaDough'</span>, <span class="string">'thin thick'</span>)</div><div class="line">PizzaSauce = Enum(<span class="string">'PizzaSauce'</span>, <span class="string">'tomato creme_fraiche'</span>)</div><div class="line">PizzaTopping = Enum(<span class="string">'PizzaTopping'</span>, <span class="string">'mozzarella double_mozzarella bacon ham mushrooms red_onion oregano'</span>)</div><div class="line">STEP_DELAY = <span class="number">3</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pizza</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        self.dough = <span class="keyword">None</span></div><div class="line">        self.sauce = <span class="keyword">None</span></div><div class="line">        self.topping = []</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.name</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">prepare_dough</span><span class="params">(self, dough)</span>:</span></div><div class="line">        self.dough = dough</div><div class="line">        print(<span class="string">'preparing the &#123;&#125; dough of your &#123;&#125;...'</span>.format(self.dough.name, self))</div><div class="line">        time.sleep(STEP_DELAY)</div><div class="line">        print(<span class="string">'done with the &#123;&#125; dough'</span>.format(self.dough.name))</div><div class="line">        </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MargaritaBuilder</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.pizza = Pizza(<span class="string">'Margarita'</span>)</div><div class="line">        self.progress = PizzaProgress.queued</div><div class="line">        self.baking_time = <span class="number">5</span></div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">prepare_dough</span><span class="params">(self)</span>:</span></div><div class="line">        self.progress = PizzaProgress.preparation</div><div class="line">        self.pizza.prepare_dough(PizzaDough.thin)</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_sauce</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'adding the tomato sauce to your margarita...'</span>)</div><div class="line">        self.pizza.sauce = PizzaSauce.tomato</div><div class="line">        time.sleep(STEP_DELAY)</div><div class="line">        print(<span class="string">'done with the tomato sauce'</span>)</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_topping</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'adding the topping (double mozzarella, oregano) to your margarita'</span>)</div><div class="line">        self.pizza.topping.append([i <span class="keyword">for</span> i <span class="keyword">in</span> (PizzaTopping.double_mozzarella, PizzaTopping.oregano)])</div><div class="line">        time.sleep(STEP_DELAY)</div><div class="line">        print(<span class="string">'done with the topping (double mozzarella, oregano)'</span>)</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bake</span><span class="params">(self)</span>:</span></div><div class="line">        self.progress = PizzaProgress.baking</div><div class="line">        print(<span class="string">'baking your margarita for &#123;&#125; seconds'</span>.format(self.baking_time))</div><div class="line">        time.sleep(self.baking_time)</div><div class="line">        print(<span class="string">'your margarita is ready'</span>)</div><div class="line">        </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CreamyBaconBuilder</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.pizza = Pizza(<span class="string">'creamy bacon'</span>)</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">prepare_dough</span><span class="params">(self)</span>:</span></div><div class="line">        self.progress = PizzaProgress.preparation</div><div class="line">        self.pizza.prepare_dough(PizzaDough.thick)</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_sauce</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'adding the cream sauce to your creamy bacon'</span>)</div><div class="line">        self.pizza.sauce = PizzaSauce.creme_fraiche</div><div class="line">        time.sleep(STEP_DELAY)</div><div class="line">        print(<span class="string">'done with the creme sauce'</span>)</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_topping</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'adding the topping (mozzarella, bacon, ham, mushrooms, red onion, oregano) to your creamy bacon'</span>)</div><div class="line">        self.pizza.topping.append([t <span class="keyword">for</span> t <span class="keyword">in</span> (PizzaTopping.mozzarella, PizzaTopping.bacon, PizzaTopping.ham, PizzaTopping.mushrooms</div><div class="line">                                              PizzaTopping.red_onion, PizzaTopping.oregano)])</div><div class="line">        time.sleep(STEP_DELAY)</div><div class="line">        print(<span class="string">'done with the topping (mozzarella, bacon, ham, mushrooms, red onion, oregano)'</span>)</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bake</span><span class="params">(self)</span>:</span></div><div class="line">        self.progress = PizzaProgress.baking</div><div class="line">        print(<span class="string">'baking your creamy bacon for &#123;&#125; seconds'</span>.format(self.baking_time))</div><div class="line">        time.sleep(self.baking_time)</div><div class="line">        self.progress = PizzaProgress.ready</div><div class="line">        print(<span class="string">'your creamy bacon is ready'</span>)</div><div class="line">    </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Waiter</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.buidler = <span class="keyword">None</span></div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">construct_pizza</span><span class="params">(self, builder)</span>:</span></div><div class="line">        self.builder = builder</div><div class="line">        [step() <span class="keyword">for</span> step <span class="keyword">in</span> (builder.prepare_dough, builder.add_sauce, builder.add_topping, builder.bake)]</div><div class="line">        </div><div class="line"><span class="meta">    @property</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pizza</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.builder.pizza</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">validate_style</span><span class="params">(builders)</span>:</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        pizza_style = input(<span class="string">'What pizza would you like, [m]argarita or [c]reamy bacon?'</span>)</div><div class="line">        builder = builders[pizza_style]</div><div class="line">        valid_input = <span class="keyword">True</span></div><div class="line">    <span class="keyword">except</span> KeyError <span class="keyword">as</span> err:</div><div class="line">        print(<span class="string">'Sorry, only margarita (key m) and creamy bacon (key c) are available'</span>)</div><div class="line">        <span class="keyword">return</span> (<span class="keyword">False</span>, <span class="keyword">None</span>)</div><div class="line">    <span class="keyword">return</span> (<span class="keyword">True</span>, builder)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    builders = dict(m=MargaritaBuilder, c=CreamyBaconBuilder)</div><div class="line">    valid_input = <span class="keyword">False</span></div><div class="line">    <span class="keyword">while</span> <span class="keyword">not</span> valid_input:</div><div class="line">        valid_input, builder = validate_style(builders)</div><div class="line">    print()</div><div class="line">    waiter = Waiter()</div><div class="line">    waiter.construct_pizza(builder)</div><div class="line">    pizza = waiter.pizza</div><div class="line">    print()</div><div class="line">    print(<span class="string">'Enjoy your &#123;&#125;!'</span>.format(pizza))</div><div class="line">    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure>
<p>åœ¨ä»¥ä¸‹å‡ ç§æƒ…å†µä¸‹ï¼Œä¸å·¥å‚æ¨¡å¼ç›¸æ¯”ï¼Œå»ºé€ è€…æ¨¡å¼æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚</p>
<ul>
<li>æƒ³è¦åˆ›å»ºä¸€ä¸ªå¤æ‚å¯¹è±¡ï¼ˆå¯¹è±¡ç”±å¤šä¸ªéƒ¨åˆ†æ„æˆï¼Œä¸”å¯¹è±¡çš„åˆ›å»ºè¦ç»è¿‡å¤šä¸ªä¸åŒçš„æ­¥éª¤ï¼Œè¿™äº›æ­¥éª¤ä¹Ÿè®¸è¿˜éœ€éµä»ç‰¹å®šçš„é¡ºåºï¼‰</li>
<li>è¦æ±‚ä¸€ä¸ªå¯¹è±¡èƒ½æœ‰ä¸åŒçš„è¡¨ç°ï¼Œå¹¶å¸Œæœ›å°†å¯¹è±¡çš„æ„é€ ä¸è¡¨ç°è§£è€¦</li>
<li>æƒ³è¦åœ¨æŸä¸ªæ—¶é—´ç‚¹åˆ›å»ºå¯¹è±¡ï¼Œä½†åœ¨ç¨åçš„æ—¶é—´ç‚¹å†è®¿é—®</li>
</ul>
<p>åŸå‹è®¾è®¡æ¨¡å¼å¸®åŠ©æˆ‘ä»¬åˆ›å»ºå¯¹è±¡çš„å…‹éš†ï¼Œåœ¨<code>Python</code>ä¸­ï¼Œè¿™å¯ä»¥ç”¨<code>copy.deepcopy()</code>å‡½æ•°æ¥å®Œæˆã€‚åˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„å‰¯æœ¬å¯ä»¥æŒ‡ä»£ä»¥ä¸‹ä¸¤ä»¶äº‹æƒ…ã€‚</p>
<ul>
<li>å½“åˆ›å»ºä¸€ä¸ªæµ…å‰¯æœ¬æ—¶ï¼Œå‰¯æœ¬ä»¥æ¥å¼•ç”¨</li>
<li>å½“åˆ›å»ºä¸€ä¸ªæ·±å‰¯æœ¬æ—¶ï¼Œå‰¯æœ¬å¤åˆ¶æ‰€æœ‰ä¸œè¥¿</li>
</ul>
<p>åœ¨ç¬¬ä¸€ç§æƒ…å†µä¸­ï¼Œå…³æ³¨æå‡åº”ç”¨æ€§èƒ½å’Œä¼˜åŒ–å†…å­˜ä½¿ç”¨ï¼Œåœ¨å¯¹è±¡ä¹‹é—´å¼•å…¥æ•°æ®å…±äº«ï¼Œä½†éœ€è¦å°å¿ƒåœ°ä¿®æ”¹æ•°æ®ï¼Œå› ä¸ºæ‰€æœ‰å˜æ›´å¯¹æ‰€æœ‰å‰¯æœ¬éƒ½æ˜¯å¯è§çš„ã€‚</p>
<p>åœ¨ç¬¬äºŒç§æƒ…å†µä¸­ï¼Œå¯¹ä¸€ä¸ªå‰¯æœ¬è¿›è¡Œæ›´æ”¹è€Œä¸ä¼šå½±å“å…¶ä»–å¯¹è±¡ã€‚</p>
<p>é€‚é…å™¨æ¨¡å¼ï¼ˆ<code>Adapter pattern</code>ï¼‰æ˜¯ä¸€ç§ç»“æ„å‹è®¾è®¡æ¨¡å¼ï¼Œå¸®åŠ©æˆ‘ä»¬å®ç°ä¸¤ä¸ªä¸å…¼å®¹æ¥å£ä¹‹é—´çš„å…¼å®¹ã€‚å› ä¸ºä½¿ç”¨é€‚é…å™¨æ¨¡å¼ä¸è¦æ±‚è®¿é—®ä»–æ–¹æ¥å£çš„æºä»£ç ï¼Œè€Œä¸”ä¸è¿åå¼€æ”¾ï¼å°é—­åŸåˆ™ã€‚</p>
<p>å‡è®¾æœ‰ä¸€ä¸ª<code>Computer</code>ç±»ï¼Œç”¨æ¥æ˜¾ç¤ºä¸€å°è®¡ç®—æœºçš„åŸºæœ¬ä¿¡æ¯ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Computer</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></div><div class="line">        self.name = name</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'the &#123;&#125; computer'</span>.format(self.name)</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">execute</span><span class="params">()</span></span></div></pre></td></tr></table></figure>
<p>åœ¨<code>Synthesizer</code>å’Œ<code>Human</code>ä¸¤ä¸ªç±»ä¸­ï¼Œ<code>Synthesizer</code>ä¸»è¦åŠ¨ä½œç”±<code>play()</code>æ–¹æ³•æ‰§è¡Œã€‚<code>Human</code>ä¸»è¦åŠ¨ä½œç”±<code>speak()</code>æ–¹æ³•æ‰§è¡Œã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Synthesizer</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></div><div class="line">        self.name = name</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'the &#123;&#125; synthesizer'</span>.format(self.name)</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">play</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'is playing an electronic song'</span></div><div class="line">    </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Human</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'&#123;&#125; the huamn'</span>.format(self.name)</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">speak</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'says hello'</span></div><div class="line">    </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Adapter</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, obj, adapted_methods)</span>:</span></div><div class="line">        self.obj = obj</div><div class="line">        self.__dict__.update(adapted_methods)</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> str(self.obj)</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    objects = [Computer(<span class="string">'Asus'</span>)]</div><div class="line">    </div><div class="line">    synth = Synthesizer(<span class="string">'moog'</span>)</div><div class="line">    objects.append(Adapter(synth, dict(execute=synth.play)))</div><div class="line">    </div><div class="line">    human = Human(<span class="string">'Bob'</span>)</div><div class="line">    objects.append(Adapter(human, dict(execute=huamn.speak)))</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> objects:</div><div class="line">        print(<span class="string">'&#123;&#125; &#123;&#125;'</span>.format(str(i), i.execute))</div><div class="line">        </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure>
<p>å…¶å®é€šè¿‡è¿™ä¸ªé€‚é…å™¨çš„è¿™ä¸€ç« èŠ‚çš„ç†è§£ï¼Œæ„Ÿè§‰é€‚é…å™¨å……å½“çš„æ˜¯ä¸€ä¸ªä¸­é—´äººæˆ–è€…è¯´ä¸€ä¸ªé“¾æ¥urlçš„ä½œç”¨ã€‚å°±åƒä¾‹å­ä¸­<code>Computer</code>çš„è¡Œä¸º<code>execute</code>ä¸€æ ·ï¼Œé€‚é…å™¨çš„ä½œç”¨å°±æ˜¯æŠŠ<code>Computer</code>çš„è¡Œä¸º<code>execute</code>å’Œ<code>Human</code>ç±»çš„<code>speak</code>è¡Œä¸ºè”ç³»èµ·æ¥ã€‚</p>
<p>ä¿®é¥°å™¨æ¨¡å¼èƒ½å¤Ÿä»¥é€æ˜çš„æ–¹å¼ï¼ˆä¸ä¼šå½±å“å…¶ä»–å¯¹è±¡ï¼‰åŠ¨æ€åœ°å°†åŠŸèƒ½æ·»åŠ åˆ°ä¸€ä¸ªå¯¹è±¡ä¸­ã€‚ä½†å’ŒPythonä¿®é¥°å™¨ä¹‹é—´å¹¶ä¸æ˜¯ä¸€å¯¹ä¸€çš„ç­‰ä»·å…³ç³»ã€‚Pythonä¿®é¥°å™¨èƒ½åšçš„å®é™…ä¸Šæ¯”ä¿®é¥°å™¨æ¨¡å¼å¤šå¾—å¤šï¼Œå…¶ä¸­å°±æ˜¯å®ç°ä¿®é¥°å™¨æ¨¡å¼ã€‚</p>
<p>ä¸‹é¢ç”¨æ–æ³¢é‚£å¥‘æ•°åˆ—ä½œä¸ºä¾‹å­ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬å¯ä»¥ç”¨é€’å½’æ–¹å¼å®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œä½†æ˜¯æ•ˆç‡å’Œé€Ÿåº¦éƒ½å¾ˆä½ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fibonacci</span><span class="params">(n)</span>:</span></div><div class="line">	<span class="keyword">assert</span>(n &gt;= <span class="number">0</span>). <span class="string">'n must be &gt;= 0'</span></div><div class="line">    <span class="keyword">return</span> n <span class="keyword">if</span> n <span class="keyword">in</span> (<span class="number">0</span>, <span class="number">1</span>) <span class="keyword">else</span> fibonacci(n<span class="number">-1</span>) + fibonacci(n<span class="number">-2</span>)</div></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬å°è¯•é€šè¿‡ä½¿ç”¨ä¸€ä¸ª<code>dict</code>æ¥ç¼“å­˜æ–æ³¢é‚£å¥‘æ•°åˆ—ä¸­å·²ç»è®¡ç®—å¥½çš„æ•°å€¼æ¥æé«˜æ•ˆç‡ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">known = &#123;<span class="number">0</span>:<span class="number">0</span>, <span class="number">1</span>:<span class="number">1</span>&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fibonacci</span><span class="params">(n)</span>:</span></div><div class="line">	<span class="keyword">assert</span>(n &gt;= <span class="number">0</span>), <span class="string">'n must be &gt;= 0'</span></div><div class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> known:</div><div class="line">        <span class="keyword">return</span> known[n]</div><div class="line">    res = fibonacci(n<span class="number">-1</span>) + fibonacci(n<span class="number">-2</span>)</div><div class="line">    known[n] = res</div><div class="line">    <span class="keyword">return</span> res</div></pre></td></tr></table></figure>
<p>ä½†å¦‚æœæˆ‘ä»¬å°è¯•æ‰©å±•ä»£ç ï¼ŒåŠ å…¥æ›´å¤šçš„æ•°å­¦å‡½æ•°ï¼Œå¹¶å°†å…¶è½¬å˜ä¸ºä¸€ä¸ªæ¨¡å—ï¼Œä»£ç å°†ä¼šè¶Šæ¥è¶Šå¤æ‚ã€‚å‡è®¾å†³å®šåŠ å…¥çš„æ˜¯<code>nsum()</code>ï¼Œè¯¥å‡½æ•°è¿”å›å‰nä¸ªæ•°å­—çš„å’Œã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">known_sum = &#123;<span class="number">0</span>:<span class="number">0</span>&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">nsum</span><span class="params">(n)</span>:</span></div><div class="line">    <span class="keyword">assert</span>(n &gt;= <span class="number">0</span>), <span class="string">'n must be &gt;= 0'</span></div><div class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> known_sum:</div><div class="line">        <span class="keyword">return</span> known_sum[n]</div><div class="line">    res = n + nsum(n<span class="number">-1</span>)</div><div class="line">    known_sum[n] = res</div><div class="line">    <span class="keyword">return</span> res</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ä¿®é¥°å™¨æ¨¡å¼ï¼Œèƒ½å¤Ÿå°†é€’å½’ä»£ç ä¿æŒä¸æœ´ç´ ç‰ˆæœ¬ä¸€æ ·ç®€å•ï¼Œä½†æ˜¯æ€§èƒ½ä¸Šèƒ½å¤Ÿéå¸¸é«˜æ•ˆã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> functools</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">memoize</span><span class="params">(fn)</span>:</span></div><div class="line">    known = dict()</div><div class="line">    </div><div class="line"><span class="meta">    @functools.wraps(fn)</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">memoizer</span><span class="params">(*args)</span>:</span></div><div class="line">        <span class="keyword">if</span> args <span class="keyword">not</span> <span class="keyword">in</span> known:</div><div class="line">            known[args] = fn(*args)</div><div class="line">        <span class="keyword">return</span> known[args]</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> memoizer</div></pre></td></tr></table></figure>
<p>é€šè¿‡åº”ç”¨<code>memoize()</code>ä¿®é¥°å™¨ï¼Œèƒ½å¤Ÿä¿æŒä»£ç çš„å¯è¯»æ€§åˆä¸å½±å“æ€§èƒ½ã€‚æ‰€ä»¥ï¼Œä¸Šè¿°çš„ä»£ç å°±å¯ä»¥è¿™æ ·å†™ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@memoize</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">nsum</span><span class="params">(n)</span>:</span></div><div class="line">	<span class="keyword">assert</span>(n &gt;= <span class="number">0</span>), <span class="string">'n must be &gt;= 0'</span></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span> <span class="keyword">if</span> n == <span class="number">0</span> <span class="keyword">else</span> n + nsum(n<span class="number">-1</span>)</div><div class="line"></div><div class="line"><span class="meta">@memoize</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fibonacci</span><span class="params">(n)</span>:</span></div><div class="line">    <span class="keyword">assert</span>(n &gt;= <span class="number">0</span>), <span class="string">'n must be &gt;= 0'</span></div><div class="line">    <span class="keyword">return</span> n <span class="keyword">if</span> n <span class="keyword">in</span> (<span class="number">0</span>, <span class="number">1</span>) <span class="keyword">else</span> fibonacci(n<span class="number">-1</span>) + fibonacci(n<span class="number">-2</span>)</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/pandas.jpeg"
               alt="Peter Tsung" />
          <p class="site-author-name" itemprop="name">Peter Tsung</p>
           
              <p class="site-description motion-element" itemprop="description">I Never Save Anything For The Swim Back.</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">35</span>
                <span class="site-state-item-name">æ—¥å¿—</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">åˆ†ç±»</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Peter Tsung</span>
</div>

<!--
<div class="powered-by">
  ç”± <a class="theme-link" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨
</div>

<div class="theme-info">
  ä¸»é¢˜ -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>
<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  æœ¬ç«™è®¿å®¢æ•°:<span id="busuanzi_value_site_uv"></span>
</span>
</div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
            tex2jax: { inlineMath: [ ["$", "$"], ["\\(","\\)"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno",skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']},
                    TeX: {  noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, Macros: { href: "{}" } },
                            messageStyle: "none"
                                }); 
    </script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Queue(function() {
                    var all = MathJax.Hub.getAllJax(), i;
                            for(i=0; i < all.length; i += 1) {
                                            all[i].SourceElement().parentNode.className += ' has-jax';
                                                    }
                                                        });
        </script>
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

-->


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  

  

  


<!--   <script src="/js/src/prettify.js" type="text/javascript"></script> -->
  <script type="text/javascript">
    $(window).load(function(){
    $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
     prettyPrint();
    })
  </script>
  <script type="text/javascript" src="/js/src/love.js"></script>
</body>
</html>
