<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="I Never Save Anything For The Swim Back.">
<meta property="og:type" content="website">
<meta property="og:title" content="彼得的博客">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="彼得的博客">
<meta property="og:description" content="I Never Save Anything For The Swim Back.">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="彼得的博客">
<meta name="twitter:description" content="I Never Save Anything For The Swim Back.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"always","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>彼得的博客</title>
  <!-- <link rel="stylesheet" type="text/css" href="/css/prettify.css"> -->
  <!-- <link rel="stylesheet" type="text/css" href="/css/hemisu-light.css"> -->
  <!-- <link rel="stylesheet" type="text/css" href="/css/hemisu-light.min.css"> -->
  <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
       <script type="text/x-mathjax-config">
         MathJax.Hub.Config({
           tex2jax: {
             inlineMath: [ ['$','$'], ["\\(","\\)"] ],
             processEscapes: true
           }
         });
       </script>
       <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">彼得的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/20/Perceptron/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彼得的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/05/20/Perceptron/" itemprop="url">
                  Perceptron
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-20T15:16:57+08:00">
                2018-05-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Machine-Learning/" itemprop="url" rel="index">
                    <span itemprop="name">Machine_Learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今天总结一下感知机。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/18/统计学习方法概论/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彼得的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/05/18/统计学习方法概论/" itemprop="url">
                  统计学习方法概论及Python应用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-18T10:41:37+08:00">
                2018-05-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Machine-learning/" itemprop="url" rel="index">
                    <span itemprop="name">Machine_learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近开始重新整理机器学习的内容。</p>
<p>今天总结以下几个内容：</p>
<ol type="1">
<li>有监督学习、无监督学习的比较、分类和回归方法的比较</li>
<li>过拟合和欠拟合的定义及解决方法</li>
<li>交叉验证</li>
<li>模型评估指标（精确率、召回率、F值、ROC、AUC、Explained_variance、MSE和MSLE）</li>
</ol>
<h3 id="一有监督学习无监督学习分类和回归方法">一、有监督学习、无监督学习、分类和回归方法</h3>
<p>​ 机器学习中有四个主要的分类：</p>
<ul>
<li>有监督学习<code>(supervised learning)</code></li>
<li>无监督学习<code>(unsupervised learning)</code></li>
<li>半监督学习<code>(semisupervised learning)</code></li>
<li>强化学习<code>(reinforcement learning)</code>。</li>
</ul>
<p>今天先讲监督学习<code>(supervised learning)</code>和无监督学习 <code>(unsupervised learning)</code>。</p>
<ol type="1">
<li><u>监督学习</u><code>(supervised learning)</code></li>
</ol>
<p>它是由训练数据中学到或者建立一个模式（函数或者是学习模型），使模型能够对任意给定的输入，对其相应的输出做出一个预测。</p>
<p>训练数据通常是一个向量和一个预期输出组成，如果函数的输出是一个连续的数值，则称为回归分析。如果函数的输出是一个分类标签，则称为分类问题<code>(classification)</code>。其中有以下模型：</p>
<blockquote>
<p>​ 决策树 · 表征(Bagging、Boosting、随即森林) · k-NN · 线性回归 · 朴素贝叶斯 · 神经网络 · 逻辑回归 · 感知器 · 支持向量机(SVM) · 相关向量机(RVM)</p>
</blockquote>
<p>现在我们来看点例子吧。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> linear_model</div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</div><div class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> svm</div><div class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> StratifiedKFold</div><div class="line"></div><div class="line">iris = datasets.load_iris()</div><div class="line">iris_X = iris.data</div><div class="line">iris_y = iris.target</div><div class="line"></div><div class="line"><span class="comment"># 打印分数</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">display_scores</span><span class="params">(scores)</span>:</span></div><div class="line">    print(<span class="string">"Scores : "</span>, scores)</div><div class="line">    print(<span class="string">"Mean : %.2f"</span> % scores.mean())</div><div class="line">    print(<span class="string">"Accuracy: %0.2f (+/- %0.2f)"</span> % (scores.mean(), scores.std() * <span class="number">2</span>))</div><div class="line"></div><div class="line"><span class="comment"># 输入model，X，y</span></div><div class="line"><span class="comment"># 输出分数</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">model_scores</span><span class="params">(model, X, y)</span>:</span></div><div class="line">    cv = StratifiedKFold(n_splits=<span class="number">5</span>, random_state=<span class="number">0</span>)</div><div class="line">    scores = cross_val_score(model, X, y, cv=cv)</div><div class="line">    display_scores(scores)</div><div class="line">    </div><div class="line"><span class="comment"># LinearRegression</span></div><div class="line">reg = linear_model.LinearRegression()</div><div class="line">model_scores(reg, iris_X, iris_y)</div><div class="line">[output]</div><div class="line">Scores :  [<span class="number">0.93427277</span> <span class="number">0.9395803</span>  <span class="number">0.89930025</span> <span class="number">0.90288946</span> <span class="number">0.95617435</span>]</div><div class="line">Mean : <span class="number">0.93</span></div><div class="line">Accuracy: <span class="number">0.93</span> (+/- <span class="number">0.04</span>)</div><div class="line"></div><div class="line"><span class="comment"># Logistic Regression</span></div><div class="line">logistic = linear_model.LogisticRegression(C=<span class="number">1e5</span>)</div><div class="line">model_scores(logistic, iris_X, iris_y)</div><div class="line">[output]</div><div class="line">Scores :  [<span class="number">0.96666667</span> <span class="number">0.96666667</span> <span class="number">0.93333333</span> <span class="number">0.93333333</span> <span class="number">1.</span>        ]</div><div class="line">Mean : <span class="number">0.96</span></div><div class="line">Accuracy: <span class="number">0.96</span> (+/- <span class="number">0.05</span>)</div><div class="line"></div><div class="line"><span class="comment"># SVM</span></div><div class="line">clf = svm.SVC(kernel=<span class="string">'linear'</span>, C=<span class="number">1</span>)</div><div class="line">model_scores(clf, iris_X, iris_y)</div><div class="line">[output]</div><div class="line">Scores :  [<span class="number">0.96666667</span> <span class="number">1.</span>         <span class="number">0.96666667</span> <span class="number">0.96666667</span> <span class="number">1.</span>        ]</div><div class="line">Mean : <span class="number">0.98</span></div><div class="line">Accuracy: <span class="number">0.98</span> (+/- <span class="number">0.03</span>)</div></pre></td></tr></table></figure>
<ol start="2" type="1">
<li><u>无监督学习</u><code>(unsupervised learning)</code></li>
</ol>
<p>无监督学习没有输入标签，一种常见的无监督学习就是数据聚类，在人工神经网络中，生成对抗网络<code>(GAN)</code>、自组织映射<code>(SOM)</code>和适应性共振理论<code>(ART)</code>则是最常用的无监督学习。在聚类中，主要有以下模型：</p>
<blockquote>
<p>BIRCH · Hierarchical clustering · k平均 · 期望最大化（EM）· DBSCAN · OPTICS · 均值飘逸(Mean shifit)</p>
</blockquote>
<p>现在我们来看些例子吧。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">%matplotlib inline</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns; sns.set()</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> KMeans</div><div class="line"></div><div class="line"><span class="keyword">from</span> sklearn.datasets.samples_generator <span class="keyword">import</span> make_blobs</div><div class="line">X, y_true = make_blobs(n_samples=<span class="number">300</span>, centers=<span class="number">4</span>,</div><div class="line">                      cluster_std=<span class="number">0.60</span>, random_state=<span class="number">0</span>)</div><div class="line">plt.scatter(X[:, <span class="number">0</span>], X[:, <span class="number">1</span>], s=<span class="number">50</span>)</div><div class="line"></div><div class="line">kmeans = KMeans(n_clusters=<span class="number">4</span>)</div><div class="line">kmeans.fit(X)</div><div class="line">y_kmeans = kmeans.predict(X)</div><div class="line"></div><div class="line">plt.scatter(X[:, <span class="number">0</span>], X[:, <span class="number">1</span>], c=y_kmeans, s=<span class="number">50</span>, cmap=<span class="string">'viridis'</span>)</div><div class="line"></div><div class="line">centers = kmeans.cluster_centers_</div><div class="line">plt.scatter(centers[:, <span class="number">0</span>], centers[:, <span class="number">1</span>], c=<span class="string">'black'</span>, s=<span class="number">200</span>, alpha=<span class="number">0.5</span>)</div></pre></td></tr></table></figure>
<p><img src="/images/download.png"><img src="/images/download-1.png"></p>
<ol start="3" type="1">
<li>回归和分类的比较</li>
</ol>
<p>在上面已经针对回归和分类有了一个比较通俗的解读：如果函数的输出是一个连续的数值，则称为回归分析。如果函数的输出是一个分类标签，则称为分类问题<code>(classification)</code>。</p>
<p>回归方法一览：</p>
<blockquote>
<p>SGD Regressor · Lasso · ElasticNet · RidgeRegression · SVR(kernel=‘linear’ · SVR(kernel=‘rbf’) · EnsembleRegressors</p>
</blockquote>
<p>分类方法一览：</p>
<blockquote>
<p>SGD Classifier · Linear SVC · KNeighbors Classifier · kernel approximation · SVC · Ensemble Classifiers · Naive Bayes</p>
</blockquote>
<h3 id="二overfitting与underfitting定义及解决方法">二、<code>overfitting</code>与<code>underfitting</code>定义及解决方法</h3>
<p><code>方差</code>：方差度量了同样大小的训练集变动所导致的学习性能变化，即刻画了数据扰动所造成的影响。</p>
<p><code>偏差</code>: 偏差度量了学习算法的期望预测真是结果的偏离程度，即刻画了学习算法本身的拟合能力。</p>
<p><code>噪声</code>: 噪声表达了在当前任务上任何学习算法所能达到的期望泛化误差的下界，即刻画了学习问题本身的难度。</p>
<h3 id="underfitting欠拟合"><u>underfitting欠拟合</u></h3>
<p><strong>定义</strong>：欠拟合指的是模型并没有很好地捕捉到数据特征，不能很好地拟合数据。</p>
<p><strong>特点</strong>：</p>
<ol type="1">
<li>模型的方差<code>variance</code>较小，预测输出和期望输出的差值较小</li>
<li>偏差<code>bias</code>较大，期望预测和真实值的差值较大</li>
<li>模型复杂度较小</li>
</ol>
<p><strong>解决方法</strong>：</p>
<ol type="1">
<li>添加其他特征项（可通过组合、泛化和相关性这三种手段）</li>
<li>添加多项式特征，增加模型复杂度</li>
<li>减少正则化参数，减少对复杂模型的惩罚</li>
<li>增加更多的数据</li>
</ol>
<h3 id="overfitting-过拟合"><u>overfitting 过拟合</u></h3>
<p><strong>定义</strong>：过拟合指的是模型对数据的太过拟合，对新的数据泛化能力较差</p>
<p><strong>特点</strong>：</p>
<ol type="1">
<li>模型的方差<code>variance</code>较大，预测输出和期望输出的差值较大</li>
<li>偏差<code>bias</code>一般较大，期望预测和真实值的差值一般较大</li>
<li>模型复杂度较大</li>
</ol>
<p><strong>解决方法</strong>：</p>
<ol type="1">
<li>重新清洗数据</li>
<li>增大数据的训练量</li>
<li>采用正则化</li>
<li>采用<code>Dropout</code>方法，在训练时让神经元以一定的概率不工作</li>
</ol>
<h3 id="三交叉验证cross-validation">三、交叉验证(cross validation)</h3>
<p>其实在上面的例子中， 我们已经使用了交叉验证。交叉验证直白地说就是为了验证模型的表现。学习预测函数的参数并且在相同的数据中测试它是一种错误的方法：因为只重复看到的样本标签的模型本身会有一个完美的表现，但它并不能预测任何有用的信息，对于未见过的数据，模型的泛化能力会非常差。这种情况称为过拟合。</p>
<p>为了避免这种情况，对于有监督学习，通常会将数据集划分为训练集和测试集，然后进行模型表现的评估。这种做法称为交叉验证。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> svm</div><div class="line"></div><div class="line">iris = datasets.load_iris()</div><div class="line">iris_X = iris.data</div><div class="line">iris_y = iris.target</div><div class="line"></div><div class="line">X_train, X_test, y_train, y_test = train_test_split(</div><div class="line">    iris_X, iris_y, test_size=<span class="number">0.4</span>, random_state=<span class="number">0</span></div><div class="line">)</div><div class="line"></div><div class="line">clf = svm.SVC(kernel=<span class="string">'linear'</span>, C=<span class="number">1</span>).fit(X_train, y_train)</div><div class="line">print(clf.score(X_test, y_test))</div><div class="line">[output]</div><div class="line"><span class="number">0.9666666666666667</span></div></pre></td></tr></table></figure>
<p>常见的交叉验证有：</p>
<ul>
<li>Holdout验证：随机从最初样本选取部分，形成交叉验证数据，而剩余的就当作训练数据。一般来说，少于原样本三分之一的数据被选作验证数据。</li>
<li>K-Fold交叉验证</li>
</ul>
<p>K次交叉验证，将训练集分割成K个子样本， 一个单独的子样本被保留作为验证模型的数据，其他K-1个样本用作训练。交叉验证重复K次，每个子样本验证一次。这种方法的优势在于，同时重复运用随机产生的子样本进行训练和验证，每次的结果验证一次，10次交叉验证是最常用的。</p>
<ul>
<li>留一验证（LOOCV）</li>
</ul>
<p>事实上这跟K-Fold是一样的，只不过这里的K是样本个数。</p>
<p>常见的误差估计：均方差和方根均方差。</p>
<h3 id="四模型评估指标精确率召回率f值rocauc">四、模型评估指标（精确率、召回率、F值、ROC、AUC）</h3>
<p>首先我们来看一张<code>sklearn</code>上模型评估指标。</p>
<p><img src="/images/Screen%20Shot%202018-05-19%20at%2012.41.31%20AM.png"></p>
<p>对于<strong><u>分类问题</u></strong>，一般使用<code>accuracy</code>、<code>f1</code>、<code>neg_log_loss</code>、<code>recall</code>和<code>roc_auc</code></p>
<ol type="1">
<li><code>recall</code>、<code>precision</code>、<code>accuracy</code>和<code>f1</code></li>
</ol>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">预测结果</th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>真实结果</strong></td>
<td style="text-align: center;">正例（Yes）</td>
<td style="text-align: center;">反例（No）</td>
</tr>
<tr class="even">
<td style="text-align: center;">正例（Yes）</td>
<td style="text-align: center;">TP</td>
<td style="text-align: center;">FN</td>
</tr>
<tr class="odd">
<td style="text-align: center;">反例（No）</td>
<td style="text-align: center;">FP</td>
<td style="text-align: center;">TN</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
\begin{aligned}
Precision\ \ (P)  &amp; = \frac {TP}{TP + FP} \\
\\
Recall\ \ (R) &amp; = \frac {TP}{TP + FN} \\
\\
F1 = \frac{2P \cdot R}{P + R} &amp; = \frac{2TP}{2TP+FP+FN} \\
\\
Accuracy &amp; = \frac{TP+TN}{TP+TN+FN+FP}
\end{aligned}
\]</span></p>
<ul>
<li><code>查准率(Precision)</code>: 指在所有预测为正例的情况中，预测正例且实际正例的比例。<code>查准率</code>关注的是预测正例正确占所有预测为正例情况的比例，白话文就是说，<code>查准率</code>关注的是你预测了一大堆正例的例子，然后里面有多少是预测正确的，就是准不准嘛。</li>
<li><code>查全率(Recall)</code>: 指在实际为正例的情况中，预测为正例的比例。白话文就是说，<code>查全率</code>关注的是你正确预测了一大堆正例，数量为A，真实情况下正例的数量是B，然后看B里面有多少比例的A，然后去判断预测正确的情况全不全。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> svm, datasets</div><div class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> average_precision_score, precision_recall_curve</div><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> precision_score, recall_score</div><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"></div><div class="line"></div><div class="line">iris = datasets.load_iris()</div><div class="line">X = iris.data</div><div class="line">y = iris.target</div><div class="line"></div><div class="line">random_state = np.random.RandomState(<span class="number">0</span>)</div><div class="line">n_samples, n_features = X.shape</div><div class="line">X = np.c_[X, random_state.randn(n_samples, <span class="number">200</span> * n_features)]</div><div class="line"></div><div class="line">X_train, X_test, y_train, y_test = train_test_split(X[y &lt; <span class="number">2</span>], y[y &lt; <span class="number">2</span>],</div><div class="line">                                                    test_size=<span class="number">.5</span>,</div><div class="line">                                                   random_state=random_state)</div><div class="line"></div><div class="line">clf = svm.LinearSVC(random_state=random_state)</div><div class="line">clf.fit(X_train, y_train)</div><div class="line">y_score = clf.decision_function(X_test)</div><div class="line"></div><div class="line">average_precision = average_precision_score(y_test, y_score)</div><div class="line">print(<span class="string">'Average precision-recall score: &#123;0:0.2f&#125;'</span>.format(average_precision))</div><div class="line">[output]</div><div class="line">Average precision-recall score: <span class="number">0.88</span></div><div class="line">    </div><div class="line">print(precision_score(y_test, clf.predict(X_test)))</div><div class="line">print(recall_score(y_test, clf.predict(X_test)))</div><div class="line">print(f1_score(y_test, clf.predict(X_test)))</div><div class="line">print(classification_report(y_test, clf.predict(X_test)))</div><div class="line">[output]</div><div class="line"><span class="number">0.75</span></div><div class="line"><span class="number">0.8076923076923077</span></div><div class="line"><span class="number">0.7777777777777779</span></div><div class="line"></div><div class="line">            precision    recall  f1-score   support</div><div class="line"></div><div class="line">          <span class="number">0</span>       <span class="number">0.77</span>      <span class="number">0.71</span>      <span class="number">0.74</span>        <span class="number">24</span></div><div class="line">          <span class="number">1</span>       <span class="number">0.75</span>      <span class="number">0.81</span>      <span class="number">0.78</span>        <span class="number">26</span></div><div class="line"></div><div class="line">avg / total       <span class="number">0.76</span>      <span class="number">0.76</span>      <span class="number">0.76</span>        <span class="number">50</span></div><div class="line"></div><div class="line"></div><div class="line">precision, recall, _ = precision_recall_curve(y_test, y_score)</div><div class="line">plt.step(recall, precision, color=<span class="string">'b'</span>, alpha=<span class="number">0.2</span>,</div><div class="line">        where=<span class="string">'post'</span>)</div><div class="line">plt.fill_between(recall, precision, step=<span class="string">'post'</span>, alpha=<span class="number">0.2</span>,</div><div class="line">                color=<span class="string">'b'</span>)</div><div class="line"></div><div class="line">plt.xlabel(<span class="string">'Recall'</span>)</div><div class="line">plt.ylabel(<span class="string">'Precision'</span>)</div><div class="line">plt.ylim([<span class="number">0.0</span>, <span class="number">1.05</span>])</div><div class="line">plt.xlim([<span class="number">0.0</span>, <span class="number">1.0</span>])</div><div class="line">plt.title(<span class="string">'2-class Precision-Recall curve: AP=&#123;0:0.2f&#125;'</span>.format(average_precision))</div></pre></td></tr></table></figure>
<p><img src="/images/download-2.png"></p>
<ul>
<li><code>准确率(Accuracuy)</code>: 对于给定的测试集数据，分类器正确分类的样本数与总样本之比。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score</div><div class="line">y_pred = [<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>]</div><div class="line">y_true = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</div><div class="line">print(accuracy_score(y_true, y_pred))</div><div class="line">[output]</div><div class="line"><span class="number">0.5</span></div></pre></td></tr></table></figure>
<ol start="2" type="1">
<li><code>ROC</code>和<code>AUC</code></li>
</ol>
<p><strong><u>ROC(Receiver operating characteristic)和AUC(Area Under ROC Curve)</u></strong></p>
<p>ROC曲线是二值分类器常用的工具，是反映敏感性和特异性连续变量的综合指标，roc曲线上每个点反映着对同一信号刺激的感受性。</p>
<p>它跟<code>precision/recall</code>曲线非常相似，只不过ROC曲线描绘的是TPR(True Positive Rate，Recall另一种叫法)和FPR(False Positive Rate)的关系。</p>
<p>在我看来，ROC曲线更多的描述多个模型的性能比较，如果一个模型A的ROC曲线被另一个模型B的ROC包围，那很明显另外一个模型B的表现优于模型A。因此比较ROC曲线下的面积，即AUC(Area Under ROC Curve) <span class="math display">\[
\begin{aligned}
Recall\ \ (R) &amp; = TPR =  \frac {TP}{TP + FN} \\
\\
FPR  &amp;= \frac{FP}{FP + TN} \\\\
&amp;= 1 - TNR  \\\\ 
&amp; = 1 - \frac{TN}{FP+TN} \\\\
&amp;= 1-specificity
\end{aligned}
\]</span> ROC曲线有个很好的特性：当测试集中的正负样本的分布变换的时候，ROC曲线能够保持不变。在实际的数据集中经常会出现样本类不平衡，即正负样本比例差距较大，而且测试数据中的正负样本也可能随着时间变化。</p>
<p>理想情况下，TPR应该接近1，FPR应该接近0。故ROC曲线越靠拢(0,1)点，越偏离45度对角线越好，Sensitivity、Specificity越大效果越好。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> roc_curve</div><div class="line">fpr, tpr, thresholds = roc_curve(y_test, clf.predict(X_test))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_roc_curve</span><span class="params">(fpr, tpr, label=None)</span>:</span></div><div class="line">    plt.plot(fpr, tpr, linewidth=<span class="number">2</span>, label=label)</div><div class="line">    plt.plot([<span class="number">0</span>, <span class="number">1</span>], [<span class="number">0</span>, <span class="number">1</span>], <span class="string">'k--'</span>)</div><div class="line">    plt.axis([<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>])</div><div class="line">    plt.xlabel(<span class="string">'False Positive Rate'</span>)</div><div class="line">    plt.ylabel(<span class="string">'True Positive Rate'</span>)</div><div class="line">    </div><div class="line">plot_roc_curve(fpr, tpr)</div><div class="line">plt.show()</div></pre></td></tr></table></figure>
<p><img src="/images/download-3.png"></p>
<p>对于<u>回归问题</u>，一般使用<code>explained_variance_score</code>、<code>Mean squared error</code>、<code>neg_mean_squared_log_error</code></p>
<ol type="1">
<li><code>Explained_variance_score</code></li>
</ol>
<p>最好的表现是1， 数值越低表现越差 <span class="math display">\[
explained_variance(y,  \hat y) = 1- \frac{Var\{y - \hat y\}}{Var\{y\} }
\]</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> explained_variance_score</div><div class="line">y_true = [<span class="number">3</span>, <span class="number">-0.5</span>, <span class="number">2</span>, <span class="number">7</span>]</div><div class="line">y_pred = [<span class="number">2.5</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">8</span>]</div><div class="line">print(explained_variance_score(y_true, y_pred))</div><div class="line">[output]</div><div class="line"><span class="number">0.9571734475374732</span></div></pre></td></tr></table></figure>
<ol start="2" type="1">
<li><code>Mean squared error(MSE)</code></li>
</ol>
<p>MSE越小，模型拟合表现越好。 <span class="math display">\[
MSE(y, \hat y) = \frac{1}{n_{samples}} \sum^{n_{samples} - 1}_{i=0} \ \ (y_i - \hat y_i) ^ 2
\]</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error</div><div class="line">y_true = [<span class="number">3</span>, <span class="number">-0.5</span>, <span class="number">2</span>, <span class="number">7</span>]</div><div class="line">y_pred = [<span class="number">2.5</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">8</span>]</div><div class="line">print(mean_squared_error(y_true, y_pred))</div><div class="line">[output]</div><div class="line"><span class="number">0.375</span></div></pre></td></tr></table></figure>
<ol start="3" type="1">
<li><code>Mean_squared_log_error(MSLE)</code></li>
</ol>
<p>MSLE越小，模型拟合表现越好。当两个数值都是巨大数字时，如果不想惩罚巨大的差异，就可以使用它。当具有指数增长的目标（如人口数量，商品在一定年限内的平均销售额等）时，最好使用此度量标准。请注意，此度量标准对低于预测的估算值的惩罚高于超出预测的估算值。 <span class="math display">\[
MSLE(y, \hat y) = \frac{1}{n_{samples}} \sum_{i=0}^{n_{samples}-1} (log_e(1+y_i) - log_e(1 + \hat y_i))^ 2
\]</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_log_error</div><div class="line">y_true = [<span class="number">3</span>, <span class="number">5</span>, <span class="number">2.5</span>, <span class="number">7</span>]</div><div class="line">y_pred = [<span class="number">2.5</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">8</span>]</div><div class="line">print(mean_squared_log_error(y_true, y_pred))</div><div class="line">[output]</div><div class="line"><span class="number">0.0397</span></div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/07/TF-IDF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彼得的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/04/07/TF-IDF/" itemprop="url">
                  TF-IDF
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-07T16:25:17+08:00">
                2018-04-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Machine-learning/" itemprop="url" rel="index">
                    <span itemprop="name">Machine_learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近在聚类分析中用<code>TF-IDF</code>特别多。然后今天上了一个<code>NLP</code>的课程，觉得老师把<code>TF-IDF</code>讲得非常简单易懂。下面我就来梳理一下<code>TF-IDF</code>吧。</p>
<p>首先，我们在处理一句话的时候，我们应该是希望有以下两点：</p>
<ol type="1">
<li>对于关键词而言，其具有较强的标示性</li>
<li>对于关键词而言，停用词应该自动排除</li>
</ol>
<p>而<code>TF-IDF</code>有以下好处：</p>
<ul>
<li>可以查询关键词</li>
<li><code>TF-IDF</code>其实表示的是每个单词的重要性，<code>TF-IDF</code>倾向于过滤掉常见的词语，保留重要的词语。也就是说，字词的重要性随着它在文件中出现的次数成正比增加，但同时会随着它在语料库中出现的频率成反比下降。</li>
<li>可以为每个文章，句子建模。</li>
</ul>
<p><code>TF-IDF</code>分为两个部分：</p>
<ul>
<li><p>一个是<code>TF(Term Frequency)</code> <span class="math display">\[
tf = \frac{Term_{num}}{Word_{num}}
\]</span> ​</p></li>
<li><p>一个是<code>IDF(inverse document frequency)</code>。</p>
<ul>
<li><code>log(D/D_w)</code>; <code>D_w</code> is all the related documents. 而在这里为什么用<code>log</code>，我认为是为了抑制高频词汇的重要性。 <span class="math display">\[
idf = log(\frac{D_{all}}{D_w})
\]</span></li>
</ul></li>
</ul>
<p><span class="math display">\[
tfidf = tf \cdot idf
\]</span></p>
<p>那么下面我们就可以来手写一个<code>TF-IDF</code>了。当然，<code>sklearn</code>里面就有<code>TF-IDF</code>的<code>API</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> jieba</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</div><div class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</div><div class="line"><span class="keyword">import</span> operator <span class="keyword">as</span> op</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">cut</span><span class="params">(string)</span>:</span> <span class="keyword">return</span> jieba.cut(string)</div><div class="line"></div><div class="line"><span class="comment"># 统计每个分词在某一特定文档的频率</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">term_frequency</span><span class="params">(word, i)</span>:</span></div><div class="line">    words = cut(content.iloc[i].content)</div><div class="line">    word_counts = Counter(words)</div><div class="line">    <span class="keyword">return</span> word_counts[word] / sum(word_counts.values())</div><div class="line"></div><div class="line"><span class="comment"># 统计前n篇文章中的分词出现次数，然后返回一个列表</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">documents_words_counter</span><span class="params">(docu_num)</span>:</span></div><div class="line">    <span class="keyword">return</span> [Counter(cut(str(content.iloc[i].content))) <span class="keyword">for</span> i <span class="keyword">in</span> range(docu_num)]</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">inverse_document_frequency</span><span class="params">(word)</span>:</span></div><div class="line">    <span class="keyword">return</span> np.log(len(documents_words_counter(docu_num) / sum(<span class="number">1</span> <span class="keyword">for</span> counter <span class="keyword">in</span> documents_words_counter <span class="keyword">if</span> word <span class="keyword">in</span> counter)))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">tfidf</span><span class="params">(word, i)</span>:</span> <span class="keyword">return</span> term_frequency(word, i) * inverse_document_frequency(word)</div><div class="line"></div><div class="line"><span class="comment"># 然后我们用tfidf的结果，去表示一个文档，然后去判断两个文档的相似性。</span></div><div class="line"><span class="comment"># words ==&gt; vector ==&gt; 意思相似程度</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">doc_vec</span><span class="params">(w, i)</span>:</span></div><div class="line">    all_words_counter = reduce(op.add, documents_words_counter(docu_num)):</div><div class="line">    <span class="keyword">return</span> [tfidf(w, <span class="number">1</span>) <span class="keyword">for</span> w <span class="keyword">in</span> all_words_counter]</div><div class="line"></div><div class="line"><span class="comment"># scikit-learn的Example用法</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> TfidfVectorizer</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>X = TfidfVectorizer().fit_transform(sequnece)</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/22/Ensemble-Learning/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彼得的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/03/22/Ensemble-Learning/" itemprop="url">
                  Ensemble Learning
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-22T20:32:11+08:00">
                2018-03-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Machine-Learning/" itemprop="url" rel="index">
                    <span itemprop="name">Machine Learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>集成学习<code>(Ensemble Learning)</code>本身不是一个单独的机器学习算法，而是通过构建并结合多个机器学习器来完成学习任务。集成学习可以用于分类问题集成、回归问题集成、特征选取集成、异常点检测集成等。集成算法的目的是根据某个算法组合多个基础模型的预测值从而提高模型的泛化能力。</p>
<p>主要有两种方法：</p>
<ul>
<li><code>Averaging方法</code>：个体学习器之间不存在强依赖关系，一系列个体学习器可以并行生成，基本上是独立的建多个模型然后对它们的预测结果做平均，从而降低泛化误差。代表算法是<code>bagging(boostrap aggregating)</code>和<code>随机森林(random forest)</code>。</li>
<li><code>Boosting方法</code>：个体学习器之间存在强依赖关系，一系列个体学习器基本都需要串行生成，是有序列的、有依赖的建立多个基模型，后一个模型用来修正上一个模型的bias。代表算法是<code>boosting</code>系列算法。</li>
</ul>
<p><img src="/images/Screen%20Shot%202018-03-22%20at%208.48.18%20PM.png"></p>
<h3 id="一集成学习之结合策略"><u>一、</u>集成学习之结合策略</h3>
<h3 id="平均法"><u>平均法</u></h3>
<p>对于数值类的回归预测问题，通常使用的结合策略是平均法，也就是说，对于若干弱学习器的输出进行平均得到最终的预测输出。</p>
<p>最简单的平均是算术平均。 <span class="math display">\[
H(x) = \frac{1}{T}\sum_1^{T}h_i(x)
\]</span> 如果每个个体学习器有一个权重<code>w</code>，则最终预测是 <span class="math display">\[
\begin{aligned}
H(x) &amp;= \sum_{i=1}^{T}w_ih_i(x) \\\\
w_i &amp; \ge 0, \ \ \  \sum_{i=1}^{T}w_i = 1
\end{aligned}
\]</span></p>
<h3 id="投票法"><u>投票法</u></h3>
<p>对于分类问题的预测，通常使用的是投票法。假设预测类别是<code>{C1, C2, ..., Ck}</code>，对于任意一个预测样本x，我们的T个弱学习器的预测结果分别是<code>(h1(x), h2(x), ..., hT(x))</code></p>
<p>最简单的投票法是相对多数投票法，也就说T个弱学习器的对样本x的预测结果中，数量最多的类别ci为最终的分类类别。如果不止一个类别获得最高票，则随机选择一个做最终类别。</p>
<p>而我们可以在投票总数上加限制，也就是绝对多数投票法，在相对多数投票法的基础上，不光要求获得最高票，还要求票过半数，否则会拒绝预测结果。</p>
<p>更加复杂的就是加权投票法，类似加权平均法一样，每个弱学习器的分类票数要乘以一个权重，最终将各个类别的加权票数求和，最大的值的对应的类别为最终类别。</p>
<h3 id="学习法"><u>学习法</u></h3>
<p>对弱学习器的结果做平均或者投票相对比较简单，但学习误差较大。所以才有了学习法。学习发的代表是<code>stacking</code>。但使用<code>stacking</code>的结合策略时，我们不是对弱学习器的结果做简单的逻辑处理，而是再加上一层学习器，也就是说我们将训练集弱学习器的学习结果作为输入，将训练集的输出作为输出，重新训练一个学习器来得到最终结果。</p>
<p>在这种情况下，我们将弱学习器成为初级学习器，将用于结合的学习器称为次级学习器。对于测试集，首先用初级学习器预测一次，结果为次级学习器的输入样本，再用次级学习器预测一遍，得到最终的预测结果。</p>
<p><img src="/images/Screen%20Shot%202018-03-10%20at%206.24.38%20PM.png"></p>
<h3 id="二集成方法"><u>二、集成方法</u></h3>
<h3 id="bagging"><u>Bagging</u></h3>
<p><img src="/images/Screen%20Shot%202018-03-22%20at%209.23.32%20PM.png"></p>
<p><code>随机采样(bootstrap)</code>就是从我们的训练集里面采集固定个数的样本，但是每采集一个样本后，都将样本放回。也就是说，之前采集到的样本在放回后有可能继续被采集到。对于<code>Bagging</code>算法，一般会随机采集和训练样本数m一样个数的样本。这样得到的采样集和训练集样本的个数相同，但是样本内容不同。如果我们对有m个样本训练集做T次的随机采样，则由于随机性，T个采样集各不相同。</p>
<p>在每次抽样中，每个样本都可能会有<code>36.8%</code>的概率没有被抽中，所以我们可以设置<code>oob_score=True</code>来用训练好的模型去预测这部分没有被抽取的数据，评判模型的好坏，这样就不会浪费数据集。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sklearn.ensemble.BaggingClassifier(base_estimator=<span class="keyword">None</span>, n_estimators=<span class="number">10</span>, max_samples=<span class="number">1.0</span>, </div><div class="line">                                   max_features=<span class="number">1.0</span>, bootstrap=<span class="keyword">True</span>, bootstrap_features=<span class="keyword">False</span>, </div><div class="line">                                   oob_score=<span class="keyword">False</span>, warm_start=<span class="keyword">False</span>, n_jobs=<span class="number">1</span>, random_state=<span class="keyword">None</span>, </div><div class="line">                                   verbose=<span class="number">0</span>)</div></pre></td></tr></table></figure>
<ul>
<li><p>算法</p>
<p>输入：样本集D，弱学习器算法，弱分类器迭代次数T。</p>
<p>输出：最终的强分类器<code>f(x)</code></p>
<ol type="1">
<li>对于t=1, 2, …, T，对训训练集进行第t次随机采样，共采集m次，得到包含m个样本的采样集Dm。然后用采样集Dm训练第m个弱学习器Gm(x)</li>
<li>如果是分类算法预测，则T个弱学习器投出最多票数的类别或类别之一为最终类别。如果是回归算法，T个弱学习器得到的回归结果进行算术平均得到的值为最终的模型输出。</li>
</ol></li>
</ul>
<h3 id="随机森林"><u>随机森林</u></h3>
<p><code>随机森林</code>是<code>bagging</code>的一个特化进阶版，也就是说随机森林的弱学习器都是<code>CART决策树</code>，而且随机森林在<code>bagging</code>的样本随机采样基础上，又加上了特征的随机选择。随机森林通过随机选择节点上的一部分样本特征，这个数字小于n，假设为n_sub，然后在这些随机选择的n_sub个样本特征中，选择一个最优特征来做决策树的左右子树划分，这样进一步增强了模型的泛化能力。</p>
<p>如果n_sub=n，则此时随机森林的CART决策树和普通CART决策树没有区别，n_sub越小，则模型越健壮，但对训练集的拟合程度越差。也就是说，n_sub越小，模型的方差会减小，也就是说预测值和预测值的期望值的差越小，数据扰动造成的影响较小，但是偏差会越大，也就是说期望预测和真实标记的误差越大，也就是说学习算法本身的拟合能力越差。换句话说，就是模型过于简单了。</p>
<p>这个时候一般会通过<code>cross validation</code>调参获取一个合适的n_sub值。</p>
<ul>
<li><p>算法</p>
<p>输入：样本集D，弱学习器算法，弱分类器迭代次数T。</p>
<p>输出：最终的强分类器<code>f(x)</code></p>
<ol type="1">
<li>对于t=1, 2, …, T，对训训练集进行第t次随机采样，共采集m次，得到包含m个样本的采样集Dm。用采样集Dm训练第m个决策树模型Gm(x)，在训练决策树模型的节点时候，在节点上所有的样本特征中选择一部分样本特征，在这些随机选择的部分样本特征中选择一个最优的特征来做决策树的左右子树划分</li>
<li>如果是分类算法预测，则T个弱学习器投出最多票数的类别或者类别之一为最终类别。如果是回归算法，T个弱学习器得到的回归结果进行算术平均得到的值为最终的模型输出。</li>
</ol></li>
<li><p>优点</p></li>
</ul>
<ol type="1">
<li>训练可以高度并行化，具有速度优势</li>
<li>由于可以随机选择决策树节点划分特征，这样在样本特征维度很高时候，仍然能够高效的训练模型。</li>
<li>在训练后，可以给出各个特征对于输出的重要性。</li>
<li>由于采用了随机采样，训练出的模型方差小，泛化能力强</li>
<li>实现比较简单</li>
<li>对部分特征不敏感</li>
</ol>
<ul>
<li>缺点</li>
</ul>
<ol type="1">
<li>在某些噪音比较大的样本集上，随机森林模型容易过拟合</li>
<li>取值划分比较多的特征容易对随机森林的决策产生更大的影响</li>
</ol>
<h3 id="boosting"><u>Boosting</u></h3>
<p><img src="/images/Screen%20Shot%202018-03-22%20at%2010.31.01%20PM.png"></p>
<p>从图上可以看出，<code>Boosting</code>算法的工作机制是首先从训练集用初始权重训练出一个弱分析器1，根据弱学习器的学习误差率表现来更新训练样本的权重，使得之前弱学习器1学习误差率高的训练样本点的权重变高，使得这些误差率高的点在后面的弱学习器2中得到更多的重视。然后基于调整权重后的训练集来训练学习器2.如此重复进行，直到弱学习器数达到事先指定的数目T，最终将这T个弱学习器通过集合策略进行整合，得到最终的强学习器。</p>
<p><code>Boosting</code>系列算法里最著名算法主要有<code>AdaBoost</code>算法提升树(<code>boosting tree</code>)系列算法。提升树系列最广泛的是梯度提升树(<code>Gradient Boosting Tree</code>)。</p>
<p>Boosting算法中要解决四个问题：</p>
<ol type="1">
<li>如何计算学习误差率e</li>
<li>如何得到弱学习器权重系数a</li>
<li>如何更新样本权重D</li>
<li>使用何种结合策略</li>
</ol>
<h3 id="boostingadaboostadaptive-boosting">Boosting——<u>AdaBoost</u>(Adaptive Boosting)</h3>
<p>假设给定一个二元分类的训练集数据集 <span class="math display">\[
T = {(x_1, y_1), (x_2, y_2), ..., (x_m, y_m)}
\]</span></p>
<ul>
<li><p>算法</p>
<p>输入：训练数据集T</p>
<p>输出：最终分类器G(x)</p></li>
</ul>
<ol type="1">
<li>初始化训练集在第k个弱学习器的权重分布</li>
</ol>
<p><span class="math display">\[
D(k)=(w_{l1}, w_{l2}, ..., w_{lN}); \ \ \ \ w_{li}=\frac{1}{N};\ \ \ \ \  i= 1, 2, ..., N
\]</span></p>
<ol start="2" type="1">
<li><p>对m=1, 2, …, M</p>
<ul>
<li><p>使用具有权值分布Dm的训练数据集学习，得到基本分类器 <span class="math display">\[
G_m(x) :\mathcal{X} \to \{-1, +1\}
\]</span></p></li>
<li><p>计算Gm(x)在训练数据集上的分类误差率。第m个弱分类器Gm(x)在训练集上的加权误差率为</p></li>
</ul>
<p><span class="math display">\[
e_k = P(G_m(x_i) \neq y_i) = \sum_{i=1}^{m}w_{mi}I \ \ \ (G_m(_i)\neq y_i)
\]</span></p>
<p>​</p>
<ul>
<li><p>计算<code>弱分类器Gm(x)的权重系数</code> <span class="math display">\[
\alpha_k = \frac{1}{2}log\frac{1- e_k}{e_k}
\]</span> 从上式可以看出，如果分类误差ek越大，则对应的<code>弱分类器权重ak</code>越小。也就是说，误差率小的<code>弱分类器权重系数</code>越大。</p></li>
<li><p>更新样本权重D，假设第k个弱分类器的样本集权重系数为 <span class="math display">\[
D(k)=(w_{k1}, w_{k2}, ..., w_{km})
\]</span> 则对应的第k+1个弱分类器的样本集权重系数为 <span class="math display">\[
\begin{aligned}
w_{k+1, i} &amp; = \begin{cases}
\frac{w_{ki}}{Z_k}e^{-\alpha_m}, \ \ \ \ G_m(x_i) = y_i\\[2ex]
\frac{w_{ki}}{Z_k}e^{\alpha_m}, \ \ \ \ G_m(x_i) \neq y_i
\end{cases}\\\\
  &amp; Z 为规范化因子 \\\\
Z_k &amp;= \sum_{i=1}^{m}w_{ki}exp(-\alpha_ky_iG_k(x_i))
\end{aligned}
\]</span> 从<code>w_{k+1, i}</code>计算公式可以看出，如果第i个样本分类错误，则yiGk(xi)&lt;0, 导致样本的权重在第k+1个弱分类器中增大，如果分类正确，则样本权重在第k+1个弱分类器中减少</p></li>
</ul></li>
<li><p>构建基本分类器的线性组合。<code>AdaBoost</code>采用的是加权平均法，最终的强分类器为 <span class="math display">\[
G(x) = sign(f(x)) = sign(\sum_{m=1}^{M}\alpha_mG_m(x))
\]</span> ​</p></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/17/KNN/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彼得的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/02/17/KNN/" itemprop="url">
                  K-Nearest Neighbor
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-17T01:38:56+08:00">
                2018-02-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><code>KNN(k-nearest neighbor)</code>应该是分类和回归算法里面最简单的一个了。这个笔记主要分享下<code>KNN</code>以及<code>KD树</code>。</p>
<p><code>k近邻法</code>假设给定一个训练数据集，其中的实例类别已定。分类时，对新的实例，根据其k个最近邻的训练实例的类别，通过多数表决等方式进行预测。因此，<code>k近邻法</code>不具有显式的学习过程。<code>k近邻法</code>实际上利用训练数据集对特征向量空间进行划分，并作为其分类的“模型”。</p>
<p><code>k值的选择</code>、<code>距离度量</code>及<code>分类决策规则</code>是<code>k近邻法</code>的三个基本要素。</p>
<h2 id="距离度量"><u>距离度量</u></h2>
<p>特征空间中两个实例点的距离是两个实例点相似程度的反映。</p>
<p>设特征空间是n维实数向量空间R^n， 其中 <span class="math display">\[
\begin{aligned}
&amp; x_i, x_j \in \mathcal{X} \\
\\
&amp; x_i = (x_i^{(1)}, x_i^{(2)},  ... , x_i^{(n)})^T \\
\\
&amp; x_j = (x_j^{(1)}, x_j^{(2)},  ... , x_j^{(n)})^T \\
\end{aligned}
\]</span> 因此，<code>x_i</code>, <code>x_j</code>的<code>L_p</code>距离定义为 <span class="math display">\[
L_p(x_i, x_j)  = \Biggl( \sum_{i=1}^n|x_i^{(l)} - x_j^{(l)}|^p \Biggr)^{\frac {1}{p}}, \ \ \ p \ge1
\]</span> 当<code>p=2</code>， 称为<code>欧式距离(Euclidean distance)</code>， 即 <span class="math display">\[
L_2(x_i, x_j)  = \Biggl( \sum_{i=1}^n|x_i^{(l)} - x_j^{(l)}|^2 \Biggr)^{\frac {1}{2}}
\]</span> 当<code>p=1</code>， 称为<code>曼哈顿距离(Manhattan distance)</code>， 即 <span class="math display">\[
L_1(x_i, x_j)  = \sum_{i=1}^n|x_i^{(l)} - x_j^{(l)}|
\]</span> 当<code>p=∞</code>，它是各个坐标距离的最大值，即 <span class="math display">\[
L_\infty(x_i, x_j)  = \max_{l}|x_i^{(l)} - x_j^{(l)}|
\]</span></p>
<h2 id="k值的选择"><u>k值的选择</u></h2>
<p>如果选择较小的k值，就相当于用较小的领域中的训练实例进行预测。“学习”的<code>近似误差(approximation error)</code>会减少，只有与输入实例较近的训练实例才会对预测结果起作用。但“学习”的<code>估计误差(estimation error)</code>会增大。k值的减小意味着整体模型变得复杂，容易发生过拟合。</p>
<p>如果选择较大的k值，相当于用较大领域中的训练实例进行预测，整体模型变得简单，“学习”的<code>估计误差(estimation error)</code>会减少，但是“学习”的<code>近似误差(approximation error)</code>会增大。</p>
<p>在应用中，k值一般取一个比较小的值，通常采用交叉验证法来选取最优的k值。</p>
<h2 id="k近邻法的实现kd树"><u>k近邻法的实现：kd树</u></h2>
<p>实现<code>k近邻法</code>时，主要考虑的问题是如何对训练数据进行快速k近邻搜索。其中比较高效的方法是<code>kd树</code>。</p>
<p><code>kd树</code>是二叉树，表示对k维空间的一个划分。构造<code>kd树</code>的过程就是不断地对第l维<code>(l={1, 2, ..., p})</code>维取中位数的过程，中位数对应的对象就是二叉树中的结点。</p>
<h3 id="构造平衡kd树"><u>构造平衡kd树</u></h3>
<p>首先给出伪代码：</p>
<ol type="1">
<li>历遍所有维度，找到方差最大的维度</li>
<li>以这个维度上的点的数值进行排序，找到其中间点</li>
<li>以这个点为划分，递归建立左子树</li>
<li>以这个点为划分，递归建立右子树</li>
<li>当数据集内没有点时，退出函数</li>
</ol>
<p>这里给出<code>两个重要概念</code>：</p>
<ul>
<li><p>以方差最大维度为划分的维度：方差越大，代表着这个维度上的数据波动越大，代表着以这个维度划分数据，可以最广泛的把数据集分开</p></li>
<li><p>取中位点为划分点，有助有构造一个平衡二叉树，不至于出现二叉树有时候会出现的极端，即是一个父节点只有一个孩子节点，使树的深度大大加深，增加搜索的复杂度。</p></li>
</ul>
<p><code>输入</code>： k维空间的数据集<code>T={x1, x2, ..., xN}</code></p>
<p>其中<code>x_i = (xi1, xi2, ..., xik)^T</code>, i = 1, 2, … , N</p>
<p><code>输出</code>： kd树</p>
<ol type="1">
<li><p>开始：选择根结点。</p>
<ul>
<li><p>选择<code>x^(1)</code>为坐标轴，以T中所有实例的<code>x^1</code>坐标的中位数为切分点，将根结点对应的超矩形区域切分为两个子区域，切分由通过切分点并与坐标轴<code>x^1</code>垂直的超平面实现。</p></li>
<li><p>由根结点生成深度为1的左、右子结点：左子结点对应坐标<code>x^(i)</code>小于切分点的子区域，右子结点对应于坐标<code>x^(i)</code>大于切分点的子区域。</p></li>
</ul></li>
<li><p>重复：</p>
<ul>
<li>对深度为<code>j</code>的结点，选择<code>x^(l)</code>为切分的坐标轴，<code>l=j(modk)+1</code>。以该结点的区域中所有实例的<code>x^(l)</code>坐标的中位数为切分点，将该节点对应的矩形区域切分为两个子区域。切分由通过切分点并与坐标轴<code>x^(l)</code>垂直的超平面实现。</li>
<li>由根结点生成深度为<code>j+1</code>的左、右子结点：左子结点对应坐标<code>x^(l)</code>小于切分点的子区域，右子结点对应于坐标<code>x^(l)</code>大于切分点的子区域。</li>
</ul></li>
<li><p>直到两个子区域没有实例存在时停止。从而形成<code>kd树</code>的划分。</p></li>
</ol>
<h3 id="查找k个最小值"><u>查找K个最小值</u></h3>
<ol type="1">
<li>若该节点是叶子结点，则返回</li>
<li>若不是叶子结点，则比较待预测节点与该节点被划分的维度上的值，若小于，则去其左子树。</li>
<li>若不是叶子结点，则比较待预测节点与该节点被划分的维度上的值，若大于，则去其右子树。</li>
</ol>
<p>我们用一个k大小的优先队列来存储k个节点的值：</p>
<ol type="1">
<li>若队列的长度不满k个，则把当前节点入队，并且去该父节点的另外一个子节点比较。</li>
<li>若已经满了k个，则取距离最长的节点，计算其距离，设为k。在计算预测结点到该节点的父节点的所划分的维度的距离，设为d。如K&gt;d，则去改父节点的另一个子节点查找。否则，继续回退到该节点的父节点的父节点。</li>
</ol>
<p>然后我们来看看如何用代码来实现。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 首先写一个简单的KNN。</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> operator</div><div class="line"><span class="keyword">from</span> os <span class="keyword">import</span> listdir</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">createDataSet</span><span class="params">()</span>:</span></div><div class="line">    group = np.array([[<span class="number">1.0</span>, <span class="number">1.1</span>], [<span class="number">1.0</span>, <span class="number">1.0</span>], [<span class="number">0</span>, <span class="number">0</span>],[<span class="number">0</span>, <span class="number">0.1</span>]])</div><div class="line">    labels = [<span class="string">'A'</span>, <span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'B'</span>]</div><div class="line">    <span class="keyword">return</span> group, labels</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">knn</span><span class="params">(inX, dataSet, labels, k)</span>:</span></div><div class="line">	dataSetSise = dataSet.shape[<span class="number">0</span>]</div><div class="line">	diffMat = np.tile(inX, (dataSetSise, <span class="number">1</span>)) - dataSet</div><div class="line">	sqDiffMat = diffMat ** <span class="number">2</span></div><div class="line">	sqDistances = sqDiffMat.sum(axis=<span class="number">1</span>)</div><div class="line">	distances = sqDistances ** <span class="number">0.5</span></div><div class="line">	sortedDistIndices = distances.argsort()</div><div class="line">	classCount = &#123;&#125;</div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(k):</div><div class="line">		voteIlabel = labels[sortedDistIndices[i]]</div><div class="line">		classCount[voteIlabel] = classCount.get(voteIlabel, <span class="number">0</span>) + <span class="number">1</span></div><div class="line">	sortedDistIndices = sorted(classCount.items(), key=operator.itemgetter(<span class="number">1</span>), reverse=<span class="keyword">True</span>)</div><div class="line">	<span class="keyword">return</span> sortedDistIndices[<span class="number">0</span>][<span class="number">0</span>]</div><div class="line"></div><div class="line">dataSet, labels = createDataSet()</div><div class="line">print(knn([<span class="number">0</span>, <span class="number">0</span>], dataSet, labels, <span class="number">3</span>))</div><div class="line"></div><div class="line">[output]</div><div class="line">B</div><div class="line"></div><div class="line"><span class="comment"># 下面就是kd树。</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">KD_node</span><span class="params">(object)</span>:</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, point=None, split=None, LL=None, RR=None)</span>:</span></div><div class="line">		self.point = point</div><div class="line">		self.split = split</div><div class="line">		self.left = LL</div><div class="line">		self.right = RR</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">createKDTree</span><span class="params">(root, data_list)</span>:</span></div><div class="line">	length = len(data_list)</div><div class="line">	<span class="keyword">if</span> length == <span class="number">0</span>:</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span></div><div class="line">	dimension = len(data_list[<span class="number">0</span>])</div><div class="line">	max_var = <span class="number">0</span></div><div class="line">	split = <span class="number">0</span></div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(dimension):</div><div class="line">		l1 = []</div><div class="line">		<span class="keyword">for</span> t <span class="keyword">in</span> data_list:</div><div class="line">			l1.append(t[i])</div><div class="line">		var = computeVariance(l1)</div><div class="line">		<span class="keyword">if</span> var &gt; max_var:</div><div class="line">			max_var = var</div><div class="line">			split = i</div><div class="line"></div><div class="line">	data_list = sorted(data_list, key=<span class="keyword">lambda</span> x: x[split])</div><div class="line">	point = data_list[int(length/<span class="number">2</span>)]</div><div class="line">	root = KD_node(point, split)</div><div class="line">	root.left = createKDTree(root.left, data_list[<span class="number">0</span>:int(length/<span class="number">2</span>)])</div><div class="line">	root.right = createKDTree(root.right, data_list[int(length/<span class="number">2</span>)+<span class="number">1</span>:length])</div><div class="line">	<span class="keyword">return</span> root</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">computeVariance</span><span class="params">(arrayList)</span>:</span></div><div class="line">	arrayList = np.array(arrayList)</div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(arrayList)):</div><div class="line">		arrayList[i] = float(arrayList[i])</div><div class="line">	length = len(arrayList)</div><div class="line">	sum1 = arrayList.sum()</div><div class="line">	array2 = arrayList * arrayList</div><div class="line">	sum2 = array2.sum()</div><div class="line">	mean = sum1 / length</div><div class="line">	variance = sum2 / length - mean ** <span class="number">2</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">computerDistance</span><span class="params">(pt1, pt2)</span>:</span></div><div class="line">	sum = <span class="number">0.0</span>;</div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(pt1)):</div><div class="line">		sum += (pt1[i] - pt2[i]) ** <span class="number">2</span></div><div class="line">	<span class="keyword">return</span> sum ** <span class="number">0.5</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">findNN</span><span class="params">(root, query, k)</span>:</span></div><div class="line">	min_dist = computerDistance(query, root.point)</div><div class="line">	node_k = []</div><div class="line">	nodeList = []</div><div class="line">	temp_root = root</div><div class="line">	<span class="keyword">while</span> temp_root:</div><div class="line">		nodeList.append(temp_root)</div><div class="line">		dd = computerDistance(query, temp_root.point)</div><div class="line">		<span class="keyword">if</span> len(node_k) &lt; k:</div><div class="line">			node_k.append(dd)</div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			max_dist = max(node_k)</div><div class="line">			<span class="keyword">if</span> dd &lt; max_dist:</div><div class="line">				index = node_k.index(max_dist)</div><div class="line">				<span class="keyword">del</span>(node_k[index])</div><div class="line">				node_k.append(dd)</div><div class="line">		ss = temp_root.split</div><div class="line">		<span class="keyword">if</span> query[ss] &lt;= temp_root.point[ss]:</div><div class="line">			temp_root = temp_root.left</div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			temp_root = temp_root.right</div><div class="line">	print(<span class="string">'node_k: '</span>, node_k)</div><div class="line"></div><div class="line">	<span class="keyword">while</span> nodeList:</div><div class="line">		back_point = nodeList.pop()</div><div class="line">		ss = back_point.split</div><div class="line">		max_dist = max(node_k)</div><div class="line">		<span class="keyword">if</span> len(node_k) &lt; k <span class="keyword">or</span> abs(query[ss] - back_point.point[ss]) &lt; max_dist:</div><div class="line">			<span class="keyword">if</span> query[ss] &lt;= back_point.point[ss]:</div><div class="line">				temp_root = back_point.right</div><div class="line">			<span class="keyword">else</span>:</div><div class="line">				temp_root = back_point.left</div><div class="line">			<span class="keyword">if</span> temp_root:</div><div class="line">				nodeList.append(temp_root)</div><div class="line">				curDist = computerDistance(temp_root.point, query)</div><div class="line">				<span class="keyword">if</span> max_dist &gt; curDist <span class="keyword">and</span> len(node_k) == k:</div><div class="line">					index = node_k.index(max_dist)</div><div class="line">					<span class="keyword">del</span>(node_k[index])</div><div class="line">					node_k.append(curDist)</div><div class="line">				<span class="keyword">elif</span> len(node_k) &lt; k:</div><div class="line">					node_k.append(curDist)</div><div class="line">	<span class="keyword">return</span> node_k</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/04/决策树/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彼得的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/02/04/决策树/" itemprop="url">
                  Decision Tree
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-04T19:38:58+08:00">
                2018-02-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Machine-learning/" itemprop="url" rel="index">
                    <span itemprop="name">Machine_learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今天终于有时间来总结一下决策树了。</p>
<p>决策树是一种用于分类或者回归的<code>无参数学习</code>的监督方法。决策树的特点是它总是在沿着特征做切分，随着层层递进，这个划分会越来越细。</p>
<p>决策树学习包括三个步骤： <code>特征选择</code>、<code>决策树的生成</code>和<code>决策树的修剪</code>。</p>
<p>用决策树分类，从根节点开始，对实例的某一特征进行测试，根据测试结果，将实例分配到其子结点。每一个子结点对应着该特征的一个取值。如此递归地对实例进行测试并分配，直至达到叶节点。最后将实例分到叶结点的类中。</p>
<p>决策树的路径或其对应的<code>if-then</code>规则集合具有一个重要性质：互斥并且完备。就是说每一个实例都被一条路径或一条规则所覆盖，而且只被一条路径或一条规则所覆盖。</p>
<h2 id="特征选择"><u>特征选择</u></h2>
<p>特征选择在于选取对训练数据具有分类能力的特征，这样可以提高决策树学习的效率。如果利用一个特征进行分类的结果与随机分类的结果没有很大差别，则称这个特征是没有分类能力的。通常特征选择的准则是<code>信息增益</code>或<code>信息增益比</code>。</p>
<h3 id="信息增益"><u>信息增益</u></h3>
<p>熵<code>(entropy)</code>是随机变量不确定性的度量。</p>
<ul>
<li>设X是一个取有限个值的离散随机变量，其概率分布为</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
P(X=X_i) = p_ i, \ \ \ i = 1, 2, ...,n
\end{aligned}
\]</span></p>
<p>则随机变量X的熵定义为 <span class="math display">\[
H(X)=-\sum_{i=1}^{n}p_ilog\ p_i
\]</span> 熵通常以<code>2</code>为底或以<code>e</code>为底（自然对数），这是熵的单位分别称作<code>比特(bit)</code>或<code>纳特(nat)</code>。由定义可知，熵只依赖于X的分布，而与X的取值无关，所以也可将X的熵记作<code>H(p)</code>。 <span class="math display">\[
H(p)=-\sum_{i=1}^{n}p_ilog\ p_i
\]</span> 熵越大， 随机变量的不确定性就越大。从上面式子我们可知 <span class="math display">\[
0 \le H(p) \le log\ n
\]</span> 如果随机变量只取两个值，当p为0或1的时候，熵为0，随机变量完全没有不确定性，当p为0.5时，<code>H(p)=1</code>，熵取值最大，随机变量不确定性最大。</p>
<ul>
<li>设有随机变量(X, Y)，其联合概率分布为</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
P(X=x_i, Y=y_i) = p_ {ij}, \ \ \ i = 1, 2, ...,n; \ \ \ j = 1, 2, ..., m
\end{aligned}
\]</span></p>
<p>条件熵<code>H(X|Y)</code>表示在已知随机变量<code>X</code>的条件下随机变量<code>Y</code>的不确定性，随机变量X给定的条件下随机变量<code>Y</code>的<code>条件熵(Condition entropy)H(Y|X)</code>，定义为X给定条件下<code>Y</code>的条件概率分布的熵对<code>X</code>的数学期望 <span class="math display">\[
\begin{aligned}
H(Y|X) &amp; = \sum_{i=1}^{n}p_iH(Y|X=x_i), \\  
\\
&amp;p_i = P(X=x_i), i = 1, 2, ..., n
\end{aligned}
\]</span></p>
<ul>
<li><code>特征A</code>对训练数据集D的信息增益<code>g(D, A)</code>，定义为<code>集合D</code>的经<code>验熵H(D)</code>与<code>特征A</code>给定条件下D的<code>经验条件熵H(D|A)</code>之差，即 <span class="math display">\[
g(D, A) = H(D) - H(D|A)
\]</span></li>
</ul>
<p>信息增益越大，该特征越适合作为分裂点。</p>
<p>对<code>训练数据集（或子集）D</code>，计算其每个特征的信息增益，并比较它们的大小，选择信息增益最大的特征。</p>
<p>但是，信息增益存在偏向于选择取值较多的特征的问题，使用<code>信息增益比(information gain ratio)</code>可以对这一问题进行校正。</p>
<p>特征A对<code>训练数据D</code>的<code>信息增益比gR(D, A)</code>定义为其<code>信息增益g(D, A)</code>与<code>训练集D</code>关于<code>特征A</code>的值的<code>熵HA(D)</code>之比，即 <span class="math display">\[
\begin{aligned}
g_R(D, A) &amp;= \frac{g(D, A)}{H_A(D)} \\
\\
H_A(D) &amp;= -\sum_{i=1}^{n}\frac{|D_i|}{D}log_2\frac{D_i}{D},   \ \ \ n是特征A取值的个数。
\end{aligned}
\]</span> 下面是<code>Python</code>代码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">createDataSet</span><span class="params">()</span>:</span></div><div class="line">    dataSet = [[<span class="number">1</span>, <span class="number">1</span>, <span class="string">'yes'</span>],</div><div class="line">               [<span class="number">1</span>, <span class="number">1</span>, <span class="string">'yes'</span>],</div><div class="line">               [<span class="number">1</span>, <span class="number">0</span>, <span class="string">'no'</span>],</div><div class="line">               [<span class="number">0</span>, <span class="number">1</span>, <span class="string">'no'</span>],</div><div class="line">               [<span class="number">0</span>, <span class="number">1</span>, <span class="string">'no'</span>]]</div><div class="line">    labels = [<span class="string">'no surfacing'</span>,<span class="string">'flippers'</span>]</div><div class="line">    <span class="keyword">return</span> dataSet, labels</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">calcShannonEnt</span><span class="params">(dataSet)</span>:</span></div><div class="line">    numEntries = len(dataSet)</div><div class="line">    labelCounts = &#123;&#125;</div><div class="line">    <span class="keyword">for</span> featVec <span class="keyword">in</span> dataSet:</div><div class="line">        currentLabel = featVec[<span class="number">-1</span>]</div><div class="line">        <span class="keyword">if</span> currentLabel <span class="keyword">not</span> <span class="keyword">in</span> labelCounts.keys(): labelCounts[currentLabel] = <span class="number">0</span></div><div class="line">        labelCounts[currentLabel] += <span class="number">1</span></div><div class="line">        </div><div class="line">    shannonEnt = <span class="number">0.0</span></div><div class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> labelCounts:</div><div class="line">        prob = float(labelCounts[key])/numEntries</div><div class="line">        shannonEnt -= prob * log(prob, <span class="number">2</span>)</div><div class="line">    <span class="keyword">return</span> shannonEnt</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">splitDataSet</span><span class="params">(dataSet, axis, value)</span>:</span></div><div class="line">    retDataSet = []</div><div class="line">    <span class="keyword">for</span> featVec <span class="keyword">in</span> dataSet:</div><div class="line">        <span class="keyword">if</span> featVec[axis] == value:</div><div class="line">            reducedFeatVec = featVec[:axis]</div><div class="line">            reducedFeatVec.extend(featVec[axis+<span class="number">1</span>:])</div><div class="line">            retDataSet.append(reducedFeatVec)</div><div class="line">    <span class="keyword">return</span> retDataSet</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">chooseBestFeatureToSplit</span><span class="params">(dataSet)</span>:</span></div><div class="line">    numFeatures = len(dataSet[<span class="number">0</span>]) - <span class="number">1</span></div><div class="line">    baseEntropy = calcShannonEnt(dataSet)</div><div class="line">    bestInfoGain = <span class="number">0.0</span>; bestFeature = <span class="number">-1</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(numFeatures):</div><div class="line">        featList = [example[i] <span class="keyword">for</span> example <span class="keyword">in</span> dataSet]</div><div class="line">        uniqueVals = set(featList)</div><div class="line">        newEntropy = <span class="number">0.0</span></div><div class="line">        <span class="keyword">for</span> value <span class="keyword">in</span> uniqueVals:</div><div class="line">            subDataSet = splitDataSet(dataSet, i, value)</div><div class="line">            prob = len(subDataSet) / float(len(dataSet))</div><div class="line">            newEntropy += prob * calcShannonEnt(subDataSet)</div><div class="line">        infoGain = baseEntropy - newEntropy</div><div class="line">        <span class="keyword">if</span> (infoGain &gt; bestInfoGain):</div><div class="line">            bestInfoGain = infoGain</div><div class="line">            bestFeature = i</div><div class="line">    <span class="keyword">return</span> bestFeature</div></pre></td></tr></table></figure>
<h2 id="决策树的生成"><u>决策树的生成</u></h2>
<h3 id="id3算法"><u>ID3算法</u></h3>
<p>输入：训练数据集D，特征集A，阈值e</p>
<p>输出：决策树T</p>
<ul>
<li>算法
<ol type="1">
<li>若D中所有的实例属于同一类Ck，则T为单节点树，并将类Ck作为该结点的类标记，返回T</li>
<li>若A=空集，则T为单节点树，并将D中实例数最大的类Ck作为该结点的类标记，返回T</li>
<li>否则，按照计算A中各特征对D的信息增益，选择信息增益最大的特征Ag</li>
<li>如果Ag的信息增益小于阈值e，则置T为单节点树，并将D中实例数最大的类Ck作为该结点的类标记，返回T</li>
<li>否则，对Ag的每一可能值ai，将D分割为若干非空子集Di，将Di中实例数最大的类作为标记，构建子结点，由结点及其子结点构成树T，返回T</li>
<li>对第i个子节点，以Di为训练集，以A-{Ag}为特征集，递归地调用1-5，得到子树Ti，返回Ti。</li>
</ol></li>
<li>问题：
<ol type="1">
<li>不能处理连续值</li>
<li>容易偏向取值较多的特征</li>
<li>过拟合</li>
</ol></li>
</ul>
<p><code>ID3</code>算法生成的树容易产生过拟合，而且它不能直接处理连续型特征，只有事先将连续型特征转换成离散型，才能在<code>ID3</code>算法中使用。但这种转换过程会破坏连续型变量的内在性值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">majorityCnt</span><span class="params">(classList)</span>:</span></div><div class="line">    classCount=&#123;&#125;</div><div class="line">    <span class="keyword">for</span> vote <span class="keyword">in</span> classList:</div><div class="line">        <span class="keyword">if</span> vote <span class="keyword">not</span> <span class="keyword">in</span> classCount.keys(): classCount[vote] = <span class="number">0</span></div><div class="line">        classCount[vote] += <span class="number">1</span></div><div class="line">    sortedClassCount = sorted(classCount.iteritems(), key=operator.itemgetter(<span class="number">1</span>), reverse=<span class="keyword">True</span>)</div><div class="line">    <span class="keyword">return</span> sortedClassCount[<span class="number">0</span>][<span class="number">0</span>]</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">createTree</span><span class="params">(dataSet,labels)</span>:</span></div><div class="line">    classList = [example[<span class="number">-1</span>] <span class="keyword">for</span> example <span class="keyword">in</span> dataSet]</div><div class="line">    <span class="keyword">if</span> classList.count(classList[<span class="number">0</span>]) == len(classList): </div><div class="line">        <span class="keyword">return</span> classList[<span class="number">0</span>]</div><div class="line">    <span class="keyword">if</span> len(dataSet[<span class="number">0</span>]) == <span class="number">1</span>: </div><div class="line">        <span class="keyword">return</span> majorityCnt(classList)</div><div class="line">    bestFeat = chooseBestFeatureToSplit(dataSet)</div><div class="line">    bestFeatLabel = labels[bestFeat]</div><div class="line">    myTree = &#123;bestFeatLabel:&#123;&#125;&#125;</div><div class="line">    <span class="keyword">del</span>(labels[bestFeat])</div><div class="line">    featValues = [example[bestFeat] <span class="keyword">for</span> example <span class="keyword">in</span> dataSet]</div><div class="line">    uniqueVals = set(featValues)</div><div class="line">    <span class="keyword">for</span> value <span class="keyword">in</span> uniqueVals:</div><div class="line">        subLabels = labels[:]       </div><div class="line">        myTree[bestFeatLabel][value] = createTree(splitDataSet(dataSet, bestFeat, value),subLabels)</div><div class="line">    <span class="keyword">return</span> myTree</div></pre></td></tr></table></figure>
<h3 id="c4.5算法"><u>C4.5算法</u></h3>
<p>输入：训练数据集D，特征集A，阈值e</p>
<p>输出：决策树T</p>
<ul>
<li>算法
<ol type="1">
<li>若D中所有实例属于同一类Ck，则置T为单节点树，并将Ck作为该节点的类，返回T</li>
<li>如果A为空集，则置T为单节点树，并将D中实例数最大的类Ck作为该结点的类，返回T</li>
<li>否则，计算A中各特征对D的信息增益比，选择信息增益比最大的特征A</li>
<li>如果Ag的信息增益比小于阈值e，则置T为单节点树，并将D中实例数最大的类Ck作为该节点的类，返回T</li>
<li>否则，对Ag的每一可能值ai，依Ag=ai将D分割为子集若干非空Di，将Di中实例数最大的类作为标记，构建子结点，由结点及其子结点构成树T，返回T</li>
<li>对结点i，以Di为训练集，以A-{Ag}为特征集，递归地调用1-5，得到子树Ti，返回Ti。</li>
</ol></li>
<li>优点
<ol type="1">
<li><code>C4.5</code>在生成过程中，用信息增益比来选择特征，与<code>ID3</code>算法相似，而且它可以处理连续的和有缺失值的数据。</li>
</ol></li>
<li>缺点
<ol type="1">
<li>生成的是多叉树</li>
<li>只能用于分类</li>
<li>使用了熵模型，涉及大量的对数运算，很耗时</li>
</ol></li>
</ul>
<h3 id="cartclassification-and-regression-tree算法"><u>CART</u>(Classification and regression tree)算法</h3>
<p><code>CART</code>是目前最主流的决策树算法，既能生成分类树，也能生成回归树。</p>
<h3 id="cart分类树"><u>CART分类树</u></h3>
<p><code>CART</code>在处理连续值的时候，思想与<code>C4.5</code>是类似的，唯一的不同就是<code>CART</code>使用<code>基尼系数</code>最小化准则作为特征选择指标。<code>基尼系数</code>代表了模型的不纯度，基尼系数越小，则不纯度越低，特征越好。</p>
<p>在分类问题中，有K个类别，第k个类别的概率为pk，则概率分布的基尼系数表达式为： <span class="math display">\[
Gini(p) = \sum_{k=1}^{K}p_{k}(1-p_k) = 1 - \sum_{k=1}^{K}p_{k}^{2}
\]</span> 对于给定的样本D，假设有K个类别，第k个类别的数量为Ck，则样本D的基尼系数表达式为 <span class="math display">\[
Gini(D) = 1- \sum_{k=1}^{K}\biggl(\frac{|C_k|}{D}\biggr)^2
\]</span> 对于样本D，如果根据特征A的某个值a，把D分成D1和D2两部分，则在特征A的条件下，D的基尼系数表达式为： <span class="math display">\[
Gini(D, A) = \frac{D_1}{D}Gini(D_1) + \frac{D_2}{D}Gini(D2)
\]</span> 对于离散特征，<code>CART</code>构建的是二叉树而不是多叉树。复杂度一般情况下是O(logN)</p>
<p>输入：训练集D，基尼系数的阈值，样本个数阈值</p>
<p>输出：决策树T</p>
<ul>
<li>算法
<ol type="1">
<li>对于当前节点的数据集D，如果样本个数小于阈值或者没有特征，则返回决策子树，当前节点停止递归。</li>
<li>计算样本集D的基尼系数，如果基尼系数小于阈值，则返回决策树子树，当前节点停止递归。</li>
<li>计算当前节点现有的各个特征值对数据集D的基尼系数。</li>
<li>在计算出来的各个特征的各个特征值对数据集D的基尼系数中，选择基尼系数最小的特征A和对应的特征值a。根据这个最优特征和最优特征值，把数据集划分成两部分D1和D2，同时建立当前节点的左右节点，左节点的数据集D，右节点的数据集D为D2。</li>
<li>对左右的子节点递归的调用1-4步，生成决策树。</li>
</ol></li>
</ul>
<h3 id="cart回归树"><u>CART回归树</u></h3>
<p><code>CART回归树</code>用平方误差最小化准则进行特征选择，<code>CART回归树</code>的度量目标是对于任意划分特征A，对应的任意划分点s两边划分成数据集D1和D2，求出使D1和D2各自集合的均方差最小，同时D1和D2的均方差之和最小对应的特征和特征值划分点。 <span class="math display">\[
\min_{j,s}\left[ \min_{c1}\sum_{x_i\subseteq R_{1}(j,s)}(y_i-c_1)^2+\min_{c_{2}}\sum_{x_i\subseteq R_{2}(j,s)}(y_i-c_1)^2\right]
\]</span> 其中C1为D1数据集的样本输出均值，C2为D2数据集的样本输出均值。</p>
<p><code>CART回归树</code>采用的是<code>最终叶子节点的均值</code>或者<code>中位数</code>来预测输出结果。</p>
<p>输入：训练数据集D</p>
<p>输出：回归树<code>f(x)</code> <span class="math display">\[
f(x) = \sum_{m=1}^{M}c_mI(x\subseteq R_m)
\]</span> 在训练数据集所在的输入空间中，递归地将每个区域划分为两个子区域并决定每个子区域上的输出值，构建二叉决策树。</p>
<ul>
<li><p>算法</p>
<ol type="1">
<li><p>选择最优切分变量<code>j</code>与切分点<code>s</code>， 求解 <span class="math display">\[
\min_{j,s}\left[ \min_{c1}\sum_{x_i\subseteq R_{1}(j,s)}(y_i-c_1)^2+\min_{c_{2}}\sum_{x_i\subseteq R_{2}(j,s)}(y_i-c_1)^2\right]
\]</span> 遍历变量<code>j</code>，对固定的切分变量<code>j</code>扫描切分点<code>s</code>，选择上式达到最小值的对<code>(j, s)</code></p></li>
<li><p>用选定的对<code>(j, s)</code>划分区域并决定相应的输出值。 <span class="math display">\[
R_1(j, s) = \{x|x^{(j)}\le s\}  \ \ \ 和 \ \ \ R_2(j, s) = \{x|x^{(j)}\gt s\}
\]</span></p>
<p><span class="math display">\[
\hat c_m = \frac{1}{N_m}\sum_{x_i\subseteq R_{m}(j,s)}y_i,   \ \ \ \ \ \ x\subseteq R_m, m = 1, 2
\]</span></p></li>
<li><p>继续对两个子区域调用步骤(1), (2)，直至满足停止条件</p></li>
<li><p>将输入空间划分为M个区域R1, R2, …, RM, 生成决策树： <span class="math display">\[
f(x) = \sum_{m=1}^{M}\hat c_mI(x\subseteq R_m)
\]</span></p></li>
</ol></li>
</ul>
<h2 id="决策树的剪枝"><u>决策树的剪枝</u></h2>
<p>在决策树学习中将已生成的树进行简化的过程称为<code>剪枝(pruning)</code>。具体地，剪枝从已生成的树上裁掉一些子树或叶结点，并将其根结点或父结点作为新的叶结点，从而简化分类树模型。</p>
<p>决策树的剪枝通过极小化决策树整体的损失函数(<code>loss function</code>)或代价函数(<code>cost function</code>)</p>
<p>设<code>树T</code>的叶结点个数为<code>|T|</code>，<code>t</code>是<code>树T</code>的叶结点，该叶结点有<code>Nt</code>个样本点，其中<code>k</code>类的样本点有<code>Ntk</code>个，k=1, 2, …, K，<code>Ht(T)</code>为叶结点<code>t</code>上的经验熵，<code>a</code>大于等于0为参数，决策树学习的损失函数定义为 <span class="math display">\[
\begin{aligned}
C_{\alpha}(T) &amp; =\sum_{t=1}^{|T|}N_tH_t(H)+\alpha|T| \\
\\
H_t(T) &amp; = -\sum_k \frac{N_{tk}}{N_t}log\frac{N_{tk}}{N_t} \\
\\
令\ \ \  C(T) &amp; = \sum_{t=1}^{|T|}N_tH_t(H) = -\sum_{t=1}^{|T|}\sum_k^{K}N_{tk}log\frac{N_{tk}}{N_t}
\\
\\
C_{\alpha}(T) &amp; = C(T) + \alpha(T)
\end{aligned}
\]</span> <code>C(T)</code>表示模型对训练数据的预测误差，即模型与训练数据的拟合程度，<code>|T|</code>表示模型复杂度，参数<code>a&gt;=0</code>控制两者之间的影响。</p>
<p>剪枝，就是当<code>a</code>确定时，选择损失函数最小的模型，即损失函数最小的子树。可以看出，决策树生成只考虑了通过提高信息增益（或信息增益比）对训练数据进行更好的拟合，而决策树剪枝通过优化损失函数还考虑了减少模型复杂度，决策树生成学习局部的模型，而决策树剪枝学习整体的模型。</p>
<p><code>剪枝</code>分为<code>预剪枝</code>和<code>后剪枝</code>。</p>
<p><code>预剪枝</code>是指事先给定某个误差计算方法，找到数据集最佳的二元切分方式，另外，还要确定什么时候停止划分，一旦停止划分会生成一个叶结点。在决策树生成过程中，在划分节点时，若该节点的划分没有提高其在训练集上的准确率，则不进行划分。</p>
<p><code>后剪枝</code>是利用测试集来对树进行剪枝。首先指定参数，使得构建出的树足够大、足够复杂，便于剪枝。然后从上而下找到叶节点，用测试集来判断将这些叶节点合并是否能降低测试误差。如果是的话就合并。</p>
<p>采取类似于伪代码的形式来进行叙述：</p>
<p><strong>1. 输入</strong>：生成算法产生的原始决策树T，惩罚因子α</p>
<p><strong>2. 过程</strong>：</p>
<ol type="1">
<li><p>从下往上地获取T中所有 Node，存入列表<code>_tmp_nodes</code></p></li>
<li><p>对<code>_tmp_nodes</code>中的所有 Node 计算损失，存入列表<code>_old</code></p></li>
<li><p>计算<code>_tmp_nodes</code>中所有 Node 进行局部剪枝后的损失，存入列表<code>_new</code></p></li>
<li><p>进入循环体：</p>
<ol type="1">
<li><p>若<code>_new</code>中所有损失都大于<code>_old</code>中对应的损失、则退出循环体</p></li>
<li><p>否则，设p满足： <span class="math display">\[
p=\mathop{\arg\min}_{p}\_new[p]≤\_old[p]
\]</span> 则对<code>_tmp_nodes[p]</code>进行局部剪枝</p></li>
<li><p>在完成局部剪枝后，更新<code>_old</code>、<code>_new</code>、<code>_tmp_nodes</code>等变量。具体而言，我们无需重新计算它们， 只需更新“被影响到的” Node 所对应的位置的值即可</p></li>
</ol></li>
<li><p>最后调用<code>self.reduce_nodes</code>方法、将被剪掉的 Node 从<code>nodes</code>中除去</p></li>
</ol>
<p><strong>3.输出</strong>：修剪过后的决策树<code>Tα</code></p>
<h2 id="决策树优缺点">决策树优缺点</h2>
<ul>
<li><h4 id="优点">优点</h4></li>
</ul>
<ol type="1">
<li>决策树易于理解和解释</li>
<li>数据的准备往往是简单或者是不必要的</li>
<li>能够同时处理数据型和<em>类别型</em>属性。其他的技术往往要求数据属性的单一</li>
<li>在相对短的时间内能够对大型数据源做出可行且效果良好的结果</li>
<li>可以对有许多属性的数据集构造决策树</li>
<li>决策树常用于集成算法，如随机森林，提升树等</li>
</ol>
<ul>
<li><h4 id="缺点">缺点</h4></li>
</ul>
<ol type="1">
<li>在决策树当中,信息增益的结果偏向于那些具有更多数值的特征</li>
<li>决策树处理缺失数据时的困难。</li>
<li>出现过拟合</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/28/Python3内置函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彼得的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/01/28/Python3内置函数/" itemprop="url">
                  Python3内置函数
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-28T22:23:18+08:00">
                2018-01-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python-Notes/" itemprop="url" rel="index">
                    <span itemprop="name">Python_Notes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><code>Python3</code>的内置函数非常丰富，感觉掌握好它们的话在写算法程序的时候会事半功倍。这里只总结了部分内置函数。</p>
<h2 id="abs"><u>abs( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># `abs()`函数返回数字的绝对值</span></div><div class="line"><span class="comment"># abs(x)</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(abs(<span class="number">-40</span>))</div><div class="line"><span class="number">40</span></div></pre></td></tr></table></figure>
<h2 id="help"><u>help( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># help()函数用于查看函数或模块用途的详细说明</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>help(<span class="string">'sys'</span>)</div><div class="line">Help on built-<span class="keyword">in</span> module sys:</div><div class="line">    NAME</div><div class="line">    sys</div><div class="line">....</div></pre></td></tr></table></figure>
<h2 id="max"><u>max( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># max()方法返回给定参数的最大值，参数可以为序列</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>max(<span class="number">80</span>, <span class="number">100</span>, <span class="number">1000</span>)</div><div class="line"><span class="number">1000</span></div></pre></td></tr></table></figure>
<h2 id="min"><u>min( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># min() 方法返回给定参数的最小值，参数可以为序列</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>min(<span class="number">-20</span>, <span class="number">100</span>, <span class="number">400</span>)</div><div class="line"><span class="number">-20</span></div></pre></td></tr></table></figure>
<h2 id="round"><u>round( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># round()方法返回浮点数x的四舍五入值</span></div><div class="line"><span class="comment"># round(x[, n])</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>round(<span class="number">100.564056</span>, <span class="number">2</span>)</div><div class="line"><span class="number">100.56</span></div></pre></td></tr></table></figure>
<h2 id="setattr"><u>setattr( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 函数对应函数getattr()，用于设置属性值，该属性必须存在</span></div><div class="line"><span class="comment"># setattr语法</span></div><div class="line"><span class="comment"># setattr(object, name, value)</span></div><div class="line"><span class="comment"># object -- 对象。</span></div><div class="line"><span class="comment"># name -- 字符串，对象属性。</span></div><div class="line"><span class="comment"># value -- 属性值。</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">(object)</span>:</span></div><div class="line">    bar = <span class="number">1</span></div><div class="line">    </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = A()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>getattr(a, <span class="string">'bar'</span>)</div><div class="line"><span class="number">1</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>setattr(a, <span class="string">'bar'</span>, <span class="number">5</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a.bar</div><div class="line"><span class="number">5</span></div></pre></td></tr></table></figure>
<h2 id="all"><u>all( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># all()函数用于判定给定的可迭代参数iterable中的所有元素是否不为0、''、False或者iterable为空，如果是返回True， 否则返回False</span></div><div class="line"><span class="comment"># 函数等价于</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">all</span><span class="params">(iterable)</span>:</span></div><div class="line">    <span class="keyword">for</span> element <span class="keyword">in</span> iterable:</div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> element:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line"></div><div class="line"><span class="comment"># all()语法</span></div><div class="line"><span class="comment"># all(iterable)</span></div><div class="line"><span class="comment"># iterable -- 元组或列表</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>all([<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>])</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>all([])</div><div class="line"><span class="keyword">True</span></div></pre></td></tr></table></figure>
<h2 id="any"><u>any( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># any()函数用于判断给定的可迭代参数iterable是否全部为空对象，如果都为空、0、False，则返回False，如果不都为空、0、False，则返回True</span></div><div class="line"><span class="comment"># 函数等价于</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">any</span><span class="params">(iterable)</span>:</span></div><div class="line">    <span class="keyword">for</span> element <span class="keyword">in</span> iterable:</div><div class="line">        <span class="keyword">if</span> element:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line"></div><div class="line"><span class="comment"># 以下是any()方法的语法:</span></div><div class="line"><span class="comment"># any(iterable)</span></div><div class="line"><span class="comment"># 返回值</span></div><div class="line"><span class="comment"># 如果都为空、0、false，则返回false，如果不都为空、0、false，则返回true。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>any([<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>])</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>any([<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">''</span>, <span class="string">'d'</span>])</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>any((<span class="number">0</span>, <span class="string">''</span>, <span class="keyword">False</span>))</div><div class="line"><span class="keyword">False</span></div></pre></td></tr></table></figure>
<h2 id="dir"><u>dir( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># dir()函数不带参数时，返回当前范围内的变量、方法和定义的类型列表；带参数时，返回参数的属性、方法列表。如果参数包含方法__dir__()，该方法将被调用。如果参数不包含__dir__()，该方法将最大限度地收集参数信息</span></div><div class="line"><span class="comment"># dir()语法</span></div><div class="line"><span class="comment"># dir([object])</span></div><div class="line"><span class="comment"># object -- 对象、变量、类型</span></div><div class="line"><span class="comment"># 返回模块的属性列表</span></div><div class="line">&gt;&gt; dir()</div><div class="line">[<span class="string">'A'</span>,</div><div class="line"> <span class="string">'__builtin__'</span>,</div><div class="line"> <span class="string">'__builtins__'</span>,</div><div class="line"> <span class="string">'__doc__'</span>,</div><div class="line"> <span class="string">'__loader__'</span>,</div><div class="line"> <span class="string">'__name__'</span>,</div><div class="line"> <span class="string">'__package__'</span>,</div><div class="line"> <span class="string">'__spec__'</span>,</div><div class="line"> ...</div></pre></td></tr></table></figure>
<h2 id="hex"><u>hex( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># hex()函数用于将10进制整数转换成16进制，以字符串形式表示。</span></div><div class="line"><span class="comment"># hex()语法：</span></div><div class="line"><span class="comment"># hex(x)</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>hex(<span class="number">255</span>)</div><div class="line"><span class="string">'0xff'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>type(hex(<span class="number">12</span>))</div><div class="line">str</div></pre></td></tr></table></figure>
<h2 id="oct"><u>oct( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>oct()函数将一个整数转成<span class="number">8</span>进制字符串。</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>oct(x)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>返回值</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>返回<span class="number">8</span>进制字符串。</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>oct(<span class="number">10</span>)</div><div class="line"><span class="string">'0o12'</span></div></pre></td></tr></table></figure>
<h2 id="bin"><u>bin( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># bin()返回一个整数int或者长整数long int的二进制表示。</span></div><div class="line"><span class="comment"># 语法</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>bin(x)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>bin(<span class="number">10</span>)</div><div class="line"><span class="string">'0b1010'</span></div></pre></td></tr></table></figure>
<h2 id="int"><u>int( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># int()函数用于将一个字符串或数字转换为整型。</span></div><div class="line"><span class="comment"># 语法</span></div><div class="line"><span class="comment"># 以下是int()方法的语法:</span></div><div class="line"><span class="comment"># class int(x, base=10)</span></div><div class="line"><span class="comment"># 参数</span></div><div class="line"><span class="comment"># x -- 字符串或数字。</span></div><div class="line"><span class="comment"># base -- 进制数，默认十进制。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>int()</div><div class="line"><span class="number">0</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>int(<span class="string">'12'</span>, <span class="number">16</span>)</div><div class="line"><span class="number">18</span></div></pre></td></tr></table></figure>
<h2 id="ord"><u>ord( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># ord()函数是chr()函数（对于8位的ASCII字符串）或者unichr()函数（对于Unicode对象）的配对函数</span></div><div class="line"><span class="comment"># 它以一个字符（长度为1的字符串）作为参数，返回对应的ASCII数值，或者Unicode数值。</span></div><div class="line"><span class="comment"># 如果所给的Unicode字符超出了Python定义范围，则会引发一个TypeError的异常。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>ord(<span class="string">'c'</span>)</div><div class="line"><span class="number">99</span></div></pre></td></tr></table></figure>
<h2 id="ascii"><u>ascii()</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># ascii()函数类似于repr()函数，返回一个表示对象的字符串，但是对于字符串中的非ASCII字符则返回通过repr()函数使用\x, \u或\U编码的字符。生成字符串类似于Python2版本中repr()函数的返回值</span></div><div class="line"><span class="comment"># ascii(object)</span></div><div class="line"><span class="comment"># 返回字符串</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>ascii(<span class="string">'runoob'</span>)</div><div class="line"><span class="string">"'runoob'"</span></div></pre></td></tr></table></figure>
<h2 id="next"><u>next( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 返回迭代器的下一个项目</span></div><div class="line"><span class="comment"># next()语法</span></div><div class="line"><span class="comment"># next(iterator[, default])</span></div><div class="line"><span class="comment"># iterator -- 可迭代对象</span></div><div class="line"><span class="comment"># default -- 可选，用于设置在没有下一个元素时返回该默认值，如果不设置，又没有下一个元素则会触发 StopIteration 异常。</span></div><div class="line"><span class="comment"># 返回值</span></div><div class="line"><span class="comment"># 返回对象帮助信息。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span> it = iter([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line"><span class="meta">... </span>   <span class="keyword">try</span>:</div><div class="line"><span class="meta">... </span>       x = next(it)</div><div class="line"><span class="meta">... </span>       print(x)</div><div class="line"><span class="meta">... </span>   <span class="keyword">except</span> StopIteration:</div><div class="line"><span class="meta">... </span>       <span class="keyword">break</span></div><div class="line"></div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">3</span></div><div class="line"><span class="number">4</span></div><div class="line"><span class="number">5</span></div></pre></td></tr></table></figure>
<h2 id="slice"><u>slice( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># slice()函数实现切片对象，主要在切片操作函数里的参数传递。</span></div><div class="line"><span class="comment"># slice()语法：</span></div><div class="line"><span class="comment"># class slice(stop)</span></div><div class="line"><span class="comment"># class slice(start, stop[, step])</span></div><div class="line"><span class="comment"># start -- 起始位置</span></div><div class="line"><span class="comment"># stop -- 结束位置</span></div><div class="line"><span class="comment"># step -- 间距</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>myslice = slice(<span class="number">5</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>myslice</div><div class="line">slice(<span class="keyword">None</span>, <span class="number">5</span>, <span class="keyword">None</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>arr = range(<span class="number">10</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>arr</div><div class="line">range(<span class="number">0</span>, <span class="number">10</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>arr[myslice]</div><div class="line">range(<span class="number">0</span>, <span class="number">5</span>)</div></pre></td></tr></table></figure>
<h2 id="divmod"><u>divmod( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># divmod()函数把除数和余数运算结果结合起来，返回一个包含商和余数的元组(a//b, a % b)</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>divmod(<span class="number">7</span>, <span class="number">2</span>)</div><div class="line">(<span class="number">3</span>, <span class="number">1</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>divmod(<span class="number">8</span>, <span class="number">2</span>)</div><div class="line">(<span class="number">4</span>, <span class="number">0</span>)</div></pre></td></tr></table></figure>
<h2 id="sum"><u>sum( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># sum()方法对系列进行求和计算</span></div><div class="line"><span class="comment"># 语法</span></div><div class="line"><span class="comment"># 以下是sum()方法的语法:</span></div><div class="line"><span class="comment"># sum(iterable[, start])</span></div><div class="line"><span class="comment"># 参数</span></div><div class="line"><span class="comment"># iterable -- 可迭代对象，如列表。</span></div><div class="line"><span class="comment"># start -- 指定相加的参数，如果没有设置这个值，默认为0。</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>sum([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>])</div><div class="line"><span class="number">3</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>sum([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], <span class="number">1</span>)</div><div class="line"><span class="number">4</span></div></pre></td></tr></table></figure>
<h2 id="eval"><u>eval( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># eval()函数用来执行一个字符串表达式，并返回表达式的值。</span></div><div class="line"><span class="comment"># 语法：</span></div><div class="line"><span class="comment"># eval(expression[, globals[, locals])</span></div><div class="line"><span class="comment"># 参数</span></div><div class="line"><span class="comment"># expression -- 表达式。</span></div><div class="line"><span class="comment"># globals -- 变量作用域，全局命名空间，如果被提供，则必须是一个字典对象。</span></div><div class="line"><span class="comment"># locals -- 变量作用域，局部命名空间，如果被提供，可以是任何映射对象。</span></div><div class="line"><span class="comment"># 返回值</span></div><div class="line"><span class="comment"># 返回表达式计算结果。</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="number">7</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>eval(<span class="string">'3*x'</span>)</div><div class="line"><span class="number">21</span></div></pre></td></tr></table></figure>
<h2 id="id"><u>id( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 函数用于获取对象的内存地址</span></div><div class="line"><span class="comment"># id()语法：</span></div><div class="line"><span class="comment"># id([object])</span></div><div class="line"><span class="comment"># object -- 对象。</span></div><div class="line"><span class="comment"># 返回值</span></div><div class="line"><span class="comment"># 返回对象的内存地址。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="string">'runoob'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>id(a)</div><div class="line"><span class="number">4481592152</span></div></pre></td></tr></table></figure>
<h2 id="sorted"><u>sorted( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># sort 与 sorted 区别：</span></div><div class="line"><span class="comment"># sort是应用在list上的方法，sorted可以对所有可迭代的对象进行排序操作。</span></div><div class="line"><span class="comment"># list的sort方法返回的是对已经存在的列表进行操作，而内建函数sorted方法返回的是一个新的list，而不是在原来的基础上进行的操作。</span></div><div class="line"><span class="comment"># sorted语法：</span></div><div class="line"><span class="comment"># sorted(iterable, key=None, reverse=False)</span></div><div class="line"><span class="comment"># 参数说明：</span></div><div class="line"><span class="comment"># iterable -- 可迭代对象。</span></div><div class="line"><span class="comment"># key -- 主要是用来进行比较的元素，只有一个参数，具体的函数的参数就是取自于可迭代对象中，指定可迭代对象中的一个元素来进行排序。</span></div><div class="line"><span class="comment"># reverse -- 排序规则，reverse = True降序 ， reverse = False 升序（默认）。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>sorted([<span class="number">5</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>])</div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">5</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a.sort()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>example_list = [<span class="number">5</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">4</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result_list = sorted(example_list, key=<span class="keyword">lambda</span> x: x*<span class="number">-1</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result_list</div><div class="line">[<span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>example_list = [<span class="number">5</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">4</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>sorted(example_list, reverse=<span class="keyword">True</span>)</div><div class="line">[<span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>]</div></pre></td></tr></table></figure>
<h2 id="enumerate"><u>enumerate( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># enumerate()函数用于将一个可遍历的数据对象（如列表、元组或字符串）组合为一个索引序列，同时列出数据和数据下标，一般用在for循环当中。</span></div><div class="line"><span class="comment"># 以下是enumerate()方法的语法:</span></div><div class="line"><span class="comment"># enumerate(sequence, [start=0])</span></div><div class="line"><span class="comment"># sequence -- 一个序列、迭代器或其他支持迭代对象。</span></div><div class="line"><span class="comment"># start -- 下标起始位置。</span></div><div class="line"><span class="comment"># 返回值</span></div><div class="line"><span class="comment"># 返回enumerate(枚举)对象。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>seasons = [<span class="string">'Spring'</span>, <span class="string">'Summer'</span>, <span class="string">'Fall'</span>, <span class="string">'Winter'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list(enumerate(seasons))</div><div class="line">[(<span class="number">0</span>, <span class="string">'Spring'</span>), (<span class="number">1</span>, <span class="string">'Summer'</span>), (<span class="number">2</span>, <span class="string">'Fall'</span>), (<span class="number">3</span>, <span class="string">'Winter'</span>)]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list(enumerate(seasons, start=<span class="number">1</span>))</div><div class="line">[(<span class="number">1</span>, <span class="string">'Spring'</span>), (<span class="number">2</span>, <span class="string">'Summer'</span>), (<span class="number">3</span>, <span class="string">'Fall'</span>), (<span class="number">4</span>, <span class="string">'Winter'</span>)]</div></pre></td></tr></table></figure>
<h2 id="input"><u>input( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># python input()相当于eval(raw_input(prompt))，用来控制控制台的输入。</span></div><div class="line"><span class="comment"># raw_input()将所有输入作为字符串看待，返回字符串类型。而input()在对待纯数字输入时具有自己的特性，它返回所输入的数字的类型(int, float)</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = input(<span class="string">"input:"</span>)</div><div class="line">input:<span class="number">123</span></div></pre></td></tr></table></figure>
<h2 id="classmethod"><u>classmethod( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># classmethod()修饰符对应的函数不需要实例化，不需要self参数，但第一个参数需要是表示自身类的cls参数，可以来调用类的属性、类的方法、实例化对象等。</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">(object)</span>:</span></div><div class="line">    bar = <span class="number">1</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func1</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'foo'</span>)</div><div class="line">        </div><div class="line"><span class="meta">    @classmethod</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func2</span><span class="params">(cls)</span>:</span></div><div class="line">        print(<span class="string">'func2'</span>)</div><div class="line">        print(cls.bar)</div><div class="line">        cls().func1()</div><div class="line"></div><div class="line">A.func2()</div><div class="line"></div><div class="line">[output]</div><div class="line">func2</div><div class="line"><span class="number">1</span></div><div class="line">foo</div></pre></td></tr></table></figure>
<h2 id="staticmethod"><u>staticmethod( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># staticmethod返回函数的静态方法</span></div><div class="line"><span class="comment"># 该方法不强制要求传递参数，如下声明一个静态方法：</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span><span class="params">(object)</span>:</span></div><div class="line"><span class="meta">    @staticmethod</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(arg1, arg2, ...)</span>:</span></div><div class="line">        ... </div><div class="line"><span class="comment"># 以上实例声明了静态方法f，类可以不用实例化就可以调用该方法C.f()，当然也可以实例化后调用C().f()。</span></div><div class="line"><span class="comment"># 函数语法</span></div><div class="line"><span class="comment"># staticmethod(function)</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">C</span><span class="params">(object)</span>:</span></div><div class="line">...		@staticmethod</div><div class="line">...		<span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">()</span>:</span></div><div class="line">...			print(<span class="string">'hey'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>C.f()</div><div class="line">hey</div></pre></td></tr></table></figure>
<h2 id="open"><u>open( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># open()函数用于打开一个文件，创建一个file对象，相关的方法才可以调用它进行读写。</span></div><div class="line"><span class="comment"># 语法</span></div><div class="line"><span class="comment"># open(name[, mode[, buffering]])</span></div><div class="line"><span class="comment"># 参数说明：</span></div><div class="line"><span class="comment"># name:一个包含了你要访问的文件名称的字符串值。</span></div><div class="line"><span class="comment"># mode:mode 决定了打开文件的模式：只读，写入，追加等。所有可取值见如下的完全列表。这个参数是非强制的，默认文件访问模式为只读(r)。</span></div><div class="line"><span class="comment"># buffering:如果 buffering 的值被设为 0，就不会有寄存。如果 buffering 的值取 1，访问文件时会寄存行。如果将 buffering 的值设为大于 1 的整数，表明了这就是的寄存区的缓冲大小。如果取负值，寄存区的缓冲大小则为系统默认。</span></div><div class="line"><span class="comment"># file对象方法</span></div><div class="line"><span class="comment"># file.read([size])size未指定则返回整个文件,如果文件大小&gt;2倍内存则有问题.f.read()读到文件尾时返回""(空字串)</span></div><div class="line"><span class="comment"># file.readline()返回一行</span></div><div class="line"><span class="comment"># file.readlines([size])返回包含size行的列表,size 未指定则返回全部行</span></div><div class="line"><span class="comment"># for line in f: print line#通过迭代器访问</span></div><div class="line"><span class="comment"># f.write("hello\n")#如果要写入字符串以外的数据,先将他转换为字符串.</span></div><div class="line"><span class="comment"># f.tell()返回一个整数,表示当前文件指针的位置(就是到文件头的比特数).</span></div><div class="line"><span class="comment"># f.seek(偏移量,[起始位置])用来移动文件指针.</span></div><div class="line"><span class="comment"># 偏移量:单位:比特,可正可负</span></div><div class="line"><span class="comment"># 起始位置:0-文件头,默认值;1-当前位置;2-文件尾</span></div><div class="line"><span class="comment"># f.close()关闭文件</span></div><div class="line"><span class="comment"># str()</span></div><div class="line"><span class="comment"># str()函数将对象转化为适于人阅读的形式</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">'hey'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>str(s)</div><div class="line"><span class="string">'hey'</span></div></pre></td></tr></table></figure>
<h2 id="bool"><u>bool( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># bool()函数用于将给定参数转换为布尔类型，如果没有参数，返回False</span></div><div class="line"><span class="comment"># 语法</span></div><div class="line"><span class="comment"># 以下是bool()方法的语法：</span></div><div class="line"><span class="comment"># class bool([x])</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>bool()</div><div class="line"><span class="keyword">False</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>bool(<span class="number">9</span>)</div><div class="line"><span class="keyword">True</span></div></pre></td></tr></table></figure>
<h2 id="exec"><u>exec( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># exex()执行储存在字符串或文件中的Python语句，相比于eval, exec可以执行更复杂的python代码</span></div><div class="line"><span class="comment"># 语法</span></div><div class="line"><span class="comment"># 以下是 exec 的语法:</span></div><div class="line"><span class="comment"># exec(object[, globals[, locals]])</span></div><div class="line"><span class="comment"># 参数</span></div><div class="line"><span class="comment"># object：必选参数，表示需要被指定的Python代码。它必须是字符串或code对象。如果object是一个字符串，该字符串会先被解析为一组Python语句，然后在执行（除非发生语法错误）。如果object是一个code对象，那么它只是被简单的执行。</span></div><div class="line"><span class="comment"># globals：可选参数，表示全局命名空间（存放全局变量），如果被提供，则必须是一个字典对象。</span></div><div class="line"><span class="comment"># locals：可选参数，表示当前局部命名空间（存放局部变量），如果被提供，可以是任何映射对象。如果该参数被忽略，那么它将会取与globals相同的值。</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>exec(<span class="string">'print("Hello World")'</span>)</div><div class="line">Hello World</div></pre></td></tr></table></figure>
<h2 id="super"><u>super( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># super()函数用于调用下一个父类（超类）并返回该父类实例的方法</span></div><div class="line"><span class="comment"># super()是用来解决多重继承问题，直接用类名调用父类方法在使用单继承的时候没问题，但如果使用多继承，会涉及到查找顺序（MRO）、重复调用等问题</span></div><div class="line"><span class="comment"># super(type[, object-or-type])</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FooParent</span><span class="params">(object)</span>:</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.parent = <span class="string">'I\'m the parent.'</span></div><div class="line">        print(<span class="string">'Parent'</span>)</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bar</span><span class="params">(self, message)</span>:</span></div><div class="line">        print(<span class="string">"%s from Parent"</span> % message)</div><div class="line">        </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FooChild</span><span class="params">(FooParent)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="comment"># super(FooChild,self) 首先找到 FooChild 的父类（就是类 FooParent）</span></div><div class="line">        <span class="comment"># 然后把类B的对象 FooChild 转换为类 FooParent 的对象</span></div><div class="line">        super(FooChild, self).__init__()</div><div class="line">        print(<span class="string">'Child'</span>)</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bar</span><span class="params">(self, message)</span>:</span></div><div class="line">        super(FooChild, self).bar(message)</div><div class="line">        print(<span class="string">'Child bar function'</span>)</div><div class="line">        print(self.parent)</div><div class="line">        </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    fooChild = FooChild()</div><div class="line">    fooChild.bar(<span class="string">'HelloWorld'</span>)</div><div class="line">    </div><div class="line">[output]</div><div class="line">Parent</div><div class="line">Child</div><div class="line">HelloWorld <span class="keyword">from</span> Parent</div><div class="line">Child bar function</div><div class="line">I<span class="string">'m the parent.</span></div></pre></td></tr></table></figure>
<h2 id="issubclass"><u>issubclass( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># issubclass()方法用于判断参数class是否是类型参数classinfo的子类。</span></div><div class="line"><span class="comment"># issubclass(class, classinfo)</span></div><div class="line"><span class="comment"># 参数</span></div><div class="line"><span class="comment"># class -- 类。</span></div><div class="line"><span class="comment"># classinfo -- 类。</span></div><div class="line"><span class="comment"># 返回值</span></div><div class="line"><span class="comment"># 如果class是classinfo的子类返回True，否则返回False。</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></div><div class="line"><span class="meta">... </span>   <span class="keyword">pass</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">B</span><span class="params">(A)</span>:</span></div><div class="line"><span class="meta">... </span>   <span class="keyword">pass</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(issubclass(B, A))</div><div class="line"><span class="keyword">True</span></div></pre></td></tr></table></figure>
<h2 id="isinstance"><u>isinstance( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># isinstance()函数是用来判断一个对象是否是一个已知的类型，类似于type()</span></div><div class="line"><span class="comment"># isinstance() 与 type() 区别：</span></div><div class="line"><span class="comment"># type() 不会认为子类是一种父类类型，不考虑继承关系。</span></div><div class="line"><span class="comment"># isinstance() 会认为子类是一种父类类型，考虑继承关系。</span></div><div class="line"><span class="comment"># 如果要判断两个类型是否相同推荐使用 isinstance()。</span></div><div class="line"><span class="comment"># 语法</span></div><div class="line"><span class="comment"># 以下是 isinstance()方法的语法:</span></div><div class="line"><span class="comment"># isinstance(object, classinfo)</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="number">2</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(a, int)</div><div class="line"><span class="keyword">True</span></div></pre></td></tr></table></figure>
<h2 id="bytearray"><u>bytearray( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># bytearray()方法返回一个新字节数组，这个数组里的元素是可变的，并且每个元素的值范围：0&lt;=x&lt;256</span></div><div class="line"></div><div class="line"><span class="comment"># 语法</span></div><div class="line"><span class="comment"># bytearray()方法语法：</span></div><div class="line"><span class="comment"># class bytearray([source[, encoding[, errors]]])</span></div><div class="line"><span class="comment"># 参数</span></div><div class="line"><span class="comment"># 如果source为整数，则返回一个长度为source的初始化数组；</span></div><div class="line"><span class="comment"># 如果source为字符串，则按照指定的 encoding 将字符串转换为字节序列；</span></div><div class="line"><span class="comment"># 如果source为可迭代类型，则元素必须为[0 ,255] 中的整数；</span></div><div class="line"><span class="comment"># 如果source为与buffer接口一致的对象，则此对象也可以被用于初始化bytearray。</span></div><div class="line"><span class="comment"># 如果没有输入任何参数，默认就是初始化数组为0个元素。</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>bytearray()</div><div class="line">bytearray(<span class="string">b''</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>bytearray([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</div><div class="line">bytearray(<span class="string">b'\x01\x02\x03'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>bytearray(<span class="string">'runoob'</span>, <span class="string">'utf-8'</span>)</div><div class="line">bytearray(<span class="string">b'runoob'</span>)</div></pre></td></tr></table></figure>
<h2 id="bytes"><u>bytes( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># bytes()函数返回一个新的bytes对象，该对象是一个0&lt;=x&lt;256区间内的整数不可变序列。它是bytearray的不可变版本。</span></div><div class="line"><span class="comment"># class bytes([source[, encoding[, errors]]])</span></div><div class="line"><span class="comment"># 参数</span></div><div class="line"><span class="comment"># 如果source为整数，则返回一个长度为source的初始化数组；</span></div><div class="line"><span class="comment"># 如果source为字符串，则按照指定的encoding将字符串转换为字节序列；</span></div><div class="line"><span class="comment"># 如果source为可迭代类型，则元素必须为[0 ,255] 中的整数；</span></div><div class="line"><span class="comment"># 如果source为与buffer接口一致的对象，则此对象也可以被用于初始化bytearray。</span></div><div class="line"><span class="comment"># 如果没有输入任何参数，默认就是初始化数组为0个元素。</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = bytes([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line"><span class="string">b'\x01\x02\x03\x04'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = bytes(<span class="string">'hello'</span>, <span class="string">'ascii'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line"><span class="string">b'hello'</span></div></pre></td></tr></table></figure>
<h2 id="pow"><u>pow( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># pow()方法返回x的y次方的值</span></div><div class="line"><span class="comment"># pow(x, y[, z])</span></div><div class="line"><span class="comment"># 函数是计算x的y次方，如果z在存在，则再对结果进行取模，其结果等效于pow(x,y) %z</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>pow(<span class="number">100</span>, <span class="number">-2</span>)</div><div class="line"><span class="number">0.0001</span></div></pre></td></tr></table></figure>
<h2 id="float"><u>float( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># float()函数用于将整数和字符串转换成浮点数。</span></div><div class="line"><span class="comment"># class float([x])</span></div><div class="line"><span class="comment"># 参数</span></div><div class="line"><span class="comment"># x -- 整数或字符串</span></div><div class="line"><span class="comment"># 返回值</span></div><div class="line"><span class="comment"># 返回浮点数。</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>float(<span class="number">1</span>)</div><div class="line"><span class="number">1.0</span></div></pre></td></tr></table></figure>
<h2 id="iter"><u>iter( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># iter()函数用来生成迭代器。</span></div><div class="line"><span class="comment"># iter(object[, sentinel])</span></div><div class="line"><span class="comment"># 参数</span></div><div class="line"><span class="comment"># object -- 支持迭代的集合对象。</span></div><div class="line"><span class="comment"># sentinel -- 如果传递了第二个参数，则参数object必须是一个可调用的对象（如，函数），此时，iter创建了一个迭代器对象，每次调用这个迭代器对象的__next__()方法时，都会调用object。</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>lst = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> iter(lst):</div><div class="line"><span class="meta">... </span>   print(i)</div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">3</span></div></pre></td></tr></table></figure>
<h2 id="print"><u>print( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># print()方法用于打印输出。</span></div><div class="line"><span class="comment"># print(*objects, sep=' ', end='\n', file=sys.stdout)</span></div><div class="line"><span class="comment"># 参数</span></div><div class="line"><span class="comment"># objects -- 复数，表示可以一次输出多个对象。输出多个对象时，需要用 , 分隔。</span></div><div class="line"><span class="comment"># sep -- 用来间隔多个对象，默认值是一个空格。</span></div><div class="line"><span class="comment"># end -- 用来设定以什么结尾。默认值是换行符 \n，我们可以换成其他字符串。</span></div><div class="line"><span class="comment"># file -- 要写入的文件对象。</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"peter"</span>, <span class="string">"tseng"</span>, <span class="string">"ruihon"</span>, sep=<span class="string">"|"</span>)</div><div class="line">peter|tseng|ruihon</div></pre></td></tr></table></figure>
<h2 id="repr"><u>repr( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># repr()函数将对象转化为供解释器读取的形式</span></div><div class="line"><span class="comment"># repr(object)</span></div><div class="line"><span class="comment"># 返回一个对象的string格式</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">'peter'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>repr(s)</div><div class="line"><span class="string">"'peter'"</span></div></pre></td></tr></table></figure>
<h2 id="str"><u>str()</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># str()函数将对象转化为适于人阅读的形式</span></div><div class="line"><span class="comment"># str() 返回一个对象的string格式</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>str(<span class="number">10</span>)</div><div class="line"><span class="string">'10'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>str(&#123;<span class="string">'age'</span>:<span class="number">22</span>&#125;)</div><div class="line"><span class="string">"&#123;'age': 22&#125;"</span></div></pre></td></tr></table></figure>
<h2 id="callable"><u>callable( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># callable()函数用于检查一个对象是否可调用，如果返回True，object仍然可能调用失败；但如果返回False，调用对象object绝对不会成功。</span></div><div class="line"><span class="comment"># 对于函数、方法、lambda函式、类，以及实现了__call__方法的类实例，它都返回True</span></div><div class="line"><span class="comment"># callable(object)</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>callable(<span class="number">0</span>)</div><div class="line"><span class="keyword">False</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>callable(<span class="string">"peter"</span>)</div><div class="line"><span class="keyword">False</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(a, b)</span>:</span></div><div class="line"><span class="meta">... </span>   <span class="keyword">return</span> a+b</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>callable(add)</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></div><div class="line"><span class="meta">... </span>   <span class="function"><span class="keyword">def</span> <span class="title">method</span><span class="params">(self)</span>:</span></div><div class="line"><span class="meta">... </span>       <span class="keyword">return</span> <span class="number">0</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>callable(A)</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>callable(A())</div><div class="line"><span class="keyword">False</span></div></pre></td></tr></table></figure>
<h2 id="format"><u>format( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># format()方法增强了字符串格式化的功能。</span></div><div class="line"><span class="comment"># 基本语法是通过&#123;&#125;和:来代替以前的%。</span></div><div class="line"><span class="comment"># format函数可以接受不限个参数，位置可以不按顺序</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;&#125; &#123;&#125;"</span>.format(<span class="string">"hello"</span>, <span class="string">"world"</span>)</div><div class="line"><span class="string">'hello world'</span></div></pre></td></tr></table></figure>
<h2 id="len"><u>len( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># len()方法返回对象（字符、列表、元组等）长度或项目个数</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>len([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</div><div class="line"><span class="number">3</span></div></pre></td></tr></table></figure>
<h2 id="property"><u>property( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># property()函数的作用是在新式类中返回属性值。</span></div><div class="line"><span class="comment"># class property([fget[, fset[, fdel[, doc]]]])</span></div><div class="line"><span class="comment"># 参数</span></div><div class="line"><span class="comment"># fget -- 获取属性值的函数</span></div><div class="line"><span class="comment"># fset -- 设置属性值的函数</span></div><div class="line"><span class="comment"># fdel -- 删除属性值函数</span></div><div class="line"><span class="comment"># doc -- 属性描述信息</span></div><div class="line"><span class="comment"># 返回值</span></div><div class="line"><span class="comment"># 返回新式类属性。</span></div><div class="line"><span class="comment"># 将 property 函数用作装饰器可以很方便的创建只读属性：</span></div><div class="line"><span class="comment"># 将voltage()方法转化成同名只读属性的 getter 方法</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parrot</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self._voltage = <span class="number">100000</span></div><div class="line">        </div><div class="line"><span class="meta">    @property</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">voltage</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self._voltage</div></pre></td></tr></table></figure>
<h2 id="type"><u>type( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># type()函数返回对象类型</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>type(<span class="number">1</span>)</div><div class="line">int</div></pre></td></tr></table></figure>
<h2 id="chr"><u>chr( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># chr()用一个范围在range(256)内的整数作为参数，返回一个对应的字符。</span></div><div class="line"><span class="comment"># chr(i)</span></div><div class="line"><span class="comment"># 参数</span></div><div class="line"><span class="comment"># i -- 可以是10进制也可以是16进制的形式的数字。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>chr(<span class="number">0x30</span>)</div><div class="line"><span class="string">'0'</span></div></pre></td></tr></table></figure>
<h2 id="set"><u>set( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># set()函数创建一个无序不重复元素集，可进行关系测试，删除重复数据，还可以计算交集、差集、并集等。</span></div><div class="line"><span class="comment"># class set([iterable])</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>set(<span class="string">'aaabbb'</span>)</div><div class="line">&#123;<span class="string">'a'</span>, <span class="string">'b'</span>&#125;</div></pre></td></tr></table></figure>
<h2 id="frozenset"><u>frozenset( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># frozenset()返回一个不可变的集合，集合不能再添加或删除任何元素</span></div><div class="line"><span class="comment"># class frozenset([iterable])</span></div><div class="line"><span class="comment"># 参数</span></div><div class="line"><span class="comment"># iterable -- 可迭代的对象，比如列表、字典、元组等等</span></div><div class="line"><span class="comment"># 返回值</span></div><div class="line"><span class="comment"># 返回新的frozenset对象，如果不提供任何参数，默认会生成空集合</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>frozenset(range(<span class="number">10</span>))</div><div class="line">frozenset(&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125;)</div></pre></td></tr></table></figure>
<h2 id="list"><u>list( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># list()方法用于将元组转换为列表</span></div><div class="line"><span class="comment"># list(seq)</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>aTuple = (<span class="string">'Google'</span>, <span class="string">'Youtube'</span>, <span class="string">'Facebook'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list(aTuple)</div><div class="line">[<span class="string">'Google'</span>, <span class="string">'Youtube'</span>, <span class="string">'Facebook'</span>]</div></pre></td></tr></table></figure>
<h2 id="tuple"><u>tuple( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># tuple()函数将列表转换为元组。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list1 = [<span class="string">'Google'</span>, <span class="string">'Taobao'</span>, <span class="string">'Runoob'</span>, <span class="string">'Baidu'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>tuple(list1)</div><div class="line">(<span class="string">'Google'</span>, <span class="string">'Taobao'</span>, <span class="string">'Runoob'</span>, <span class="string">'Baidu'</span>)</div></pre></td></tr></table></figure>
<h2 id="dict"><u>dict( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># dict()函数用于创建一个字典</span></div><div class="line"><span class="comment"># dict语法：</span></div><div class="line"><span class="comment"># class dict(**kwarg)</span></div><div class="line"><span class="comment"># class dict(mapping, **kwarg)</span></div><div class="line"><span class="comment"># class dict(iterable, **kwarg)</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>dict()</div><div class="line">&#123;&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>dict(a=<span class="string">'a'</span>, b=<span class="string">'b'</span>, c=<span class="string">'c'</span>)</div><div class="line">&#123;<span class="string">'a'</span>: <span class="string">'a'</span>, <span class="string">'b'</span>: <span class="string">'b'</span>, <span class="string">'c'</span>: <span class="string">'c'</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>dict(zip([<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]))</div><div class="line">&#123;<span class="string">'one'</span>: <span class="number">1</span>, <span class="string">'three'</span>: <span class="number">3</span>, <span class="string">'two'</span>: <span class="number">2</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>dict([(<span class="string">'one'</span>, <span class="number">1</span>), (<span class="string">'two'</span>, <span class="number">2</span>), (<span class="string">'three'</span>, <span class="number">3</span>)])</div><div class="line">&#123;<span class="string">'one'</span>: <span class="number">1</span>, <span class="string">'three'</span>: <span class="number">3</span>, <span class="string">'two'</span>: <span class="number">2</span>&#125;</div></pre></td></tr></table></figure>
<h2 id="range"><u>range( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># range()函数可创建一个整数列表，一般用在for循环中。</span></div><div class="line"><span class="comment"># range(start, stop[, step])</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>[i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">10</span>)]</div><div class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</div></pre></td></tr></table></figure>
<h2 id="vars"><u>vars( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># var()函数返回对象object的属性和属性值的字典对象</span></div><div class="line"><span class="comment"># vars([object])</span></div><div class="line"><span class="comment"># 参数</span></div><div class="line"><span class="comment"># object -- 对象</span></div><div class="line"><span class="comment"># 返回值</span></div><div class="line"><span class="comment"># 返回对象object的属性和属性值的字典对象，如果没有参数，就打印当前调用位置的属性和属性值 类似locals()。</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></div><div class="line"><span class="meta">... </span>   a = <span class="number">1</span></div><div class="line">    </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>vars(Person)</div><div class="line">mappingproxy(&#123;<span class="string">'__dict__'</span>: &lt;attribute <span class="string">'__dict__'</span> of <span class="string">'Person'</span> objects&gt;,</div><div class="line">              <span class="string">'__doc__'</span>: <span class="keyword">None</span>,</div><div class="line">              <span class="string">'__module__'</span>: <span class="string">'__main__'</span>,</div><div class="line">              <span class="string">'__weakref__'</span>: &lt;attribute <span class="string">'__weakref__'</span> of <span class="string">'Person'</span> objects&gt;,</div><div class="line">              <span class="string">'a'</span>: <span class="number">1</span>&#125;)</div></pre></td></tr></table></figure>
<h2 id="hasattr"><u>hasattr( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># hasattr()函数用于判断对象是否包含对应的属性</span></div><div class="line"><span class="comment"># hasattr(object, name)</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">Coordinate</span>:</span></div><div class="line"><span class="meta">... </span>   x = <span class="number">10</span></div><div class="line"><span class="meta">... </span>   y = <span class="number">-5</span></div><div class="line"><span class="meta">... </span>   z = <span class="number">0</span></div><div class="line">    </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>point1 = Coordinate()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>hasattr(point1, <span class="string">'x'</span>)</div><div class="line"><span class="keyword">True</span></div></pre></td></tr></table></figure>
<h2 id="delattr"><u>delattr( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># delattr()函数用于删除属性</span></div><div class="line"><span class="comment"># delattr(object, name)</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">Coordinate</span>:</span></div><div class="line"><span class="meta">... </span>   x = <span class="number">10</span></div><div class="line"><span class="meta">... </span>   y = <span class="number">-5</span></div><div class="line"><span class="meta">... </span>   z = <span class="number">0</span></div><div class="line">    </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>point1 = Coordinate()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>delattr(Coordinate, <span class="string">'x'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>hasattr(point1, <span class="string">'x'</span>)</div><div class="line"><span class="keyword">False</span></div></pre></td></tr></table></figure>
<h2 id="getattr"><u>getattr( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># getattr()函数用于返回一个对象属性值。</span></div><div class="line"><span class="comment"># getattr(object, name[, default])</span></div><div class="line"><span class="comment"># 参数</span></div><div class="line"><span class="comment"># object -- 对象。</span></div><div class="line"><span class="comment"># name -- 字符串，对象属性。</span></div><div class="line"><span class="comment"># defaul -- 默认返回值，如果不提供该参数，在没有对应属性时，将触发AttributeError。</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">(object)</span>:</span></div><div class="line"><span class="meta">... </span>   bar = <span class="number">1</span></div><div class="line"><span class="meta">... </span>   </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = A()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>getattr(a, <span class="string">'bar'</span>)</div><div class="line"><span class="number">1</span></div></pre></td></tr></table></figure>
<h2 id="globals"><u>globals( )</u></h2>
<p><code>globals()</code>函数会以字典类型返回当前位置的全部全局变量</p>
<h2 id="locals"><u>locals( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># locals()函数会以字典类型返回当前位置的全部局部变量。</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">person</span><span class="params">(arg)</span>:</span></div><div class="line">    z = <span class="number">1</span></div><div class="line">    print(locals())</div><div class="line">    </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>person(<span class="number">1</span>)</div><div class="line">&#123;<span class="string">'arg'</span>: <span class="number">1</span>, <span class="string">'z'</span>: <span class="number">1</span>&#125;</div></pre></td></tr></table></figure>
<h2 id="map"><u>map( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># map()会根据提供的函数对指定序列做映射</span></div><div class="line"><span class="comment"># 第一个参数function以参数序列中的每一个元素调用function函数，返回包含每次function函数返回值的新列表。</span></div><div class="line"><span class="comment"># map(function, iterable, ...)</span></div><div class="line"><span class="comment"># 参数</span></div><div class="line"><span class="comment"># function -- 函数</span></div><div class="line"><span class="comment"># iterable -- 一个或多个序列</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">square</span><span class="params">(x)</span>:</span></div><div class="line"><span class="meta">... </span>   <span class="keyword">return</span> x ** <span class="number">2</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list(map(square, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]))</div><div class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list(map(<span class="keyword">lambda</span> x, y: x + y, [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>], [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>]))</div><div class="line">[<span class="number">3</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">19</span>]</div></pre></td></tr></table></figure>
<h2 id="reversed"><u>reversed( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># reversed()函数返回一个反转的迭代器</span></div><div class="line"><span class="comment"># reversed(seq)</span></div><div class="line"><span class="comment"># seq -- 要转换的序列，可以是tuple, string, list或range</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list(reversed(<span class="string">'peter'</span>))</div><div class="line">[<span class="string">'r'</span>, <span class="string">'e'</span>, <span class="string">'t'</span>, <span class="string">'e'</span>, <span class="string">'p'</span>]</div></pre></td></tr></table></figure>
<h2 id="zip"><u>zip( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># zip()函数用于将可迭代的对象作为参数，将对象中对应的元素打包成一个个元组，然后返回由这些元组组成的列表。如果各个迭代器的元素个数不一致，则返回列表长度与最短对象相同。利用*操作符，可以将元组解压为列表。</span></div><div class="line"><span class="comment"># zip([iterable, ...])</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c = [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>[i <span class="keyword">for</span> i <span class="keyword">in</span> zip(a, b, c)]</div><div class="line">[(<span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>), (<span class="number">2</span>, <span class="number">5</span>, <span class="number">8</span>), (<span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>)]</div></pre></td></tr></table></figure>
<h2 id="filter"><u>filter( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># filter()函数用于过滤序列，过滤掉不符合条件的元素，返回由符合条件元素组成的新列表。</span></div><div class="line"><span class="comment"># 函数接受两个参数， 第一个为函数，第二个为序列，序列的每个元素作为参数传递给函数进行判断，然后返回True或False，最后将返回True的元素放到新列表中。</span></div><div class="line"><span class="comment"># filter(function, iterable)</span></div><div class="line"><span class="comment"># 参数</span></div><div class="line"><span class="comment"># function -- 判断函数。</span></div><div class="line"><span class="comment"># iterable -- 可迭代对象。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">is_odd</span><span class="params">(n)</span>:</span></div><div class="line"><span class="meta">... </span>   <span class="keyword">return</span> n % <span class="number">2</span> == <span class="number">1</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>newlist = filter(is_odd, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>[i <span class="keyword">for</span> i <span class="keyword">in</span> newlist]</div><div class="line">[<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>]</div></pre></td></tr></table></figure>
<h2 id="compile"><u>compile( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># compile()函数将一个字符串编译为字节代码</span></div><div class="line"><span class="comment"># compile(source, filename, mode[, flags[, dont_inherit]])</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>Astr = <span class="string">"for i in range(0, 10): print(i)"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>exec(compile(Astr, <span class="string">''</span>, <span class="string">'exec'</span>))</div><div class="line"><span class="number">0</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">3</span></div><div class="line"><span class="number">4</span></div><div class="line"><span class="number">5</span></div><div class="line"><span class="number">6</span></div><div class="line"><span class="number">7</span></div><div class="line"><span class="number">8</span></div><div class="line"><span class="number">9</span></div></pre></td></tr></table></figure>
<h2 id="import__"><u>__import__( )</u></h2>
<p><code>__import__()</code>函数用于动态加载类和函数</p>
<p>如果一个模块经常变化就可以使用<code>__import__()</code>来动态载入。</p>
<p><code>__import__(name, globals[, locals[, fromlist[, level]]])</code></p>
<h2 id="complex"><u>complex( )</u></h2>
<p><code>complex()</code>函数用于创建一个值为<code>real + imag*j</code>的复数或者转化一个字符串或数为复数。</p>
<h2 id="hash"><u>hash( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># hash()用于获取一个对象（字符串或数值等）的哈希值。</span></div><div class="line"><span class="comment"># hash(object)</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>hash(str(sorted(&#123;<span class="string">'1'</span>:<span class="number">1</span>&#125;)))</div><div class="line"><span class="number">-1814123638319226962</span></div></pre></td></tr></table></figure>
<h2 id="memoryview"><u>memoryview( )</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># memoryview()函数返回给定参数的内存查看对象。内存查看对象是指对支持缓冲区协议的数据进行包装，在不需要复制对象基础上允许python代码访问</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>v = memoryview(bytearray(<span class="string">"abcefg"</span>, <span class="string">'utf-8'</span>))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(v[<span class="number">1</span>])</div><div class="line"><span class="number">98</span></div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/27/Scipy笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彼得的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/01/27/Scipy笔记/" itemprop="url">
                  Scipy笔记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-27T20:07:27+08:00">
                2018-01-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python-Notes/" itemprop="url" rel="index">
                    <span itemprop="name">Python_Notes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><code>scipy</code>包含许多专注于科学计算中常见问题的工具箱。它的子模块对应于不同的应用，比如插值、积分、优化、图像处理、统计和特殊功能等。</p>
<p>scipy是由针对特定任务的子模块组成的：</p>
<table>
<thead>
<tr class="header">
<th>子模块</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="http://docs.scipy.org/doc/scipy/reference/cluster.html#scipy.cluster" target="_blank" rel="noopener"><code>scipy.cluster</code></a></td>
<td>向量计算 / Kmeans</td>
</tr>
<tr class="even">
<td><a href="http://docs.scipy.org/doc/scipy/reference/constants.html#scipy.constants" target="_blank" rel="noopener"><code>scipy.constants</code></a></td>
<td>物理和数学常量</td>
</tr>
<tr class="odd">
<td><a href="http://docs.scipy.org/doc/scipy/reference/fftpack.html#scipy.fftpack" target="_blank" rel="noopener"><code>scipy.fftpack</code></a></td>
<td>傅里叶变换</td>
</tr>
<tr class="even">
<td><a href="http://docs.scipy.org/doc/scipy/reference/integrate.html#scipy.integrate" target="_blank" rel="noopener"><code>scipy.integrate</code></a></td>
<td>积分程序</td>
</tr>
<tr class="odd">
<td><a href="http://docs.scipy.org/doc/scipy/reference/interpolate.html#scipy.interpolate" target="_blank" rel="noopener"><code>scipy.interpolate</code></a></td>
<td>插值</td>
</tr>
<tr class="even">
<td><a href="http://docs.scipy.org/doc/scipy/reference/io.html#scipy.io" target="_blank" rel="noopener"><code>scipy.io</code></a></td>
<td>数据输入和输出</td>
</tr>
<tr class="odd">
<td><a href="http://docs.scipy.org/doc/scipy/reference/linalg.html#scipy.linalg" target="_blank" rel="noopener"><code>scipy.linalg</code></a></td>
<td>线性代数程序</td>
</tr>
<tr class="even">
<td><a href="http://docs.scipy.org/doc/scipy/reference/ndimage.html#scipy.ndimage" target="_blank" rel="noopener"><code>scipy.ndimage</code></a></td>
<td>n-维图像包</td>
</tr>
<tr class="odd">
<td><a href="http://docs.scipy.org/doc/scipy/reference/odr.html#scipy.odr" target="_blank" rel="noopener"><code>scipy.odr</code></a></td>
<td>正交距离回归</td>
</tr>
<tr class="even">
<td><a href="http://docs.scipy.org/doc/scipy/reference/optimize.html#scipy.optimize" target="_blank" rel="noopener"><code>scipy.optimize</code></a></td>
<td>优化</td>
</tr>
<tr class="odd">
<td><a href="http://docs.scipy.org/doc/scipy/reference/signal.html#scipy.signal" target="_blank" rel="noopener"><code>scipy.signal</code></a></td>
<td>信号处理</td>
</tr>
<tr class="even">
<td><a href="http://docs.scipy.org/doc/scipy/reference/sparse.html#scipy.sparse" target="_blank" rel="noopener"><code>scipy.sparse</code></a></td>
<td>稀疏矩阵</td>
</tr>
<tr class="odd">
<td><a href="http://docs.scipy.org/doc/scipy/reference/spatial.html#scipy.spatial" target="_blank" rel="noopener"><code>scipy.spatial</code></a></td>
<td>空间数据结构和算法</td>
</tr>
<tr class="even">
<td><a href="http://docs.scipy.org/doc/scipy/reference/special.html#scipy.special" target="_blank" rel="noopener"><code>scipy.special</code></a></td>
<td>一些特殊数学函数</td>
</tr>
<tr class="odd">
<td><a href="http://docs.scipy.org/doc/scipy/reference/stats.html#scipy.stats" target="_blank" rel="noopener"><code>scipy.stats</code></a></td>
<td>统计</td>
</tr>
</tbody>
</table>
<p>他们全都依赖于<code>numpy</code>，但是大多数都是彼此独立。</p>
<h2 id="概率统计方法"><u>概率统计方法</u></h2>
<h3 id="简介">简介</h3>
<p><code>Python</code>中常用的统计工具有 <code>Numpy</code>, <code>Pandas</code>, <code>PyMC</code>, <code>StatsModels</code>等。Scipy 中的子库 scipy.stats 中包含很多统计上的方法。</p>
<p>导入 numpy 和 matplotlib：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div></pre></td></tr></table></figure>
<h3 id="概率分布">概率分布</h3>
<ul>
<li>常见的连续概率分布有：
<ul>
<li>均匀分布</li>
<li>正态分布</li>
<li>学生t分布</li>
<li>F分布</li>
<li>Gamma分布</li>
</ul></li>
<li>离散概率分布：
<ul>
<li>伯努利分布</li>
<li>几何分布</li>
</ul></li>
</ul>
<p>这些都可以在 <code>scipy.stats</code>中找到。</p>
<h3 id="连续分布">连续分布</h3>
<h3 id="正态分布">正态分布</h3>
<p>以<code>正态分布</code>为例，先导入<code>正态分布</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> norm</div></pre></td></tr></table></figure>
<p>它包含四类常用的函数：</p>
<ul>
<li><code>norm.cdf</code> 返回对应的<a href="https://zh.wikipedia.org/wiki/%E7%B4%AF%E7%A7%AF%E5%88%86%E5%B8%83%E5%87%BD%E6%95%B0" target="_blank" rel="noopener">累计分布函数</a>值</li>
<li><code>norm.pdf</code> 返回对应的<a href="https://zh.wikipedia.org/wiki/%E6%A9%9F%E7%8E%87%E5%AF%86%E5%BA%A6%E5%87%BD%E6%95%B8" target="_blank" rel="noopener">概率密度函数</a>值</li>
<li><code>norm.rvs</code> 产生指定参数的随机变量</li>
<li><code>norm.fit</code> 返回给定数据下，各参数的<a href="https://zh.wikipedia.org/wiki/%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6%E4%BC%B0%E8%AE%A1" target="_blank" rel="noopener">最大似然估计</a>（MLE）值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 从正态分布产生500个随机点：</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x_norm = norm.rvs(size=<span class="number">500</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>type(x_norm)</div><div class="line">numpy.ndarray</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>h = plt.hist(x_norm)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'count: '</span>, h[<span class="number">0</span>])</div><div class="line">count:  [   <span class="number">2.</span>   <span class="number">10.</span>   <span class="number">20.</span>   <span class="number">66.</span>  <span class="number">119.</span>  <span class="number">119.</span>  <span class="number">102.</span>   <span class="number">42.</span>   <span class="number">17.</span>    <span class="number">3.</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'bin centers'</span>, h[<span class="number">1</span>])</div><div class="line">bin centers [<span class="number">-3.46</span> <span class="number">-2.81</span> <span class="number">-2.16</span> <span class="number">-1.51</span> <span class="number">-0.86</span> <span class="number">-0.21</span>  <span class="number">0.43</span>  <span class="number">1.08</span>  <span class="number">1.73</span>  <span class="number">2.38</span>  <span class="number">3.03</span>]</div></pre></td></tr></table></figure>
<p><img src="/images/scipy/output_9_1.png"></p>
<p>归一化直方图（用出现频率代替次数），将划分区间变为 20（默认 10）:<img src="/images/scipy/output_11_0.png" alt="output_11_0"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 在这组数据下，正态分布参数的最大似然估计值为：</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x_mean, x_std = norm.fit(x_norm)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'mean '</span>, x_mean)</div><div class="line">mean  <span class="number">-0.036045620814</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'x_std'</span>, x_std)</div><div class="line">x_std <span class="number">1.00480461409</span></div><div class="line"></div><div class="line"><span class="comment"># 将真实的概率密度函数与直方图进行比较：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>h = plt.hist(x_norm, normed=<span class="keyword">True</span>, bins=<span class="number">20</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = np.linspace(<span class="number">-3</span>, <span class="number">3</span>, <span class="number">50</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = plt.plot(x, norm.pdf(x), <span class="string">'r-'</span>)</div></pre></td></tr></table></figure>
<p><img src="/images/scipy/output_15_0.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 导入积分函数：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> scipy.integrate <span class="keyword">import</span> trapz</div><div class="line"></div><div class="line"><span class="comment"># 通过积分，计算落在某个区间的概率大小：</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x1 = np.linspace(<span class="number">-2</span>, <span class="number">2</span>, <span class="number">108</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = trapz(norm.pdf(x1), x1)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'&#123;:.2f&#125; of the values lie between -2 and 2'</span>.format(p))</div><div class="line"><span class="number">0.95</span> of the values lie between <span class="number">-2</span> <span class="keyword">and</span> <span class="number">2</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.fill_between(x1, norm.pdf(x1), color=<span class="string">'red'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x, norm.pdf(x), <span class="string">'k-'</span>)</div></pre></td></tr></table></figure>
<p><img src="/images/scipy/output_19_2.png"></p>
<p>默认情况，<code>正态分布</code>的参数为均值0，标准差1，即标准正态分布。可以通过<code>loc</code>和<code>scale</code>来调整这些参数，一种方法是调用相关函数时进行输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = plt.plot(x, norm.pdf(x, loc=<span class="number">0</span>, scale=<span class="number">1</span>))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = plt.plot(x, norm.pdf(x, loc=<span class="number">0.5</span>, scale=<span class="number">2</span>))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = plt.plot(x, norm.pdf(x, loc=<span class="number">-0.5</span>, scale=<span class="number">.5</span>))</div></pre></td></tr></table></figure>
<p><img src="/images/scipy/output_21_0.png"></p>
<p>另一种则是将 <code>loc</code>, <code>scale</code> 作为参数直接输给 <code>norm</code> 生成相应的分布：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = plt.plot(x, norm(loc=<span class="number">0</span>, scale=<span class="number">1</span>).pdf(x))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = plt.plot(x, norm(loc=<span class="number">0.5</span>, scale=<span class="number">2</span>).pdf(x))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = plt.plot(x, norm(loc=<span class="number">-0.5</span>, scale=<span class="number">.5</span>).pdf(x))</div></pre></td></tr></table></figure>
<p><img src="/images/scipy/output_23_0.png"></p>
<p>其他连续分布</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> lognorm, t, dweibull</div></pre></td></tr></table></figure>
<p>支持与<code>norm</code> 类似的操作，如概率密度函数等。</p>
<p>不同参数的对数正态分布：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = np.linspace(<span class="number">0.01</span>, <span class="number">3</span>, <span class="number">100</span>)</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x, lognorm.pdf(x, <span class="number">1</span>), label=<span class="string">'s=1'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x, lognorm.pdf(x, <span class="number">2</span>), label=<span class="string">'s=2'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x, lognorm.pdf(x, <span class="number">.1</span>), label=<span class="string">'s=0.1'</span>)</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.legend()</div></pre></td></tr></table></figure>
<p><img src="/images/scipy/output_27_1.png"></p>
<p>不同的<code>韦氏分布</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = np.linspace(<span class="number">0.01</span>, <span class="number">3</span>, <span class="number">100</span>)</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x, dweibull.pdf(x, <span class="number">1</span>), label=<span class="string">'s=1, constant failure rate'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x, dweibull.pdf(x, <span class="number">2</span>), label=<span class="string">'s=2, increasing failure rate'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x, dweibull.pdf(x, <span class="number">.1</span>), label=<span class="string">'0&lt;s&lt;1, decreasing failure rate'</span>)</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.legend()</div></pre></td></tr></table></figure>
<p><img src="/images/scipy/output_29_1.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = np.linspace(<span class="number">-3</span>, <span class="number">3</span>, <span class="number">100</span>)</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x, t.pdf(x, <span class="number">1</span>), label=<span class="string">'df=1'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x, t.pdf(x, <span class="number">2</span>), label=<span class="string">'df=2'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x, t.pdf(x, <span class="number">100</span>), label=<span class="string">'df=100'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x[::<span class="number">5</span>], norm.pdf(x[::<span class="number">5</span>]), <span class="string">'kx'</span>, label=<span class="string">'normal'</span>)</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.legend()</div></pre></td></tr></table></figure>
<p><img src="/images/scipy/output_30_1.png"></p>
<h2 id="离散分布">离散分布</h2>
<p>导入离散分布：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> binom, poisson, randint</div></pre></td></tr></table></figure>
<p>离散分布没有概率密度函数，但是有概率质量函数。离散均匀分布的概率质量函数<code>（PMF）</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>%matplotlib inline</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>high = <span class="number">10</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>low = <span class="number">-10</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = np.arange(low, high+<span class="number">1</span>, <span class="number">0.5</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = plt.stem(x, randint(low, high).pmf(x))</div></pre></td></tr></table></figure>
<p><img src="/images/scipy/output_34_1.png"></p>
<h3 id="二项分布">二项分布：</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>num_trails = <span class="number">60</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = np.arange(num_trails)</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x, binom(num_trails, <span class="number">0.5</span>).pmf(x), <span class="string">'o-'</span>, label=<span class="string">'p=0.5'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x, binom(num_trails, <span class="number">0.2</span>).pmf(x), <span class="string">'o-'</span>, label=<span class="string">'p=0.2'</span>)</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.legend()</div></pre></td></tr></table></figure>
<p><img src="/images/scipy/output_36_1.png"></p>
<h3 id="泊松分布">泊松分布：</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = np.arange(<span class="number">0</span>, <span class="number">21</span>)</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x, poisson(<span class="number">1</span>).pmf(x), <span class="string">'o-'</span>, label=<span class="string">r'$\lambda$=1'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x, poisson(<span class="number">4</span>).pmf(x), <span class="string">'o-'</span>, label=<span class="string">r'$\lambda$=4'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x, poisson(<span class="number">9</span>).pmf(x), <span class="string">'o-'</span>, label=<span class="string">r'$\lambda$=9'</span>)</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.legend()</div></pre></td></tr></table></figure>
<p><img src="/images/scipy/output_38_1.png"></p>
<h3 id="导入相关的函数">导入相关的函数：</h3>
<ul>
<li><code>正态分布</code></li>
<li><code>独立双样本 t 检验</code>，<code>配对样本 t 检验</code>，<code>单样本 t 检验</code></li>
<li><code>学生 t 分布</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> norm</div><div class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> ttest_ind, ttest_rel, ttest_1samp</div><div class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> t</div></pre></td></tr></table></figure>
<h3 id="独立样本-t-检验">独立样本 t 检验</h3>
<h3 id="两组参数不同的正态分布">两组参数不同的正态分布：</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>n1 = norm(loc=<span class="number">0.3</span>, scale=<span class="number">1.0</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>n2 = norm(loc=<span class="number">0</span>, scale=<span class="number">1.0</span>)</div><div class="line"></div><div class="line"><span class="comment"># 从分布中产生两组随机样本：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>n1_samples = n1.rvs(size=<span class="number">100</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>n2_samples = n2.rvs(size=<span class="number">100</span>)</div><div class="line"></div><div class="line"><span class="comment"># 将两组样本混合在一起：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>samples = np.hstack((n1_samples, n2_samples))</div><div class="line"></div><div class="line"><span class="comment"># 最大似然参数估计：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>loc, scale = norm.fit(samples)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>n = norm(loc=loc, scale=scale)</div><div class="line"></div><div class="line"><span class="comment"># 比较</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = np.linspace(<span class="number">-3</span>, <span class="number">3</span>, <span class="number">100</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.hist([samples, n1_samples, n2_samples], normed=<span class="keyword">True</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x, n.pdf(x), <span class="string">'b-'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x, n1.pdf(x), <span class="string">'g-'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>plt.plot(x, n2.pdf(x), <span class="string">'r-'</span>)</div></pre></td></tr></table></figure>
<p><img src="/images/scipy/output_42_1.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 独立双样本 t 检验的目的在于判断两组样本之间是否有显著差异：p 值小，说明这两个样本有显著性差异。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>t_val, p = ttest_ind(n1_samples, n2_samples)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'t = &#123;&#125;'</span>.format(t_val))</div><div class="line">t = <span class="number">2.4883708971185237</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'p-value = &#123;&#125;'</span>.format(p))</div><div class="line">p-value = <span class="number">0.013658121015263052</span></div><div class="line"></div><div class="line"><span class="comment"># p值计算原理</span></div><div class="line"><span class="comment"># p值对应的部分是下图中的红色区域，边界范围由 t 值决定。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>pop_size = <span class="number">35</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>my_t = t(pop_size) <span class="comment"># 传入参数为自由度，这里自由度为50</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = plt.plot(x, my_t.pdf(x), <span class="string">'b-'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>lower_x = x[x&lt;= -abs(t_val)]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>upper_x = x[x&gt;= abs(t_val)]</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = plt.fill_between(lower_x, my_t.pdf(lower_x), color=<span class="string">'red'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = plt.fill_between(upper_x, my_t.pdf(upper_x), color=<span class="string">'red'</span>)</div></pre></td></tr></table></figure>
<p><img src="/images/scipy/output_46_0.png"></p>
<h2 id="曲线拟合"><u>曲线拟合</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = np.linspace(<span class="number">-5</span>, <span class="number">5</span>, <span class="number">100</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = <span class="number">4</span> * x + <span class="number">1.5</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>noise_y = y + np.random.randn(y.shape[<span class="number">-1</span>]) * <span class="number">2.5</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = plt.plot(x, noise_y, <span class="string">'rx'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = plt.plot(x, y, <span class="string">'b:'</span>)</div></pre></td></tr></table></figure>
<p><img src="/images/scipy/output_49_0.png"></p>
<p>进行线性拟合，polyfit 是多项式拟合函数，线性拟合即一阶多项式：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>coeff = np.polyfit(x, noise_y, <span class="number">1</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>coeff</div><div class="line">array([ <span class="number">4.05681667</span>,  <span class="number">1.61039447</span>])</div><div class="line"></div><div class="line"><span class="comment"># 一阶多项式 y = a_1 x + a_0 拟合，返回两个系数 [a_1, a_0]。</span></div><div class="line"><span class="comment"># 画出拟合曲线：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = plt.plot(x, noise_y, <span class="string">'rx'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = plt.plot(x, coeff[<span class="number">0</span>] * x + coeff[<span class="number">1</span>], <span class="string">'k-'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = plt.plot(x, y, <span class="string">'b--'</span>)</div></pre></td></tr></table></figure>
<p><img src="/images/scipy/output_53_0.png"></p>
<p>还可以用<code>poly1d</code> 生成一个以传入的 <code>coeff</code> 为参数的多项式函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>f = np.poly1d(coeff)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = plt.plot(x, noise_y, <span class="string">'rx'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = plt.plot(x, f(x))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(f)</div><div class="line"><span class="number">4.057</span> x + <span class="number">1.61</span></div></pre></td></tr></table></figure>
<p><img src="/images/scipy/output_55_0.png"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/27/Pandas笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彼得的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/01/27/Pandas笔记/" itemprop="url">
                  Pandas笔记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-27T10:29:25+08:00">
                2018-01-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python-Notes/" itemprop="url" rel="index">
                    <span itemprop="name">Python_Notes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今天在网上看到了一个非常棒的<code>Pandas</code>笔记.</p>
<p>来源<code>http://www.webpages.uidaho.edu/~stevel/504/Pandas%20DataFrame%20Notes.pdf</code>。<img src="/images/pandas/Pandas%20DataFrame%20Notes.jpg" alt="Pandas DataFrame Notes"><img src="/images/pandas/Pandas%20DataFrame%20Notes2.jpg" alt="Pandas DataFrame Notes2"><img src="/images/pandas/Pandas%20DataFrame%20Notes3.jpg" alt="Pandas DataFrame Notes3"><img src="/images/pandas/Pandas%20DataFrame%20Notes4.jpg" alt="Pandas DataFrame Notes4"><img src="/images/pandas/Pandas%20DataFrame%20Notes5.jpg" alt="Pandas DataFrame Notes5"><img src="/images/pandas/Pandas%20DataFrame%20Notes6.jpg" alt="Pandas DataFrame Notes6"><img src="/images/pandas/Pandas%20DataFrame%20Notes7.jpg" alt="Pandas DataFrame Notes7"><img src="/images/pandas/Pandas%20DataFrame%20Notes8.jpg" alt="Pandas DataFrame Notes8"><img src="/images/pandas/Pandas%20DataFrame%20Notes9.jpg" alt="Pandas DataFrame Notes9"><img src="/images/pandas/Pandas%20DataFrame%20Notes10.jpg" alt="Pandas DataFrame Notes10"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/25/Numpy笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peter Tsung">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandas.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彼得的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/01/25/Numpy笔记/" itemprop="url">
                  Numpy笔记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-25T18:11:45+08:00">
                2018-01-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python-Notes/" itemprop="url" rel="index">
                    <span itemprop="name">Python_Notes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Numpy是Python的一个很重要的第三方库，其他很多科学计算的第三方库都是以Numpy为基础建立的。</p>
<h2 id="numpy的一个重要特性是它的数组计算"><u>Numpy</u>的一个重要特性是它的<strong>数组计算</strong>。</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div></pre></td><td class="code"><pre><div class="line">import numpy as np</div><div class="line"></div><div class="line">#数组上的数学操作</div><div class="line">#假如我们想将列表中的每个元素增加1， 列表不支持这样的操作</div><div class="line">&gt;&gt;&gt; a = [1, 2, 3, 4]</div><div class="line">&gt;&gt;&gt; a + 1</div><div class="line"></div><div class="line">---------------------------------------------------------------------------</div><div class="line">TypeError                                 Traceback (most recent call last)</div><div class="line">&lt;ipython-input-6-068856d2a224&gt; in &lt;module&gt;()</div><div class="line">      1 a = [1, 2, 3, 4]</div><div class="line">----&gt; 2 a + 1</div><div class="line">TypeError: can only concatenate list (not "int") to list</div><div class="line">  </div><div class="line">&gt;&gt;&gt; a = np.array(a)</div><div class="line">&gt;&gt;&gt; a</div><div class="line">array([1, 2, 3, 4])</div><div class="line"></div><div class="line"># 然后我们可以看到数组是支持这样的操作</div><div class="line">&gt;&gt;&gt; a + 1</div><div class="line">array([2, 3, 4, 5])</div><div class="line"></div><div class="line"># 与另一个array相加，得到对应元素相加的结果：</div><div class="line">&gt;&gt;&gt;b = array([2, 3, 4, 5])</div><div class="line">&gt;&gt;&gt; a + b</div><div class="line">array([3, 5, 7, 9])</div><div class="line"></div><div class="line"># 对应元素相乘：</div><div class="line">&gt;&gt;&gt; a * b</div><div class="line">array([ 2,  6, 12, 20])</div><div class="line"></div><div class="line">#修改数组形式</div><div class="line">&gt;&gt;&gt; a.shape</div><div class="line">(4,)</div><div class="line"></div><div class="line"># 修改array的形状</div><div class="line">&gt;&gt;&gt; a.shape = 2, 2</div><div class="line">&gt;&gt;&gt; a</div><div class="line">array([[1, 2],</div><div class="line">       [3, 4]])</div><div class="line"></div><div class="line"># 多维数组</div><div class="line"># a现在变成了一个二维的数组，可以进行加法：</div><div class="line">&gt;&gt;&gt; a + a</div><div class="line">array([[2, 4],</div><div class="line">       [6, 8]])</div><div class="line"></div><div class="line"># 乘法仍然是对应元素的乘积，并不是按照矩阵乘法来计算：</div><div class="line">&gt;&gt;&gt; a * a</div><div class="line">array([[ 1,  4],</div><div class="line">       [ 9, 16]])</div><div class="line"></div><div class="line"># 使用fill方法设定初始值</div><div class="line"># 但与列表不同，数组中要求所有元素的dtype是一样的，如果传入参数的类型与数组类型不一样，需要按照已有的类型进行转换。</div><div class="line">&gt;&gt;&gt; a = array([1, 2, 3, 4])</div><div class="line">&gt;&gt;&gt; a.fill(-4.8)</div><div class="line">&gt;&gt;&gt; a</div><div class="line">array([-4, -4, -4, -4])</div><div class="line"></div><div class="line"># 多维数组及其属性</div><div class="line"># array还可以用来生成多维数组：</div><div class="line">&gt;&gt;&gt; a = array([[0, 1, 2, 3], </div><div class="line">          [10, 11, 12, 13]])</div><div class="line">&gt;&gt;&gt; a</div><div class="line">array([[ 0,  1,  2,  3],</div><div class="line">       [10, 11, 12, 13]])</div><div class="line"></div><div class="line"># 多维数组切片</div><div class="line">&gt;&gt;&gt; a = array([[ 0, 1, 2, 3, 4, 5],</div><div class="line">           [10,11,12,13,14,15],</div><div class="line">           [20,21,22,23,24,25],</div><div class="line">           [30,31,32,33,34,35],</div><div class="line">           [40,41,42,43,44,45],</div><div class="line">           [50,51,52,53,54,55]])</div><div class="line">&gt;&gt;&gt; a</div><div class="line">array([[ 0,  1,  2,  3,  4,  5],</div><div class="line">       [10, 11, 12, 13, 14, 15],</div><div class="line">       [20, 21, 22, 23, 24, 25],</div><div class="line">       [30, 31, 32, 33, 34, 35],</div><div class="line">       [40, 41, 42, 43, 44, 45],</div><div class="line">       [50, 51, 52, 53, 54, 55]])</div><div class="line"></div><div class="line"># 想得到第一行的第 4 和第 5 两个元素：</div><div class="line">&gt;&gt;&gt; a[0, 3:5]</div><div class="line">array([3, 4])</div><div class="line"></div><div class="line"># 得到最后两行的最后两列：</div><div class="line">&gt;&gt;&gt; a[4:, 4:]</div><div class="line">array([[44, 45],</div><div class="line">       [54, 55]])</div><div class="line"></div><div class="line"># 求和</div><div class="line">&gt;&gt;&gt; a = np.array([[1, 2, 3],</div><div class="line">             [4, 5, 6]])</div><div class="line">&gt;&gt;&gt; np.sum(a)</div><div class="line">21</div><div class="line"></div><div class="line"># 指定求和的维度：</div><div class="line"># 沿着第一维求和：</div><div class="line">&gt;&gt;&gt; np.sum(a, axis=0)</div><div class="line">array([5, 7, 9])</div><div class="line">&gt;&gt;&gt; a.sum(axis=0)</div><div class="line">array([5, 7, 9])</div><div class="line"></div><div class="line"># 求积</div><div class="line"># 求所有元素的乘积：</div><div class="line">&gt;&gt;&gt; a.prod()</div><div class="line">720</div><div class="line">&gt;&gt;&gt; np.prod(a, axis=0)</div><div class="line">array([ 4, 10, 18])</div><div class="line"></div><div class="line"># 向量相乘</div><div class="line">&gt;&gt;&gt; a = np.array([1, 2, 3])</div><div class="line">&gt;&gt;&gt; b = np.array([4, 5, 6])</div><div class="line">&gt;&gt;&gt; np.dot(a, b.T)</div><div class="line">32</div><div class="line"></div><div class="line"># 数组元素的累积乘积：</div><div class="line">&gt;&gt;&gt; a.cumprod()</div><div class="line">array([1, 2, 6])</div><div class="line"></div><div class="line"># 全局最小</div><div class="line">&gt;&gt;&gt; a.min()</div><div class="line">0.060</div><div class="line"></div><div class="line"># 沿着某个轴的最小：</div><div class="line">&gt;&gt;&gt; a.min(axis=0)</div><div class="line">array([ 0.076,  0.219,  0.06 ,  0.322])</div><div class="line"></div><div class="line"># 均值</div><div class="line">&gt;&gt;&gt; a = np.array([[1, 2, 3], [4, 5, 6]])</div><div class="line">&gt;&gt;&gt; a.mean()</div><div class="line">3.500</div><div class="line">&gt;&gt;&gt; a.mean(axis=1)</div><div class="line">array([ 2.,  5.])</div><div class="line">&gt;&gt;&gt; np.mean(a)</div><div class="line">3.500</div><div class="line">&gt;&gt;&gt; np.average(a, axis=1)</div><div class="line">array([ 2.,  5.])</div><div class="line">&gt;&gt;&gt; np.average(a, axis=1, weights=[1, 2, 3])</div><div class="line">array([ 2.333,  5.333])</div><div class="line"></div><div class="line"># 标准差</div><div class="line"># 用std方法计算标准差</div><div class="line">&gt;&gt;&gt; a.std(axis=1)</div><div class="line">array([ 0.816,  0.816])</div><div class="line">&gt;&gt;&gt; np.std(a, axis=1)</div><div class="line">array([ 0.816,  0.816])</div><div class="line"></div><div class="line"># 用var方法计算方差</div><div class="line">&gt;&gt;&gt; a.var(axis=1)</div><div class="line">array([ 0.667,  0.667])</div><div class="line">&gt;&gt;&gt; np.var(a, axis=1)</div><div class="line">array([ 0.667,  0.667])</div><div class="line"></div><div class="line"># clip方法</div><div class="line">&gt;&gt;&gt; a</div><div class="line">array([[1, 2, 3],</div><div class="line">       [4, 5, 6]])</div><div class="line"></div><div class="line"># 小于3的变成3，大于5的变成5。</div><div class="line">&gt;&gt;&gt; a.clip(3, 5)</div><div class="line">array([[3, 3, 3],</div><div class="line">       [4, 5, 5]])</div><div class="line"></div><div class="line"># ptp方法</div><div class="line"># 计算最大值和最小值之差：</div><div class="line">&gt;&gt;&gt; a.ptp(axis=1)</div><div class="line">array([2, 2])</div><div class="line"></div><div class="line"># round方法</div><div class="line"># 近似，默认到整数</div><div class="line">&gt;&gt;&gt; a = np.array([1.35, 2.5, 1.5])</div><div class="line">&gt;&gt;&gt; a.round()</div><div class="line">array([ 1.,  2.,  2.])</div><div class="line"></div><div class="line">&gt;&gt;&gt; a.round(decimals=1)</div><div class="line">array([ 1.4,  2.5,  1.5])</div><div class="line"></div><div class="line"># 修改数组的形状</div><div class="line">&gt;&gt;&gt; a = np.arange(6)</div><div class="line">&gt;&gt;&gt; a</div><div class="line">array([0, 1, 2, 3, 4, 5])</div><div class="line">&gt;&gt;&gt; a.shape = 2, 3</div><div class="line">&gt;&gt;&gt; a</div><div class="line">array([[0, 1, 2],</div><div class="line">       [3, 4, 5]])</div><div class="line"></div><div class="line">#与之对应的方法是 reshape ，但它不会修改原来数组的值，而是返回一个新的数组：</div><div class="line">&gt;&gt;&gt; a.reshape(3, 2)</div><div class="line">array([[0, 1],</div><div class="line">       [2, 3],</div><div class="line">       [4, 5]])</div><div class="line">&gt;&gt;&gt; a</div><div class="line">array([[0, 1, 2],</div><div class="line">       [3, 4, 5]])</div><div class="line"></div><div class="line"># shape 和 reshape 方法不能改变数组中元素的总数，否则会报错：</div><div class="line">&gt;&gt;&gt; a.reshape(4, 2)</div><div class="line">---------------------------------------------------------------------------</div><div class="line">ValueError                                Traceback (most recent call last)</div><div class="line">&lt;ipython-input-12-77a6e55c9ee0&gt; in &lt;module&gt;()</div><div class="line">----&gt; 1 a.reshape(4, 2)</div><div class="line">ValueError: cannot reshape array of size 6 into shape (4,2)</div><div class="line"></div><div class="line"># 使用 newaxis 增加数组维数</div><div class="line">&gt;&gt;&gt; a = np.arange(3)</div><div class="line">&gt;&gt;&gt; np.shape(a)</div><div class="line">(3,)</div><div class="line">&gt;&gt;&gt; y = a[np.newaxis, :]</div><div class="line">&gt;&gt;&gt; np.shape(y)</div><div class="line">(1, 3)</div><div class="line">&gt;&gt;&gt; y = a[:, np.newaxis]</div><div class="line">&gt;&gt;&gt; np.shape(y)</div><div class="line">(3, 1)</div><div class="line">&gt;&gt;&gt; y = a[np.newaxis, np.newaxis, :]</div><div class="line">&gt;&gt;&gt; np.shape(y)</div><div class="line">(1, 1, 3)</div><div class="line"></div><div class="line"># squeeze 方法去除多余的轴</div><div class="line"># squeeze 返回一个将所有长度为1的维度去除的新数组。</div><div class="line">&gt;&gt;&gt; a = np.arange(6)</div><div class="line">&gt;&gt;&gt; a.shape = (2, 1, 3)</div><div class="line">&gt;&gt;&gt; b = a.squeeze()</div><div class="line">&gt;&gt;&gt; b.shape</div><div class="line">(2, 3)</div></pre></td></tr></table></figure>
<h2 id="花式索引"><u>花式</u>索引</h2>
<p>切片只能支持连续或者等间隔的切片操作，要想实现任意位置的操作，需要使用花式索引 <code>fancy slicing</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 一维花式索引</span></div><div class="line"><span class="comment"># 与 range 函数类似，我们可以使用 arange 函数来产生等差数组。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.random.rand(<span class="number">10</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line">array([ <span class="number">0.038</span>,  <span class="number">0.752</span>,  <span class="number">0.767</span>,  <span class="number">0.348</span>,  <span class="number">0.112</span>,  <span class="number">0.261</span>,  <span class="number">0.109</span>,  <span class="number">0.695</span>,</div><div class="line">        <span class="number">0.476</span>,  <span class="number">0.266</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>mask = a &gt; <span class="number">0.5</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a[mask]</div><div class="line">array([ <span class="number">0.752</span>,  <span class="number">0.767</span>,  <span class="number">0.695</span>])</div><div class="line"></div><div class="line"><span class="comment"># 二维花式索引</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = array([[ <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],</div><div class="line">           [<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>],</div><div class="line">           [<span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>,<span class="number">25</span>],</div><div class="line">           [<span class="number">30</span>,<span class="number">31</span>,<span class="number">32</span>,<span class="number">33</span>,<span class="number">34</span>,<span class="number">35</span>],</div><div class="line">           [<span class="number">40</span>,<span class="number">41</span>,<span class="number">42</span>,<span class="number">43</span>,<span class="number">44</span>,<span class="number">45</span>],</div><div class="line">           [<span class="number">50</span>,<span class="number">51</span>,<span class="number">52</span>,<span class="number">53</span>,<span class="number">54</span>,<span class="number">55</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line">array([[ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">5</span>],</div><div class="line">       [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>],</div><div class="line">       [<span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>],</div><div class="line">       [<span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">33</span>, <span class="number">34</span>, <span class="number">35</span>],</div><div class="line">       [<span class="number">40</span>, <span class="number">41</span>, <span class="number">42</span>, <span class="number">43</span>, <span class="number">44</span>, <span class="number">45</span>],</div><div class="line">       [<span class="number">50</span>, <span class="number">51</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">54</span>, <span class="number">55</span>]])</div><div class="line"></div><div class="line"><span class="comment"># 对于二维花式索引，我们需要给定 row 和 col 的值：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a[(<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>), (<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)]</div><div class="line">array([ <span class="number">0</span>, <span class="number">11</span>, <span class="number">22</span>, <span class="number">33</span>, <span class="number">44</span>])</div><div class="line"></div><div class="line"><span class="comment"># where语句</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = array([<span class="number">0</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">20</span>])</div><div class="line"></div><div class="line"><span class="comment"># 判断数组中的元素是不是大于10：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a &gt; <span class="number">10</span></div><div class="line">array([<span class="keyword">False</span>,  <span class="keyword">True</span>, <span class="keyword">False</span>,  <span class="keyword">True</span>], dtype=bool)</div><div class="line"></div><div class="line"><span class="comment"># 数组中所有大于10的元素的索引位置：</span></div><div class="line"><span class="comment"># 注意到 where 的返回值是一个元组</span></div><div class="line"><span class="comment"># 使用元组是由于 where 可以对多维数组使用，此时返回值就是多维的。</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>where(a &gt; <span class="number">10</span>)</div><div class="line">(array([<span class="number">1</span>, <span class="number">3</span>]),)</div><div class="line"></div><div class="line"><span class="comment"># 最大最小值的位置</span></div><div class="line"><span class="comment"># 使用argmin, argmax方法</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a.argmin()</div><div class="line"><span class="number">10</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a.argmin(axis=<span class="number">0</span>)</div><div class="line">array([<span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>])</div><div class="line"></div><div class="line"><span class="comment"># 对角线</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([<span class="number">11</span>,<span class="number">21</span>,<span class="number">31</span>,<span class="number">12</span>,<span class="number">22</span>,<span class="number">32</span>,<span class="number">13</span>,<span class="number">23</span>,<span class="number">33</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a.shape = <span class="number">3</span>,<span class="number">3</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line">array([[<span class="number">11</span>, <span class="number">21</span>, <span class="number">31</span>],</div><div class="line">       [<span class="number">12</span>, <span class="number">22</span>, <span class="number">32</span>],</div><div class="line">       [<span class="number">13</span>, <span class="number">23</span>, <span class="number">33</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a.diagonal()</div><div class="line">array([<span class="number">11</span>, <span class="number">22</span>, <span class="number">33</span>])</div><div class="line"></div><div class="line"><span class="comment"># 可以使用偏移来查看它的次对角线，正数表示右移，负数表示左移：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a.diagonal(offset=<span class="number">1</span>)</div><div class="line">array([<span class="number">21</span>, <span class="number">32</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a.diagonal(offset=<span class="number">-1</span>)</div><div class="line">array([<span class="number">12</span>, <span class="number">23</span>])</div><div class="line"></div><div class="line"><span class="comment"># 可以使用花式索引来得到对角线：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>i = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a[i, i]</div><div class="line">array([<span class="number">11</span>, <span class="number">22</span>, <span class="number">33</span>])</div><div class="line"></div><div class="line"><span class="comment"># 可以更新对角线的值：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a[i, i] = <span class="number">2</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line">array([[ <span class="number">2</span>, <span class="number">21</span>, <span class="number">31</span>],</div><div class="line">       [<span class="number">12</span>,  <span class="number">2</span>, <span class="number">32</span>],</div><div class="line">       [<span class="number">13</span>, <span class="number">23</span>,  <span class="number">2</span>]])</div><div class="line"></div><div class="line"><span class="comment"># 数组与字符串的转换</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([[<span class="number">1</span>,<span class="number">1</span>],</div><div class="line">              [<span class="number">3</span>,<span class="number">4</span>]], </div><div class="line">             dtype = np.uint8)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a.tostring()</div><div class="line"><span class="string">b'\x01\x01\x03\x04'</span></div><div class="line"></div><div class="line"><span class="comment"># fromstring 函数</span></div><div class="line"><span class="comment"># 可以使用 fromstring 函数从字符串中读出数据，不过要指定类型：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s = a.tostring()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.fromstring(s,</div><div class="line">                  dtype=np.uint8)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line">array([<span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>], dtype=uint8)</div><div class="line"></div><div class="line"><span class="comment"># 此时，返回的数组是一维的，需要重新设定维度：</span></div><div class="line">&gt;&gt;&gt;a.shape = <span class="number">2</span>, <span class="number">2</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line">array([[<span class="number">1</span>, <span class="number">1</span>],</div><div class="line">       [<span class="number">3</span>, <span class="number">4</span>]], dtype=uint8)</div></pre></td></tr></table></figure>
<table>
<colgroup>
<col style="width: 8%">
<col style="width: 46%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th>基本类型</th>
<th>可用的<strong>Numpy</strong>类型</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>布尔型</td>
<td><code>bool</code></td>
<td>占1个字节</td>
</tr>
<tr class="even">
<td>整型</td>
<td><code>int8, int16, int32, int64, int128, int</code></td>
<td><code>int</code> 跟<strong>C</strong>语言中的 <code>long</code> 一样大</td>
</tr>
<tr class="odd">
<td>无符号整型</td>
<td><code>uint8, uint16, uint32, uint64, uint128, uint</code></td>
<td><code>uint</code> 跟<strong>C</strong>语言中的 <code>unsigned long</code> 一样大</td>
</tr>
<tr class="even">
<td>浮点数</td>
<td><code>float16, float32, float64, float, longfloat</code></td>
<td>默认为双精度 <code>float64</code> ，<code>longfloat</code> 精度大小与系统有关</td>
</tr>
<tr class="odd">
<td>复数</td>
<td><code>complex64, complex128, complex, longcomplex</code></td>
<td>默认为 <code>complex128</code> ，即实部虚部都为双精度</td>
</tr>
<tr class="even">
<td>字符串</td>
<td><code>string, unicode</code></td>
<td>可以使用 <code>dtype=S4</code> 表示一个4字节字符串的数组</td>
</tr>
<tr class="odd">
<td>对象</td>
<td><code>object</code></td>
<td>数组中可以使用任意值</td>
</tr>
<tr class="even">
<td>Records</td>
<td><code>void</code></td>
<td></td>
</tr>
<tr class="odd">
<td>时间</td>
<td><code>datetime64, timedelta64</code></td>
<td></td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 类型转换</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([<span class="number">1</span>, <span class="number">2</span>], dtype=np.float64)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line"></div><div class="line"><span class="comment"># astype方法</span></div><div class="line"><span class="comment"># astype 方法返回一个新数组：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a.astype(np.float64)</div><div class="line">array([ <span class="number">1.</span>,  <span class="number">2.</span>])</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a.astype(np.uint8)</div><div class="line">array([<span class="number">1</span>, <span class="number">2</span>], dtype=uint8)</div><div class="line"></div><div class="line"><span class="comment"># astype 总是返回原来数组的一份复制，即使转换的类型是相同的：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = a.astype(np.float32)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(a)</div><div class="line">[ <span class="number">1.</span>  <span class="number">2.</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(b)</div><div class="line">[ <span class="number">1.</span>  <span class="number">2.</span>]</div><div class="line"></div><div class="line"><span class="comment"># View方法</span></div><div class="line"><span class="comment"># 在numpy.ndarray.view中，提供对内存区域不同的切割方式，来完成数据类型的转换，而无须要对数据进行额外的copy，来节约内存空间。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array((<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>), dtype=np.int32)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line">array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], dtype=int32)</div><div class="line"></div><div class="line"><span class="comment"># view 会将 a 在内存中的表示看成是 uint8 进行解析：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = a.view(np.uint8)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b</div><div class="line"></div><div class="line">array([<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>], dtype=uint8)</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a[<span class="number">0</span>] = <span class="number">2</span>**<span class="number">30</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line">array([<span class="number">1073741824</span>,          <span class="number">2</span>,          <span class="number">3</span>,          <span class="number">4</span>], dtype=int32)</div><div class="line"></div><div class="line"><span class="comment"># 修改 a 会修改 b 的值，因为共用一块内存：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b</div><div class="line">array([ <span class="number">0</span>,  <span class="number">0</span>,  <span class="number">0</span>, <span class="number">64</span>,  <span class="number">2</span>,  <span class="number">0</span>,  <span class="number">0</span>,  <span class="number">0</span>,  <span class="number">3</span>,  <span class="number">0</span>,  <span class="number">0</span>,  <span class="number">0</span>,  <span class="number">4</span>,  <span class="number">0</span>,  <span class="number">0</span>,  <span class="number">0</span>], dtype=uint8)</div></pre></td></tr></table></figure>
<h2 id="数组排序"><u>数组排序</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># sort函数</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>names = np.array([<span class="string">'bob'</span>, <span class="string">'sue'</span>, <span class="string">'jan'</span>, <span class="string">'ad'</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>weights = np.array([<span class="number">20.8</span>, <span class="number">93.2</span>, <span class="number">53.4</span>, <span class="number">61.8</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.sort(weights)</div><div class="line">array([ <span class="number">20.8</span>,  <span class="number">53.4</span>,  <span class="number">61.8</span>,  <span class="number">93.2</span>])</div><div class="line"></div><div class="line"><span class="comment"># argsort函数</span></div><div class="line"><span class="comment"># argsort返回从小到大的排列在数组中索引位置</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>ordered_indices = np.argsort(weights)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>ordered_indices</div><div class="line">array([<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>])</div><div class="line"></div><div class="line"><span class="comment"># 可以用它来进行索引：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>weights[ordered_indices]</div><div class="line">array([ <span class="number">20.8</span>,  <span class="number">53.4</span>,  <span class="number">61.8</span>,  <span class="number">93.2</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>names[ordered_indices]</div><div class="line">array([<span class="string">'bob'</span>, <span class="string">'jan'</span>, <span class="string">'ad'</span>, <span class="string">'sue'</span>],</div><div class="line">      dtype=<span class="string">'&lt;U3'</span>)</div><div class="line"></div><div class="line"><span class="comment"># 使用函数并不会改变原来数组的值：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>weights</div><div class="line">array([ <span class="number">20.8</span>,  <span class="number">93.2</span>,  <span class="number">53.4</span>,  <span class="number">61.8</span>])</div><div class="line"></div><div class="line"><span class="comment"># sort 和 argsort 方法</span></div><div class="line"><span class="comment"># 数组也支持方法操作：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>data = np.array([<span class="number">20.8</span>,  <span class="number">93.2</span>,  <span class="number">53.4</span>,  <span class="number">61.8</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>data.argsort()</div><div class="line">array([<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>])</div><div class="line"></div><div class="line"><span class="comment"># argsort 方法与 argsort 函数的使用没什么区别，也不会改变数组的值。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>data</div><div class="line">array([ <span class="number">20.8</span>,  <span class="number">93.2</span>,  <span class="number">53.4</span>,  <span class="number">61.8</span>])</div><div class="line"></div><div class="line"><span class="comment"># 但是 sort方法会改变数组的值：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>data.sort()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>data</div><div class="line">array([ <span class="number">20.8</span>,  <span class="number">53.4</span>,  <span class="number">61.8</span>,  <span class="number">93.2</span>])</div><div class="line"></div><div class="line"><span class="comment"># 二维数组排序</span></div><div class="line"><span class="comment"># 对于二维数组，默认相当于对每一行进行排序：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([</div><div class="line">        [<span class="number">.2</span>, <span class="number">.1</span>, <span class="number">.5</span>], </div><div class="line">        [<span class="number">.4</span>, <span class="number">.8</span>, <span class="number">.3</span>],</div><div class="line">        [<span class="number">.9</span>, <span class="number">.6</span>, <span class="number">.7</span>]</div><div class="line">    ])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.sort(a)</div><div class="line">array([[ <span class="number">0.1</span>,  <span class="number">0.2</span>,  <span class="number">0.5</span>],</div><div class="line">       [ <span class="number">0.3</span>,  <span class="number">0.4</span>,  <span class="number">0.8</span>],</div><div class="line">       [ <span class="number">0.6</span>,  <span class="number">0.7</span>,  <span class="number">0.9</span>]])</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.sort(a, axis = <span class="number">0</span>)</div><div class="line">array([[ <span class="number">0.2</span>,  <span class="number">0.1</span>,  <span class="number">0.3</span>],</div><div class="line">       [ <span class="number">0.4</span>,  <span class="number">0.6</span>,  <span class="number">0.5</span>],</div><div class="line">       [ <span class="number">0.9</span>,  <span class="number">0.8</span>,  <span class="number">0.7</span>]])</div><div class="line"></div><div class="line"><span class="comment"># searchsorted 函数</span></div><div class="line"><span class="comment"># np.searchsorted(a,b)将b插入原有序数组a，并返回插入元素的索引值</span></div><div class="line"><span class="comment"># searchsorted(sorted_array, values)</span></div><div class="line"><span class="comment"># searchsorted 接受两个参数，其中，第一个必需是已排序的数组。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>sorted_array = np.linspace(<span class="number">0</span>,<span class="number">1</span>,<span class="number">5</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>values = np.array([<span class="number">.1</span>,<span class="number">.8</span>,<span class="number">.3</span>,<span class="number">.12</span>,<span class="number">.5</span>,<span class="number">.25</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.searchsorted(sorted_array, values)</div><div class="line">array([<span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>])</div></pre></td></tr></table></figure>
<h2 id="数组连接"><u>数组连接</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 有时我们需要将不同的数组按照一定的顺序连接起来：</span></div><div class="line"><span class="comment"># concatenate((a0,a1,...,aN), axis=0)</span></div><div class="line"><span class="comment"># 注意，这些数组要用 () 包括到一个元组中去。</span></div><div class="line"><span class="comment"># 除了给定的轴外，这些数组其他轴的长度必须是一样的。</span></div><div class="line">&gt;&gt; x = np.array([</div><div class="line">[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>],</div><div class="line">[<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>]</div><div class="line">])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = np.array([</div><div class="line">[<span class="number">50</span>,<span class="number">51</span>,<span class="number">52</span>],</div><div class="line">[<span class="number">60</span>,<span class="number">61</span>,<span class="number">62</span>]</div><div class="line">])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x.shape)</div><div class="line">(<span class="number">2</span>, <span class="number">3</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(y.shape)</div><div class="line">(<span class="number">2</span>, <span class="number">3</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>z = np.concatenate((x, y))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>z</div><div class="line">array([[ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>],</div><div class="line">[<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>],</div><div class="line">[<span class="number">50</span>, <span class="number">51</span>, <span class="number">52</span>],</div><div class="line">[<span class="number">60</span>, <span class="number">61</span>, <span class="number">62</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>z.shape</div><div class="line">(<span class="number">4</span>, <span class="number">3</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>z = np.concatenate((x,y), axis=<span class="number">1</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>z</div><div class="line">array([[ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">52</span>],</div><div class="line">[<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">60</span>, <span class="number">61</span>, <span class="number">62</span>]])</div><div class="line"></div><div class="line"><span class="comment"># 注意到这里 x 和 y 的形状是一样的，还可以将它们连接成三维的数组，但是 concatenate 不能提供这样的功能，不过可以这样</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>z = np.array((x, y))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>z.shape</div><div class="line">(<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line"></div><div class="line"><span class="comment"># 事实上，Numpy提供了分别对应这三种情况的函数：</span></div><div class="line"><span class="comment"># vstack</span></div><div class="line"><span class="comment"># hstack</span></div><div class="line"><span class="comment"># dstack</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.vstack((x, y)).shape</div><div class="line">(<span class="number">4</span>, <span class="number">3</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.hstack((x, y)).shape</div><div class="line">(<span class="number">2</span>, <span class="number">6</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.dstack((x, y)).shape</div><div class="line">(<span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>)</div><div class="line"></div><div class="line"><span class="comment"># Flatten 数组</span></div><div class="line"><span class="comment"># flatten 方法的作用是将多维数组转化为1维数组：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([[<span class="number">0</span>,<span class="number">1</span>],[<span class="number">2</span>,<span class="number">3</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = a.flatten()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b</div><div class="line">array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</div><div class="line"></div><div class="line"><span class="comment"># 返回的是数组的复制，因此，改变 b 并不会影响 a 的值：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b[<span class="number">0</span>] = <span class="number">10</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(b)</div><div class="line">[<span class="number">10</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(a)</div><div class="line">[[<span class="number">0</span> <span class="number">1</span>]</div><div class="line">[<span class="number">2</span> <span class="number">3</span>]]</div><div class="line"></div><div class="line"><span class="comment"># flat 属性</span></div><div class="line"><span class="comment"># 还可以使用数组自带的 flat 属性：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a.flat</div><div class="line">&lt;numpy.flatiter at <span class="number">0x7f9697941400</span>&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = a.flat</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b[<span class="number">0</span>]</div><div class="line"><span class="number">0</span></div><div class="line"></div><div class="line"><span class="comment"># 但此时修改 b 的值会影响 a ：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b[<span class="number">0</span>] = <span class="number">10</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(a)</div><div class="line">[[<span class="number">10</span>  <span class="number">1</span>]</div><div class="line">[ <span class="number">2</span>  <span class="number">3</span>]]</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a.flat[:]</div><div class="line">array([<span class="number">10</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>])</div><div class="line"></div><div class="line"><span class="comment"># ravel 方法</span></div><div class="line"><span class="comment"># 除此之外，还可以使用 ravel 方法，ravel 使用高效的表示方式：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([[<span class="number">0</span>,<span class="number">1</span>],</div><div class="line">[<span class="number">2</span>,<span class="number">3</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = a.ravel()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b</div><div class="line">array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</div><div class="line"></div><div class="line"><span class="comment"># 修改 b 会改变 a ：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b[<span class="number">0</span>] = <span class="number">10</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line">array([[<span class="number">10</span>,  <span class="number">1</span>],</div><div class="line">[ <span class="number">2</span>,  <span class="number">3</span>]])</div></pre></td></tr></table></figure>
<table>
<thead>
<tr class="header">
<th></th>
<th>作用</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><strong>基本属性</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>a.dtype</code></td>
<td>数组元素类型 <code>float32,uint8,...</code></td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.shape</code></td>
<td>数组形状 <code>(m,n,o,...)</code></td>
<td></td>
</tr>
<tr class="even">
<td><code>a.size</code></td>
<td>数组元素数</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.itemsize</code></td>
<td>每个元素占字节数</td>
<td></td>
</tr>
<tr class="even">
<td><code>a.nbytes</code></td>
<td>所有元素占的字节</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.ndim</code></td>
<td>数组维度</td>
<td></td>
</tr>
<tr class="even">
<td>2</td>
<td><strong>形状相关</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.flat</code></td>
<td>所有元素的迭代器</td>
<td></td>
</tr>
<tr class="even">
<td><code>a.flatten()</code></td>
<td>返回一个1维数组的复制</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.ravel()</code></td>
<td>返回一个1维数组，高效</td>
<td></td>
</tr>
<tr class="even">
<td><code>a.resize(new_size)</code></td>
<td>改变形状</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.swapaxes(axis1, axis2)</code></td>
<td>交换两个维度的位置</td>
<td></td>
</tr>
<tr class="even">
<td><code>a.transpose(*axex)</code></td>
<td>交换所有维度的位置</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.T</code></td>
<td>转置，<code>a.transpose()</code></td>
<td></td>
</tr>
<tr class="even">
<td><code>a.squeeze()</code></td>
<td>去除所有长度为1的维度</td>
<td></td>
</tr>
<tr class="odd">
<td>3</td>
<td><strong>填充复制</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>a.copy()</code></td>
<td>返回数组的一个复制</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.fill(value)</code></td>
<td>将数组的元组设置为特定值</td>
<td></td>
</tr>
<tr class="even">
<td>4</td>
<td><strong>转化</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.tolist()</code></td>
<td>将数组转化为列表</td>
<td></td>
</tr>
<tr class="even">
<td><code>a.tostring()</code></td>
<td>转换为字符串</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.astype(dtype)</code></td>
<td>转化为指定类型</td>
<td></td>
</tr>
<tr class="even">
<td><code>a.byteswap(False)</code></td>
<td>转换大小字节序</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.view(type_or_dtype)</code></td>
<td>生成一个使用相同内存，但使用不同的表示方法的数组</td>
<td></td>
</tr>
<tr class="even">
<td>5</td>
<td><strong>复数</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.imag</code></td>
<td>虚部</td>
<td></td>
</tr>
<tr class="even">
<td><code>a.real</code></td>
<td>实部</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.conjugate()</code></td>
<td>复共轭</td>
<td></td>
</tr>
<tr class="even">
<td><code>a.conj()</code></td>
<td>复共轭（缩写）</td>
<td></td>
</tr>
<tr class="odd">
<td>6</td>
<td><strong>保存</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>a.dump(file)</code></td>
<td>将二进制数据存在file中</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.dump()</code></td>
<td>将二进制数据表示成字符串</td>
<td></td>
</tr>
<tr class="even">
<td><code>a.tofile(fid, sep=&quot;&quot;,format=&quot;%s&quot;)</code></td>
<td>格式化ASCⅡ码写入文件</td>
<td></td>
</tr>
<tr class="odd">
<td>7</td>
<td><strong>查找排序</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>a.nonzero()</code></td>
<td>返回所有非零元素的索引</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.sort(axis=-1)</code></td>
<td>沿某个轴排序</td>
<td></td>
</tr>
<tr class="even">
<td><code>a.argsort(axis=-1)</code></td>
<td>沿某个轴，返回按排序的索引</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.searchsorted(b)</code></td>
<td>返回将b中元素插入a后能保持有序的索引值</td>
<td></td>
</tr>
<tr class="even">
<td>8</td>
<td><strong>元素数学操作</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.clip(low, high)</code></td>
<td>将数值限制在一定范围内</td>
<td></td>
</tr>
<tr class="even">
<td><code>a.round(decimals=0)</code></td>
<td>近似到指定精度</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.cumsum(axis=None)</code></td>
<td>累加和</td>
<td></td>
</tr>
<tr class="even">
<td><code>a.cumprod(axis=None)</code></td>
<td>累乘积</td>
<td></td>
</tr>
<tr class="odd">
<td>9</td>
<td><strong>约简操作</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>a.sum(axis=None)</code></td>
<td>求和</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.prod(axis=None)</code></td>
<td>求积</td>
<td></td>
</tr>
<tr class="even">
<td><code>a.min(axis=None)</code></td>
<td>最小值</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.max(axis=None)</code></td>
<td>最大值</td>
<td></td>
</tr>
<tr class="even">
<td><code>a.argmin(axis=None)</code></td>
<td>最小值索引</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.argmax(axis=None)</code></td>
<td>最大值索引</td>
<td></td>
</tr>
<tr class="even">
<td><code>a.ptp(axis=None)</code></td>
<td>最大值减最小值</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.mean(axis=None)</code></td>
<td>平均值</td>
<td></td>
</tr>
<tr class="even">
<td><code>a.std(axis=None)</code></td>
<td>标准差</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.var(axis=None)</code></td>
<td>方差</td>
<td></td>
</tr>
<tr class="even">
<td><code>a.any(axis=None)</code></td>
<td>只要有一个不为0，返回真，逻辑或</td>
<td></td>
</tr>
<tr class="odd">
<td><code>a.all(axis=None)</code></td>
<td>所有都不为0，返回真，逻辑与</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="生成数组的函数"><u>生成数组的函数</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># arange</span></div><div class="line"><span class="comment"># arange 类似于Python中的 range 函数，只不过返回的不是列表，而是数组：</span></div><div class="line"><span class="comment"># arange(start, stop=None, step=1, dtype=None)</span></div><div class="line"><span class="comment"># 产生一个在区间 [start, stop) 之间，以 step 为间隔的数组，如果只输入一个参数，则默认从 0 开始，并以这个值为结束：</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.arange(<span class="number">4</span>)</div><div class="line">array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.arange(<span class="number">0</span>, <span class="number">2</span> * np.pi, np.pi / <span class="number">4</span>, dtype=np.float32)</div><div class="line">array([ <span class="number">0.</span>        ,  <span class="number">0.78539819</span>,  <span class="number">1.57079637</span>,  <span class="number">2.3561945</span> ,  <span class="number">3.14159274</span>,</div><div class="line"><span class="number">3.92699099</span>,  <span class="number">4.71238899</span>,  <span class="number">5.49778748</span>], dtype=float32)</div><div class="line"></div><div class="line"><span class="comment"># linspace</span></div><div class="line"><span class="comment"># linspace(start, stop, N)</span></div><div class="line"><span class="comment"># 产生 N 个等距分布在 [start, stop]间的元素组成的数组，包括 start, stop。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.linspace(<span class="number">0</span>, <span class="number">1</span>, <span class="number">5</span>)</div><div class="line">array([ <span class="number">0.</span>  ,  <span class="number">0.25</span>,  <span class="number">0.5</span> ,  <span class="number">0.75</span>,  <span class="number">1.</span>  ])</div><div class="line"></div><div class="line"><span class="comment"># logspace</span></div><div class="line"><span class="comment"># logspace(start, stop, N)</span></div><div class="line"><span class="comment"># 产生 N 个对数等距分布的数组，默认以10为底：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.logspace(<span class="number">0</span>, <span class="number">1</span>, <span class="number">5</span>)</div><div class="line">array([  <span class="number">1.</span>        ,   <span class="number">1.77827941</span>,   <span class="number">3.16227766</span>,   <span class="number">5.62341325</span>,  <span class="number">10.</span>        ])</div><div class="line"></div><div class="line"><span class="comment"># 根据d0‐dn创建随机数数组，浮点数，[0,1)，均匀分布</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.random.rand(<span class="number">3</span>, <span class="number">2</span>)</div><div class="line">array([[ <span class="number">0.88566206</span>,  <span class="number">0.71092156</span>],</div><div class="line">           [ <span class="number">0.94005391</span>,  <span class="number">0.75231539</span>],</div><div class="line">           [ <span class="number">0.99611423</span>,  <span class="number">0.49588566</span>]])</div><div class="line">    </div><div class="line"><span class="comment"># 根据d0‐dn创建随机数数组，标准正态分布</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.random.randn(<span class="number">3</span>, <span class="number">2</span>)</div><div class="line">array([[<span class="number">-1.49263103</span>,  <span class="number">1.63580369</span>],</div><div class="line">       [ <span class="number">0.77204866</span>, <span class="number">-0.57062831</span>],</div><div class="line">       [ <span class="number">2.02303328</span>,  <span class="number">0.64933858</span>]])</div><div class="line">   </div><div class="line"><span class="comment"># 根据shape创建随机整数或整数数组，范围是[low, high)</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.random.randint(<span class="number">0</span>, <span class="number">10</span>, <span class="number">10</span>)</div><div class="line">array([<span class="number">5</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">7</span>])</div><div class="line">    </div><div class="line"><span class="comment"># 产生具有均匀分布的数组,low起始值,high结束值,size形状</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.random.uniform(<span class="number">0</span>, <span class="number">10</span>, <span class="number">10</span>)</div><div class="line">array([ <span class="number">3.98729593</span>,  <span class="number">6.20785784</span>,  <span class="number">9.88251234</span>,  <span class="number">8.18865593</span>,  <span class="number">4.61860861</span>,</div><div class="line">            <span class="number">1.93754827</span>,  <span class="number">7.41036467</span>,  <span class="number">2.25263852</span>,  <span class="number">1.73823997</span>,  <span class="number">9.01397509</span>])</div><div class="line">    </div><div class="line"><span class="comment"># 产生具有正态分布的数组,loc均值,scale标准差,size形状</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.random.normal(<span class="number">0</span>, <span class="number">1</span>, <span class="number">10</span>)</div><div class="line">array([<span class="number">-1.77645582</span>, <span class="number">-0.58749155</span>,  <span class="number">1.64583161</span>, <span class="number">-0.33985803</span>, <span class="number">-1.64874287</span>,</div><div class="line">            <span class="number">1.31479628</span>,  <span class="number">0.85718997</span>, <span class="number">-0.8064355</span> , <span class="number">-0.50728188</span>,  <span class="number">0.64662307</span>])</div><div class="line">    </div><div class="line"><span class="comment"># 产生具有泊松分布的数组,lam随机事件发生率,size形状</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.random.poisson(<span class="number">0.5</span>, <span class="number">10</span>)</div><div class="line">array([<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>])</div><div class="line"></div><div class="line"><span class="comment"># meshgrid</span></div><div class="line"><span class="comment"># 有时候需要在二维平面中生成一个网格，这时候可以使用 meshgrid 来完成这样的工作：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x_ticks = np.linspace(<span class="number">-1</span>, <span class="number">1</span>, <span class="number">5</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y_ticks = np.linspace(<span class="number">-1</span>, <span class="number">1</span>, <span class="number">5</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x, y = np.meshgrid(x_ticks, y_ticks)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x</div><div class="line">array([[<span class="number">-1.</span> , <span class="number">-0.5</span>,  <span class="number">0.</span> ,  <span class="number">0.5</span>,  <span class="number">1.</span> ],</div><div class="line">       [<span class="number">-1.</span> , <span class="number">-0.5</span>,  <span class="number">0.</span> ,  <span class="number">0.5</span>,  <span class="number">1.</span> ],</div><div class="line">       [<span class="number">-1.</span> , <span class="number">-0.5</span>,  <span class="number">0.</span> ,  <span class="number">0.5</span>,  <span class="number">1.</span> ],</div><div class="line">       [<span class="number">-1.</span> , <span class="number">-0.5</span>,  <span class="number">0.</span> ,  <span class="number">0.5</span>,  <span class="number">1.</span> ],</div><div class="line">       [<span class="number">-1.</span> , <span class="number">-0.5</span>,  <span class="number">0.</span> ,  <span class="number">0.5</span>,  <span class="number">1.</span> ]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y</div><div class="line">array([[<span class="number">-1.</span> , <span class="number">-1.</span> , <span class="number">-1.</span> , <span class="number">-1.</span> , <span class="number">-1.</span> ],</div><div class="line">       [<span class="number">-0.5</span>, <span class="number">-0.5</span>, <span class="number">-0.5</span>, <span class="number">-0.5</span>, <span class="number">-0.5</span>],</div><div class="line">       [ <span class="number">0.</span> ,  <span class="number">0.</span> ,  <span class="number">0.</span> ,  <span class="number">0.</span> ,  <span class="number">0.</span> ],</div><div class="line">       [ <span class="number">0.5</span>,  <span class="number">0.5</span>,  <span class="number">0.5</span>,  <span class="number">0.5</span>,  <span class="number">0.5</span>],</div><div class="line">       [ <span class="number">1.</span> ,  <span class="number">1.</span> ,  <span class="number">1.</span> ,  <span class="number">1.</span> ,  <span class="number">1.</span> ]])</div><div class="line"></div><div class="line"><span class="comment"># ones , zeros</span></div><div class="line"><span class="comment"># ones(shape, dtype=float64)</span></div><div class="line"><span class="comment"># zeros(shape, dtype=float64)</span></div><div class="line"><span class="comment"># 产生一个制定形状的全 0 或全 1 的数组，还可以制定数组类型：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.zeros(<span class="number">3</span>)</div><div class="line">array([ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.ones([<span class="number">2</span>, <span class="number">3</span>], dtype=np.float32)</div><div class="line">array([[ <span class="number">1.</span>,  <span class="number">1.</span>,  <span class="number">1.</span>],</div><div class="line">       [ <span class="number">1.</span>,  <span class="number">1.</span>,  <span class="number">1.</span>]], dtype=float32)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.ones([<span class="number">2</span>, <span class="number">3</span>]) * <span class="number">5</span></div><div class="line">array([[ <span class="number">5.</span>,  <span class="number">5.</span>,  <span class="number">5.</span>],</div><div class="line">       [ <span class="number">5.</span>,  <span class="number">5.</span>,  <span class="number">5.</span>]])</div><div class="line"></div><div class="line"><span class="comment"># empty</span></div><div class="line"><span class="comment"># empty(shape, dtype=float64, order='C')</span></div><div class="line"><span class="comment"># 也可以使用 empty 方法产生一个制定大小的数组（数组所指向的内存未被初始化，所以值随机），再用 fill 方法填充：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.empty(<span class="number">2</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line">array([  <span class="number">4.94065646e-324</span>,   <span class="number">9.88131292e-324</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a.fill(<span class="number">5</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line">array([ <span class="number">5.</span>,  <span class="number">5.</span>])</div><div class="line"></div><div class="line"><span class="comment"># empty_like, ones_like, zeros_like</span></div><div class="line"><span class="comment"># empty_like(a)</span></div><div class="line"><span class="comment"># ones_like(a)</span></div><div class="line"><span class="comment"># zeros_like(a)</span></div><div class="line"><span class="comment"># 产生一个跟 a 大小一样，类型一样的对应数组。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.arange(<span class="number">0</span>, <span class="number">10</span>, <span class="number">2.5</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line">array([ <span class="number">0.</span> ,  <span class="number">2.5</span>,  <span class="number">5.</span> ,  <span class="number">7.5</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.empty_like(a)</div><div class="line">array([   <span class="number">0.</span>  ,    <span class="number">0.</span>  ,  <span class="number">356.2</span> ,  <span class="number">238.84</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.zeros_like(a)</div><div class="line">array([ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.ones_like(a)</div><div class="line">array([ <span class="number">1.</span>,  <span class="number">1.</span>,  <span class="number">1.</span>,  <span class="number">1.</span>])</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">%matplotlib inline</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</div><div class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> cm</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x, y)</span>:</span></div><div class="line">    r = np.sqrt(x ** <span class="number">2</span> + y ** <span class="number">2</span>)</div><div class="line">    result = np.sin(r) / r</div><div class="line">    result[r == <span class="number">0</span>] = <span class="number">1.0</span></div><div class="line">    <span class="keyword">return</span> result</div><div class="line"></div><div class="line">x_ticks = np.linspace(<span class="number">-10</span>, <span class="number">10</span>, <span class="number">51</span>)</div><div class="line">y_ticks = np.linspace(<span class="number">-10</span>, <span class="number">10</span>, <span class="number">51</span>)</div><div class="line"></div><div class="line">x, y = np.meshgrid(x_ticks, y_ticks)</div><div class="line"></div><div class="line">z = f(x, y)</div><div class="line"></div><div class="line">fig = plt.figure()</div><div class="line">ax = fig.add_subplot(<span class="number">111</span>, projection=<span class="string">'3d'</span>)</div><div class="line">ax.plot_surface(x, y, z,</div><div class="line">                rstride=<span class="number">1</span>, cstride=<span class="number">1</span>,</div><div class="line">                cmap=cm.YlGnBu_r)</div><div class="line">ax.set_xlabel(<span class="string">'x'</span>)</div><div class="line">ax.set_ylabel(<span class="string">'y'</span>)</div><div class="line">ax.set_zlabel(<span class="string">'z'</span>)</div></pre></td></tr></table></figure>
<figure>
<img src="/images/output_241_2.png" alt="output_241_2"><figcaption>output_241_2</figcaption>
</figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 事实上，x, y 中有很多冗余的元素，这里提供了一个 sparse 的选项：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x_ticks = np.linspace(<span class="number">-1</span>, <span class="number">1</span>, <span class="number">5</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y_ticks = np.linspace(<span class="number">-1</span>, <span class="number">1</span>, <span class="number">5</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x, y = np.meshgrid(x_ticks, y_ticks, sparse=<span class="keyword">True</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x</div><div class="line">array([[<span class="number">-1.</span> , <span class="number">-0.5</span>,  <span class="number">0.</span> ,  <span class="number">0.5</span>,  <span class="number">1.</span> ]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y</div><div class="line">array([[<span class="number">-1.</span> ],</div><div class="line">[<span class="number">-0.5</span>],</div><div class="line">[ <span class="number">0.</span> ],</div><div class="line">[ <span class="number">0.5</span>],</div><div class="line">[ <span class="number">1.</span> ]])</div></pre></td></tr></table></figure>
<p>在这个选项下，x, y 变成了单一的行向量和列向量，但这并不影响结果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">x_ticks = np.linspace(<span class="number">-10</span>, <span class="number">10</span>, <span class="number">51</span>)</div><div class="line">y_ticks = np.linspace(<span class="number">-10</span>, <span class="number">10</span>, <span class="number">51</span>)</div><div class="line"></div><div class="line">x, y = np.meshgrid(x_ticks, y_ticks, sparse=<span class="keyword">True</span>)</div><div class="line"></div><div class="line">z = f(x, y)</div><div class="line"></div><div class="line">fig = plt.figure()</div><div class="line">ax = fig.add_subplot(<span class="number">111</span>, projection=<span class="string">'3d'</span>)</div><div class="line">ax.plot_surface(x, y, z, </div><div class="line">               rstride=<span class="number">1</span>, cstride=<span class="number">1</span>,</div><div class="line">               cmap=cm.YlGnBu_r)</div><div class="line">ax.set_xlabel(<span class="string">'x'</span>)</div><div class="line">ax.set_ylabel(<span class="string">'y'</span>)</div><div class="line">ax.set_zlabel(<span class="string">'z'</span>)</div></pre></td></tr></table></figure>
<figure>
<img src="/images/output_241_2.png" alt="output_241_2"><figcaption>output_241_2</figcaption>
</figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># r_ , c_</span></div><div class="line"><span class="comment"># 我们可以使用 r_ / c_ 来产生行向量或者列向量。</span></div><div class="line"><span class="comment"># 使用切片产生：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.r_[<span class="number">0</span>:<span class="number">1</span>:<span class="number">.1</span>]</div><div class="line">array([ <span class="number">0.</span> ,  <span class="number">0.1</span>,  <span class="number">0.2</span>,  <span class="number">0.3</span>,  <span class="number">0.4</span>,  <span class="number">0.5</span>,  <span class="number">0.6</span>,  <span class="number">0.7</span>,  <span class="number">0.8</span>,  <span class="number">0.9</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.c_[<span class="number">0</span>:<span class="number">1</span>:<span class="number">.1</span>]</div><div class="line">array([[ <span class="number">0.</span> ],</div><div class="line">[ <span class="number">0.1</span>],</div><div class="line">[ <span class="number">0.2</span>],</div><div class="line">[ <span class="number">0.3</span>],</div><div class="line">[ <span class="number">0.4</span>],</div><div class="line">[ <span class="number">0.5</span>],</div><div class="line">[ <span class="number">0.6</span>],</div><div class="line">[ <span class="number">0.7</span>],</div><div class="line">[ <span class="number">0.8</span>],</div><div class="line">[ <span class="number">0.9</span>]])</div></pre></td></tr></table></figure>
<h2 id="矩阵"><u>矩阵</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># identity</span></div><div class="line"><span class="comment"># indentity(n, dtype=float64)</span></div><div class="line"><span class="comment"># 产生一个 n 乘 n 的单位矩阵：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.identity(<span class="number">3</span>)</div><div class="line">array([[ <span class="number">1.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>],</div><div class="line">[ <span class="number">0.</span>,  <span class="number">1.</span>,  <span class="number">0.</span>],</div><div class="line">[ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">1.</span>]])</div><div class="line"></div><div class="line"><span class="comment"># 使用 mat 方法将 2 维数组转化为矩阵：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>],</div><div class="line">[<span class="number">2</span>,<span class="number">5</span>,<span class="number">3</span>], </div><div class="line">[<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>A = np.mat(a)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>A</div><div class="line">matrix([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>],</div><div class="line">[<span class="number">2</span>, <span class="number">5</span>, <span class="number">3</span>],</div><div class="line">[<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</div><div class="line"></div><div class="line"><span class="comment"># 也可以使用 Matlab 的语法传入一个字符串来生成矩阵：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>A = np.mat(<span class="string">'1, 2, 3; 2, 5, 3; 7, 8, 9'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>A</div><div class="line">matrix([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</div><div class="line">[<span class="number">2</span>, <span class="number">5</span>, <span class="number">3</span>],</div><div class="line">[<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</div><div class="line"></div><div class="line"><span class="comment"># 利用分块创造新的矩阵：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([[ <span class="number">1</span>, <span class="number">2</span>],</div><div class="line">[<span class="number">3</span>, <span class="number">4</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = np.array([[<span class="number">10</span>,<span class="number">20</span>], </div><div class="line">[<span class="number">30</span>,<span class="number">40</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.bmat(<span class="string">'a, b; b, a'</span>)</div><div class="line">matrix([[ <span class="number">1</span>,  <span class="number">2</span>, <span class="number">10</span>, <span class="number">20</span>],</div><div class="line">[ <span class="number">3</span>,  <span class="number">4</span>, <span class="number">30</span>, <span class="number">40</span>],</div><div class="line">[<span class="number">10</span>, <span class="number">20</span>,  <span class="number">1</span>,  <span class="number">2</span>],</div><div class="line">[<span class="number">30</span>, <span class="number">40</span>,  <span class="number">3</span>,  <span class="number">4</span>]])</div><div class="line"></div><div class="line"><span class="comment"># 矩阵与向量的乘法：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = np.array([[<span class="number">1</span>], [<span class="number">2</span>], [<span class="number">3</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x</div><div class="line">array([[<span class="number">1</span>],</div><div class="line">[<span class="number">2</span>],</div><div class="line">[<span class="number">3</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>A * x</div><div class="line">matrix([[<span class="number">14</span>],</div><div class="line">[<span class="number">21</span>],</div><div class="line">[<span class="number">50</span>]])</div><div class="line"></div><div class="line"><span class="comment"># A.I 表示 A 矩阵的逆矩阵：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(A * A.I)</div><div class="line">[[  <span class="number">1.00000000e+00</span>   <span class="number">2.77555756e-17</span>   <span class="number">0.00000000e+00</span>]</div><div class="line">[  <span class="number">0.00000000e+00</span>   <span class="number">1.00000000e+00</span>   <span class="number">2.77555756e-17</span>]</div><div class="line">[  <span class="number">0.00000000e+00</span>   <span class="number">0.00000000e+00</span>   <span class="number">1.00000000e+00</span>]]</div><div class="line"></div><div class="line"><span class="comment"># 矩阵指数表示矩阵连乘：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(A ** <span class="number">4</span>)</div><div class="line">[[ <span class="number">4960</span>  <span class="number">7380</span>  <span class="number">7200</span>]</div><div class="line">[ <span class="number">6735</span> <span class="number">10045</span>  <span class="number">9780</span>]</div><div class="line">[<span class="number">17230</span> <span class="number">25650</span> <span class="number">25020</span>]]</div><div class="line"></div><div class="line"><span class="comment"># 创建n*n维单位矩阵：np.eye(n)</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.eye(<span class="number">4</span>)</div><div class="line">array([[ <span class="number">1.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>],</div><div class="line">[ <span class="number">0.</span>,  <span class="number">1.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>],</div><div class="line">[ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">1.</span>,  <span class="number">0.</span>],</div><div class="line">[ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">1.</span>]])</div><div class="line"></div><div class="line"><span class="comment"># 计算协方差矩阵</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.cov(A)</div><div class="line">array([[ <span class="number">1.</span>        ,  <span class="number">0.5</span>       ,  <span class="number">1.</span>        ],</div><div class="line">[ <span class="number">0.5</span>       ,  <span class="number">2.33333333</span>,  <span class="number">0.5</span>       ],</div><div class="line">[ <span class="number">1.</span>        ,  <span class="number">0.5</span>       ,  <span class="number">1.</span>        ]])</div><div class="line"></div><div class="line"><span class="comment"># 计算矩阵的迹（对角线元素和）：a.trace()</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>A.trace()</div><div class="line">matrix([[<span class="number">15</span>]])</div><div class="line"></div><div class="line"><span class="comment"># 相关系数</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.corrcoef(A, A.I)</div><div class="line">array([[  <span class="number">1.00000000e+00</span>,   <span class="number">3.27326835e-01</span>,   <span class="number">1.00000000e+00</span>,</div><div class="line"><span class="number">1.00000000e+00</span>,   <span class="number">9.61481343e-17</span>,  <span class="number">-7.55928946e-01</span>],</div><div class="line">[  <span class="number">3.27326835e-01</span>,   <span class="number">1.00000000e+00</span>,   <span class="number">3.27326835e-01</span>,</div><div class="line"><span class="number">3.27326835e-01</span>,   <span class="number">9.44911183e-01</span>,  <span class="number">-8.66025404e-01</span>],</div><div class="line">[  <span class="number">1.00000000e+00</span>,   <span class="number">3.27326835e-01</span>,   <span class="number">1.00000000e+00</span>,</div><div class="line"><span class="number">1.00000000e+00</span>,   <span class="number">9.61481343e-17</span>,  <span class="number">-7.55928946e-01</span>],</div><div class="line">[  <span class="number">1.00000000e+00</span>,   <span class="number">3.27326835e-01</span>,   <span class="number">1.00000000e+00</span>,</div><div class="line"><span class="number">1.00000000e+00</span>,   <span class="number">3.20493781e-17</span>,  <span class="number">-7.55928946e-01</span>],</div><div class="line">[  <span class="number">9.61481343e-17</span>,   <span class="number">9.44911183e-01</span>,   <span class="number">9.61481343e-17</span>,</div><div class="line"><span class="number">3.20493781e-17</span>,   <span class="number">1.00000000e+00</span>,  <span class="number">-6.54653671e-01</span>],</div><div class="line">[ <span class="number">-7.55928946e-01</span>,  <span class="number">-8.66025404e-01</span>,  <span class="number">-7.55928946e-01</span>,</div><div class="line"><span class="number">-7.55928946e-01</span>,  <span class="number">-6.54653671e-01</span>,   <span class="number">1.00000000e+00</span>]])</div><div class="line"></div><div class="line"><span class="comment"># 获取矩阵对角线的元素</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>A.diagonal()</div><div class="line">matrix([[<span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>]])</div></pre></td></tr></table></figure>
<h2 id="ufunc-对象"><u>ufunc 对象</u></h2>
<p>Numpy 有两种基本对象：ndarray (N-dimensional array object) 和 ufunc (universal function object)。ndarray 是存储单一数据类型的多维数组，而 ufunc 则是能够对数组进行处理的函数。</p>
<p>例如，我们之前所接触到的二元操作符对应的 Numpy 函数，如 add，就是一种 ufunc 对象，它可以作用于数组的每个元素。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = np.array([<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.add(a, b)</div><div class="line">array([<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>])</div></pre></td></tr></table></figure>
<p>查看支持的方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>dir(np.add)</div><div class="line">[<span class="string">'__call__'</span>,</div><div class="line"> <span class="string">'__class__'</span>,</div><div class="line"> <span class="string">'__delattr__'</span>,</div><div class="line"> <span class="string">'__dir__'</span>,</div><div class="line"> <span class="string">'__doc__'</span>,</div><div class="line"> <span class="string">'__eq__'</span>,</div><div class="line"> <span class="string">'__format__'</span>,</div><div class="line"> <span class="string">'__ge__'</span>,</div><div class="line"> <span class="string">'__getattribute__'</span>,</div><div class="line"> <span class="string">'__gt__'</span>,</div><div class="line"> <span class="string">'__hash__'</span>,</div><div class="line"> <span class="string">'__init__'</span>,</div><div class="line"> <span class="string">'__le__'</span>,</div><div class="line"> <span class="string">'__lt__'</span>,</div><div class="line"> <span class="string">'__name__'</span>,</div><div class="line"> <span class="string">'__ne__'</span>,</div><div class="line"> <span class="string">'__new__'</span>,</div><div class="line"> <span class="string">'__reduce__'</span>,</div><div class="line"> <span class="string">'__reduce_ex__'</span>,</div><div class="line"> <span class="string">'__repr__'</span>,</div><div class="line"> <span class="string">'__setattr__'</span>,</div><div class="line"> <span class="string">'__sizeof__'</span>,</div><div class="line"> <span class="string">'__str__'</span>,</div><div class="line"> <span class="string">'__subclasshook__'</span>,</div><div class="line"> <span class="string">'accumulate'</span>,</div><div class="line"> <span class="string">'at'</span>,</div><div class="line"> <span class="string">'identity'</span>,</div><div class="line"> <span class="string">'nargs'</span>,</div><div class="line"> <span class="string">'nin'</span>,</div><div class="line"> <span class="string">'nout'</span>,</div><div class="line"> <span class="string">'ntypes'</span>,</div><div class="line"> <span class="string">'outer'</span>,</div><div class="line"> <span class="string">'reduce'</span>,</div><div class="line"> <span class="string">'reduceat'</span>,</div><div class="line"> <span class="string">'signature'</span>,</div><div class="line"> <span class="string">'types'</span>]</div></pre></td></tr></table></figure>
<p>除此之外，大部分能够作用于数组的数学函数如三角函数等，都是 ufunc 对象。特别地，对于二元操作符所对应的 ufunc 对象，支持以下方法：</p>
<h3 id="reduce-方法"><u>reduce 方法</u></h3>
<p><code>op.reduce(a)</code></p>
<p>将<code>op</code>沿着某个轴应用，使得数组 <code>a</code> 的维数降低一维。 <code>add</code> 作用到一维数组上相当于求和： <span class="math display">\[
\begin{align}
y &amp; = add.recuce(a) \\
&amp; = a[0] + a[1] + ... + a[N-1] \\
&amp; = \sum_{n=0}^{N-1} a[n]
\end{align}
\]</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.add.reduce(a)</div><div class="line"><span class="number">10</span></div><div class="line"></div><div class="line"><span class="comment"># 多维数组默认只按照第一维进行运算：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.add.reduce(a)</div><div class="line">array([<span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.add.reduce(a, <span class="number">1</span>)</div><div class="line">array([ <span class="number">6</span>, <span class="number">15</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([<span class="string">'ab'</span>, <span class="string">'cd'</span>, <span class="string">'ef'</span>], np.object)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.add.reduce(a)</div><div class="line"><span class="string">'abcdef'</span></div></pre></td></tr></table></figure>
<h2 id="accumulate-方法">accumulate 方法</h2>
<p><code>op.accumulate(a)</code></p>
<p><code>accumulate</code> 可以看成保存 <code>reduce</code> 每一步的结果所形成的数组。 <span class="math display">\[
\begin{align}
y &amp; = add.accumulate(a) \\
&amp; = \left[\sum_{n=0}^{0} a[n], \sum_{n=0}^{1} a[n], ..., \sum_{n=0}^{N-1} a[n]\right]
\end{align}
\]</span> 与之前类似：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.add.accumulate(a)</div><div class="line">array([ <span class="number">1</span>,  <span class="number">3</span>,  <span class="number">6</span>, <span class="number">10</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([<span class="string">'ab'</span>, <span class="string">'cd'</span>, <span class="string">'ef'</span>], np.object)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.add.accumulate(a)</div><div class="line">array([<span class="string">'ab'</span>, <span class="string">'abcd'</span>, <span class="string">'abcdef'</span>], dtype=object)</div></pre></td></tr></table></figure>
<h2 id="reduceat-方法">reduceat 方法</h2>
<p><code>op.reduceat(a, indices)</code></p>
<p><code>reduceat</code> 方法将操作符运用到指定的下标上，返回一个与 <code>indices</code> 大小相同的数组： <span class="math display">\[
\begin{align}
y &amp; = add.reduceat(a, indices) \\
&amp; = \left[\sum_{n=indice[0]}^{indice[1]-1} a[n], \sum_{n=indice[1]}^{indice[2]-1} a[n], ..., \sum_{n=indice[-1]}^{N-1} a[n]\right]
\end{align}
\]</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([<span class="number">0</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>indices = np.array([<span class="number">1</span>,<span class="number">4</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.add.reduceat(a, indices)</div><div class="line">array([<span class="number">60</span>, <span class="number">90</span>])</div></pre></td></tr></table></figure>
<p>这里，<code>indices</code> 为 <code>[1, 4]</code>，所以 <code>60</code> 表示从下标1（包括）加到下标4（不包括）的结果，<code>90</code> 表示从下标4（包括）加到结尾的结果。</p>
<h2 id="outer-方法">outer 方法</h2>
<p><code>op.outer(a, b)</code></p>
<p>对于 <code>a</code> 中每个元素，将 <code>op</code> 运用到它和 <code>b</code> 的每一个元素上所得到的结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([<span class="number">0</span>,<span class="number">1</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.add.outer(a, b)</div><div class="line">array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</div><div class="line">       [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]])</div></pre></td></tr></table></figure>
<p>注意有顺序的区别：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.add.outer(b, a)</div><div class="line">array([[<span class="number">1</span>, <span class="number">2</span>],</div><div class="line">       [<span class="number">2</span>, <span class="number">3</span>],</div><div class="line">       [<span class="number">3</span>, <span class="number">4</span>]])</div></pre></td></tr></table></figure>
<h2 id="choose-函数实现条件筛选"><u>choose 函数实现条件筛选</u></h2>
<p>对于数组，我们有时候需要进行类似 switch 和 case 进行条件选择，此时使用 choose 函数十分方便</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>control = np.array([[<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>],</div><div class="line">                    [<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>],</div><div class="line">                    [<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>]])</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.choose(control, [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>])</div><div class="line">array([[<span class="number">11</span>, <span class="number">10</span>, <span class="number">11</span>],</div><div class="line">       [<span class="number">12</span>, <span class="number">11</span>, <span class="number">10</span>],</div><div class="line">       [<span class="number">11</span>, <span class="number">12</span>, <span class="number">12</span>]])</div><div class="line"></div><div class="line"><span class="comment"># 下面的例子将数组中所有小于 10 的值变成了 10。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([[ <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], </div><div class="line">              [<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>], </div><div class="line">              [<span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a &lt; <span class="number">10</span></div><div class="line">array([[ <span class="keyword">True</span>,  <span class="keyword">True</span>,  <span class="keyword">True</span>],</div><div class="line">       [<span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">False</span>],</div><div class="line">       [<span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">False</span>]], dtype=bool)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.choose(a &lt; <span class="number">10</span>, (a, <span class="number">10</span>))</div><div class="line">array([[<span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>],</div><div class="line">       [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>],</div><div class="line">       [<span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>]])</div></pre></td></tr></table></figure>
<h2 id="数组广播机制"><u>数组广播机制</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([[ <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</div><div class="line">              [<span class="number">10</span>,<span class="number">10</span>,<span class="number">10</span>],</div><div class="line">              [<span class="number">20</span>,<span class="number">20</span>,<span class="number">20</span>],</div><div class="line">              [<span class="number">30</span>,<span class="number">30</span>,<span class="number">30</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = np.array([[ <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>],</div><div class="line">              [ <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>],</div><div class="line">              [ <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>],</div><div class="line">              [ <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a + b</div><div class="line">array([[ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>],</div><div class="line">       [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>],</div><div class="line">       [<span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>],</div><div class="line">       [<span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>]])</div><div class="line"></div><div class="line"><span class="comment"># 将 b 的值变成一维的 [0,1,2] 之后的加法：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = np.array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a + b</div><div class="line">array([[ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>],</div><div class="line">           [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>],</div><div class="line">           [<span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>],</div><div class="line">           [<span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>]])</div><div class="line">    </div><div class="line"><span class="comment"># 结果一样，虽然两个数组的维数不一样，但是 Numpy 检测到 b 的维度与 a 的维度匹配，所以将 b 扩展为之前的形式，得到相同的形状。</span></div><div class="line"><span class="comment"># 对于更高维度，这样的扩展依然有效。</span></div></pre></td></tr></table></figure>
<h2 id="数组读写"><u>数组读写</u></h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>%%writefile myfile.txt</div><div class="line"><span class="number">2.1</span> <span class="number">2.3</span> <span class="number">3.2</span> <span class="number">1.3</span> <span class="number">3.1</span></div><div class="line"><span class="number">6.1</span> <span class="number">3.1</span> <span class="number">4.2</span> <span class="number">2.3</span> <span class="number">1.8</span></div><div class="line">Writing myfile.txt</div><div class="line"></div><div class="line"><span class="comment"># 为了生成数组，我们首先将数据转化成一个列表组成的列表，再将这个列表转换为数组：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>data = []</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">with</span> open(<span class="string">'myfile.txt'</span>) <span class="keyword">as</span> f:</div><div class="line">    	<span class="keyword">for</span> line <span class="keyword">in</span> f:</div><div class="line">        	fileds = line.split()</div><div class="line">        	row_data = [float(x) <span class="keyword">for</span> x <span class="keyword">in</span> fileds]</div><div class="line">        	data.append(row_data)</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>data = np.array(data)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>data</div><div class="line">array([[ <span class="number">2.1</span>,  <span class="number">2.3</span>,  <span class="number">3.2</span>,  <span class="number">1.3</span>,  <span class="number">3.1</span>],</div><div class="line">               [ <span class="number">6.1</span>,  <span class="number">3.1</span>,  <span class="number">4.2</span>,  <span class="number">2.3</span>,  <span class="number">1.8</span>]])</div><div class="line"></div><div class="line"><span class="comment"># 不过，更简便的是使用 loadtxt 方法：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>data = np.loadtxt(<span class="string">'myfile.txt'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>data</div><div class="line">array([[ <span class="number">2.1</span>,  <span class="number">2.3</span>,  <span class="number">3.2</span>,  <span class="number">1.3</span>,  <span class="number">3.1</span>],</div><div class="line">       [ <span class="number">6.1</span>,  <span class="number">3.1</span>,  <span class="number">4.2</span>,  <span class="number">2.3</span>,  <span class="number">1.8</span>]])</div><div class="line"></div><div class="line"><span class="comment"># 将数组写入文件</span></div><div class="line"><span class="comment"># savetxt 可以将数组写入文件，默认使用科学计数法的形式保存：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>data = np.array([[<span class="number">1</span>,<span class="number">2</span>], </div><div class="line">                 [<span class="number">3</span>,<span class="number">4</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.savetxt(<span class="string">'out.txt'</span>, data)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">with</span> open(<span class="string">'out.txt'</span>) <span class="keyword">as</span> f:</div><div class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f:</div><div class="line">            print(line, end=<span class="string">','</span>)</div><div class="line"></div><div class="line"><span class="number">1.000000000000000000e+00</span> <span class="number">2.000000000000000000e+00</span></div><div class="line">,<span class="number">3.000000000000000000e+00</span> <span class="number">4.000000000000000000e+00</span></div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/pandas.jpeg"
               alt="Peter Tsung" />
          <p class="site-author-name" itemprop="name">Peter Tsung</p>
           
              <p class="site-description motion-element" itemprop="description">I Never Save Anything For The Swim Back.</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">36</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Peter Tsung</span>
</div>

<!--
<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>
<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
            tex2jax: { inlineMath: [ ["$", "$"], ["\\(","\\)"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno",skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']},
                    TeX: {  noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, Macros: { href: "{}" } },
                            messageStyle: "none"
                                }); 
    </script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Queue(function() {
                    var all = MathJax.Hub.getAllJax(), i;
                            for(i=0; i < all.length; i += 1) {
                                            all[i].SourceElement().parentNode.className += ' has-jax';
                                                    }
                                                        });
        </script>
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

-->


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  

  

  


  <!-- <script src="/js/src/prettify.js" type="text/javascript"></script> -->
  <!-- <script type="text/javascript">
    $(window).load(function(){
    $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
     prettyPrint();
    })
  </script> -->
  <script type="text/javascript" src="/js/src/love.js"></script>
</body>
</html>
